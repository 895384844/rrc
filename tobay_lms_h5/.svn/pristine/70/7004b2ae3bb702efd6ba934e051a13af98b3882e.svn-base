function codeClick(e){var o=$.trim($(e).find("#phone").val()),r=new Object;r.mobile=o,commonParm(r),1==validate(e+" #phone")&&jsonAjax(InterFace.getMcode,r,function(o){if(200==o.errCode){$(e).find(".getPhoneVer").attr("disabled","disabled").addClass("on");var r=e+" .getPhoneVer",a=60;timer=setInterval(function(){if(a>1){a-=1;var o=Math.floor(a%60),d="";o>=0&&(o<10&&(o="0"+o),d+=o+"秒"),$(r).val(d)}else clearInterval(timer),$(e).find(".getPhoneVer").attr("disabled",!1).val("获取手机验证码").removeClass("on")},1e3)}else 307==o.errCode&&(M.dialog1=jqueryAlert({content:"发送验证码失败，请联系管理员",closeTime:1e3,modal:!0}))})}function checkUser_fn(e){console.log(e),"309"==e.errCode?M.dialog1=jqueryAlert({content:"用户不存在，请到注册页面注册",closeTime:1e3,modal:!0}):"400"==e.errCode?(M.dialog1=jqueryAlert({content:"程序错误",closeTime:1e3,modal:!0}),$(".show #ptReg").removeClass("disabled").removeAttr("disabled").val("提交")):"501"==e.errCode?(M.dialog1=jqueryAlert({content:"手机验证码错误”",closeTime:1e3,modal:!0}),$(".show #ptReg").removeClass("disabled").removeAttr("disabled").val("提交")):"312"==e.errCode?(M.dialog1=jqueryAlert({content:"抱歉，该用户被封",closeTime:1e3,modal:!0}),$(".show #ptReg").removeClass("disabled").removeAttr("disabled").val("提交")):"303"==e.errCode?(M.dialog1=jqueryAlert({content:"验证码超时，请重新获取",closeTime:1e3,modal:!0}),$(".show #ptReg").removeClass("disabled").removeAttr("disabled").val("提交")):"200"==e.errCode&&("1"==e.userType?(M.dialog1=jqueryAlert({content:"用户不存在，请到注册页面注册",closeTime:1e3,modal:!0}),setTimeout(function(){var e=getSearch("openid"),o=getSearch("iconUrl"),r=getSearch("sex");jumpUrl("register.html?openid="+e+"&iconUrl="+o+"&sex="+r)},1e3)):"2"==e.userType&&(addCookie("userId",e.userId,0),addCookie("username",e.username,0),addCookie("password",e.password,0),addCookie("userType",e.userType,0),addCookie("staffid",e.staffid,0),addCookie("enterpriseId",e.enterpriseId,0),addCookie("enterpriseName",e.enterpriseName,0),addCookie("staffName",e.staffName,0),addCookie("loginType","no",0),addCookie("token",e.token,0),addCookie("userImg",e.imgUrl,0),addCookie("nickName",e.nickName,0),addCookie("photoimgurl",res.photoimgurl,0),jumpUrl("index.html"))),$(".show #ptReg").removeClass("disabled").removeAttr("disabled").val("提交")}$(document).attr("title","微信绑定_人人创培训监管服务平台");var M={},com_obj=new Object;commonParm(com_obj);var openid=getSearch("openid"),iconUrl=getSearch("iconUrl"),sex=getSearch("sex"),mobileCode,timer;"IE8"==myBrowser()||"IE9"==myBrowser()?($("#form_ie").addClass("show"),$("#form_ie .form_v").not("#form_ie #phone_verfy").on("blur",function(){validate(this)})):($("#form_no").addClass("show"),$("#form_no .form_v").not("#form_no #phone_verfy").on("blur",function(){validate(this)})),$(document).keydown(function(e){13==e.keyCode&&$(".show #ptReg").click()}),$(".show #ptReg").unbind("click").bind("click",function(){clearInterval(timer);var e=!1;if($(".show .form_v").each(function(){if(0==(e=validate(this)))return!1}),1==e){$(".show #ptReg").addClass("disabled").attr("disabled","disabled").val("正在处理.."),mobile=$.trim($(".show #phone").val()),mobileCode=$.trim($(".show #phone_verfy").val());var o=getSearch("openid"),r=new Object;r.phone=mobile,r.mobileCode=mobileCode,r.openid=o,r.iconUrl=iconUrl,r.sex=sex,commonParm(r),console.log(r),jsonAjax(InterFace.checkUserByPhone,r,checkUser_fn)}}),$(".show #getPhone").unbind("click").bind("click",function(e){e.stopPropagation(),codeClick(".show")});