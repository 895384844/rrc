window.TILE_VERSION={ditu:{normal:{version:"088",updateDate:"20171123"},satellite:{version:"009",updateDate:"20171123"},normalTraffic:{version:"081",updateDate:"20171123"},satelliteTraffic:{version:"083",updateDate:"20171123"},mapJS:{version:"104",updateDate:"20171123"},satelliteStreet:{version:"083",updateDate:"20171123"},panoClick:{version:"1033",updateDate:"20171116"},panoUdt:{version:"20171116",updateDate:"20171116"},panoSwfAPI:{version:"20150123",updateDate:"20150123"},panoSwfPlace:{version:"20141112",updateDate:"20141112"},earthVector:{version:"001",updateDate:"20171123"}},webapp:{high_normal:{version:"001",updateDate:"20171123"},lower_normal:{version:"002",updateDate:"20171123"}},api_for_mobile:{vector:{version:"002",updateDate:"20171123"},vectorIcon:{version:"002",updateDate:"20171123"}}},window.BMAP_AUTHENTIC_KEY="",function(){function aG(t){var e={duration:1e3,fps:30,delay:0,transition:k.linear};if(t)for(var i in t)e[i]=t[i];if(this._opts=e,e.delay){var n=this;setTimeout(function(){n._beginTime=(new Date).getTime(),n._endTime=n._beginTime+n._opts.duration,n._launch()},e.delay)}else this._beginTime=(new Date).getTime(),this._endTime=this._beginTime+this._opts.duration,this._launch()}function al(t){return t.style}function aR(t,e){var i=al(t);i.left=j(e[0]),i.top=j(e[1])}function B(t,e){var i=al(t);i.opacity=e,i.MozOpacity=e,i.KhtmlOpacity=e,i.filter="alpha(opacity="+100*e+")",i=null}function j(t){if("number"==typeof t)return t+"px";if("string"==typeof t){var e=t.replace(/"\\s","g"/,"");return/"^\\d+(px|%)+$","i"/.exec(e)?e:new RegExp("^\\d+$").exec(e)?e+"px":"0px"}}function p(t){l.Browser.ie>0?(t.unselectable="on",t.selectstart=function(){return!1}):al(t).MozUserSelect="none"}function aP(t,e){var i=al(t);i.width=j(e[0]),i.height=j(e[1])}function s(t){return t&&t.parentNode&&11!=t.parentNode.nodeType}function Z(t,e){return t.insertAdjacentHTML("beforeEnd",e),t.lastChild}function A(t){for(var e={left:0,top:0};t&&t.offsetParent;)e.left+=t.offsetLeft,e.top+=t.offsetTop,t=t.offsetParent;return e}function ag(t){(t=window.event||t).stopPropagation?t.stopPropagation():t.cancelBubble=!0}function D(t){return(t=window.event||t).preventDefault?t.preventDefault():t.returnValue=!1,!1}function aC(t){return ag(t),D(t)}function M(){var t=document.documentElement,e=document.body;return t&&(t.scrollTop||t.scrollLeft)?[t.scrollTop,t.scrollLeft]:e?[e.scrollTop,e.scrollLeft]:[0,0]}function o(t){if(t){var e,i,n,s=t.attributes;if(s)for(i=s.length,e=0;e<i;e+=1)"function"==typeof t[n=s[e].name]&&(t[n]=null);if(s=t.children)for(i=s.length,e=0;e<i;e+=1)o(t.children[e])}}function aO(t,e,i){var n=e.lng-i.lng,o=e.lat-i.lat;if(0==n)return Math.abs(t.lng-e.lng);if(0==o)return Math.abs(t.lat-e.lat);var s=o/n,a=e.lat-s*e.lng;return Math.abs(s*t.lng-t.lat+a)/Math.sqrt(s*s+1)}function v(t,e){if(t&&e)return Math.round(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)))}function aB(t,e){var i=[];e=e||function(t){return t};for(var n in t)i.push(n+"="+e(t[n]));return i.join("&")}function t(t,e,i){var n=document.createElement(t);i&&(n=document.createElementNS(i,t)),e=e||{};for(var o in e){var s={for:"htmlFor",class:"cssClass"}[o]||o;if("style"!=o)if("class"!=o)if(n.setAttribute)n.setAttribute(s,e[o]);else try{n[s]=e[o]}catch(n){}else l.ac(n,e[o]);else n.style.cssText=e[o]}return n}function an(t){return t.currentStyle?t.currentStyle:t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):void 0}function av(t){return"function"==typeof t}function aa(t){var e,i,n,o,s="",a="",r="",l=0;if(!t||/[^A-Za-z0-9\+\/\=]/g.exec(t))return t;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{e=aS.indexOf(t.charAt(l++))<<2|(n=aS.indexOf(t.charAt(l++)))>>4,i=(15&n)<<4|(o=aS.indexOf(t.charAt(l++)))>>2,a=(3&o)<<6|(r=aS.indexOf(t.charAt(l++))),s+=String.fromCharCode(e),64!=o&&(s+=String.fromCharCode(i)),64!=r&&(s+=String.fromCharCode(a)),e=i=a="",n=o=r=""}while(l<t.length);return s}function C(t,e){if(t=l.G(t)){if(E.call(this),this.container=t,this._setStyle(t),t.unselectable="on",t.innerHTML="",t.appendChild(this.render()),this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.platform=t.children[0],this.maskLayer=this.platform.children[0],this._panes={},this._viewTiles={},this._bind(),this.centerPoint=new f(0,0),this.zoomLevel=1,this.lastLevel=0,this.defaultZoomLevel=null,this.defaultCenter=null,this.currentCity="",this.cityCode="",this.currentOperation=0,this.config={clickInterval:200,enableDragging:!0,enableKeyboard:!1,enableClickPan:!1,enableDblclickZoom:!0,enableContinuousZoom:!1,enableWheelZoom:!1,enableMouseDown:!0,fps:25,zoomerDuration:240,actionDuration:450,defaultCursor:aQ.defaultCursor,draggingCursor:aQ.draggingCursor,isOverviewMap:!1,zoomLevelMin:1,zoomLevelMax:18,coordType:BMAP_COORD_LNGLAT,mapType:BMAP_NORMAL_MAP,restrictBounds:!1,drawer:BMAP_SYS_DRAWER,enableInertialDragging:!1,drawMargin:500,enableFulltimeSpotClick:!1},this.setConfig(e),aJ[this.config.mapType]||(this.config.mapType=BMAP_NORMAL_MAP),this.config.mapType==BMAP_PERSPECTIVE_MAP&&_addStat(5002),e=e||{},this.config.zoomLevelMin=e.zoomLevelMin||aJ[this.config.mapType].zoomLevelMin,this.config.zoomLevelMax=e.zoomLevelMax||aJ[this.config.mapType].zoomLevelMax,this.mapType=this.config.mapType,this.temp={operating:!1,arrow:0,lastDomMoveTime:0,lastLoadTileTime:0,lastMovingTime:0,canKeyboard:!1,I:function(t){return l.I(t)},curSpots:[],curSpotsArray:[],spotsGuid:1,registerIndex:-1},window.InstanceCore=this.temp.I,this.platform.style.cursor=this.config.defaultCursor,l.Browser.ie)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(t){}for(var i=0;i<BMap._register.length;i++)BMap._register[i](this);this.temp.registerIndex=i;var n=this;(l.Platform.windows||l.Platform.macintosh||l.Platform.x11)&&aq.load("oppc",function(){n._asyncRegister()}),(l.Platform.iphone||l.Platform.ipad||l.Platform.android)&&aq.load("opmb",function(){n._asyncRegister()}),t=null}}function m(){}function z(t){t=t||{},this.charset=t.charset||"utf-8",this.objName=t.objName||"mapData",this.callback=t.callback,this.errorUrl=t.errorUrl||""}function aq(){}function P(){this._map=null,this._container,this._type="control",this.blockInfoWindow=!0,this._visible=!0}function K(t){P.call(this),t=t||{},this._opts={printable:!1},l.extend(this._opts,t),this._copyrightCollection=[],this.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT,this.defaultOffset=new X(5,2),this.setAnchor(t.anchor),this._canShow=!0,this.blockInfoWindow=!1,this._asyncLoadCode()}function ah(t){P.call(this),t=t||{},this._opts={printable:!1},this._opts=l.extend(l.extend(this._opts,{size:new X(150,150),padding:8,isOpen:!1,zoomInterval:4}),t),this.defaultAnchor=BMAP_ANCHOR_BOTTOM_RIGHT,this.defaultOffset=new X(0,0),this.setAnchor(t.anchor),this.setSize(this._opts.size),this._asyncLoadCode()}function T(t){P.call(this),t=t||{},this._opts={printable:!1},this._opts=l.extend(l.extend(this._opts,{color:"black",unit:"metric"}),t),this.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT,this.defaultOffset=new X(81,18),this.setAnchor(t.anchor),this._units={metric:{name:"metric",conv:1,incon:1e3,u1:"米",u2:"公里"},us:{name:"us",conv:3.2808,incon:5280,u1:"英尺",u2:"英里"}},this._units[this._opts.unit]||(this._opts.unit="metric"),this._asyncLoadCode()}function H(t){P.call(this),t=t||{},this._opts={printable:!1,showZoomInfo:!0},l.extend(this._opts,t),this.defaultAnchor=BMAP_ANCHOR_TOP_LEFT,this.defaultOffset=new X(10,10),this.setAnchor(t.anchor),this.setType(t.type),this._asyncLoadCode()}function ae(t){P.call(this),t=t||{},this._opts={printable:!1},this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT,this.defaultOffset=new X(10,10),this.setAnchor(t.anchor),this._opts=l.extend(l.extend(this._opts,{offset:this.defaultOffset,enableSwitch:!0}),t),this._asyncLoadCode()}function g(t){E.call(this),this._opts={container:null,cursor:"default"},this._opts=l.extend(this._opts,t),this._type="contextmenu",this._map=null,this._container,this._shadow,this._left=0,this._top=0,this._items=[],this._rItems=[],this._dividers=[],this._enable=!0,this.curPixel=null,this.curPoint=null,this._isOpen=!1;var e=this;aq.load("menu",function(){e._draw()})}function L(t,e,i){if(t&&e&&"function"==typeof e){E.call(this),this._opts={width:100,id:""},i=i||{},this._opts.width=1*i.width?i.width:100,this._opts.id=i.id?i.id:"",this._text=t+"",this._callback=e,this._map=null,this._type="menuitem",this._contextmenu=null,this._container=null,this._enabled=!0;var n=this;aq.load("menu",function(){n._draw()})}}function y(t,e,i,n){this.minX=t,this.minY=e,this.maxX=i,this.maxY=n}function f(t,e){isNaN(t)&&(t=aa(t),t=isNaN(t)?0:t),"string"==typeof t&&(t=parseFloat(t)),isNaN(e)&&(e=aa(e),e=isNaN(e)?0:e),"string"==typeof e&&(e=parseFloat(e)),this.lng=t,this.lat=e}function x(t){"[object Array]"==Object.prototype.toString.call(t)&&(this.points=t)}function O(){this._type="overlay"}function aF(){l.BaseClass.call(this),O.call(this),this._visible=!0,this.infoWindow=null,this._dblclickTime=0}function at(){this.map=null,this._overlays={},this._customOverlays=[]}function au(t){aF.call(this),this._config={strokeColor:"#3a6bdb",strokeWeight:5,strokeOpacity:.65,strokeStyle:"solid",enableMassClear:!0,getParseTolerance:null,getParseCacheIndex:null,enableEditing:!1,mouseOverTolerance:15,use3DCoords:!1,clickable:!0},this.setConfig(t),this._config.strokeWeight<=0&&(this._config.strokeWeight=5),(this._config.strokeOpacity<0||this._config.strokeOpacity>1)&&(this._config.strokeOpacity=.65),(this._config.fillOpacity<0||this._config.fillOpacity>1)&&(this._config.fillOpacity=.65),"solid"!=this._config.strokeStyle&&"dashed"!=this._config.strokeStyle&&(this._config.strokeStyle="solid"),this.domElement=null,this._bounds=new BMap.Bounds(0,0,0,0),this._parseCache=[],this.vertexMarkers=[],this._temp={}}function aj(t){aF.call(this),this.map=null,this.domElement=null,this._config={width:0,height:0,offset:new X(0,0),opacity:1,background:"transparent",lineStroke:1,lineColor:"#000",lineStyle:"solid",point:null},this.setConfig(t),this.point=this._config.point}function w(t,e,i){if(t&&e){this.imageUrl=t,this.size=e;var n={offset:new X(Math.floor(e.width/2),Math.floor(e.height/2)),imageOffset:new X(0,0)};i=i||{};for(var o in i)typeof n[o]==typeof i[o]&&(n[o]=i[o]);this.offset=n.offset,this.imageOffset=n.imageOffset,this.infoWindowOffset=i.infoWindowOffset||this.offset,this.printImageUrl=i.printImageUrl||""}}function ay(t,e){l.BaseClass.call(this),this.content=t,this.map=null,this._config={width:0,height:0,maxWidth:600,offset:new X(0,0),title:"",maxContent:"",enableMaximize:!1,enableAutoPan:!0,enableCloseOnClick:!0,margin:[10,10,40,10],collisions:[[10,10],[10,10],[10,10],[10,10]],ifMaxScene:!1,onClosing:function(){return!0}},this.setConfig(e),0!=this._config.width&&(this._config.width<220&&(this._config.width=220),this._config.width>730&&(this._config.width=730)),0!=this._config.height&&(this._config.height<60&&(this._config.height=60),this._config.height>650&&(this._config.height=650)),0!=this._config.maxWidth&&(this._config.maxWidth<220&&(this._config.maxWidth=220),this._config.maxWidth>730&&(this._config.maxWidth=730)),this.isWinMax=!1,this.IMG_PATH=aQ.imgPath,this.overlay=null;var i=this;aq.load("infowindow",function(){i._draw()})}function q(t,e){aF.call(this),this.content=t,this.map=null,this.domElement=null,this._config={width:0,offset:new X(0,0),styles:{backgroundColor:"#fff",border:"1px solid #f00",padding:"1px",whiteSpace:"nowrap",font:"12px arial,simsun",zIndex:"80",MozUserSelect:"none"},point:null,enableMassClear:!0,clickable:!0},e=e||{},this.setConfig(e),this._config.width<0&&(this._config.width=0),this.point=this._config.point;var i=this;aq.load("marker",function(){i._draw()})}function J(t,e){aF.call(this),e=e||{},this.point=t,this.map=null,this.domElement=null,this.iconDom=null,this.infoWindowDom=null,this.siblingElement=null,this.iconClassName="",this._config={offset:new X(0,0),opacity:1,icon:null,title:"",infoWindow:null,label:null,baseZIndex:0,clickable:!0,zIndexFixed:!1,isTop:!1,enableMassClear:!0,enableDragging:!1,restrictDraggingArea:!1},this.setConfig(e),e.icon||(this._config.icon=new BMap.Icon(aQ.imgPath+"marker_red.png",new X(23,25),{offset:new X(10,25),infoWindowOffset:new X(10,0)})),this._isDragging=!1;var i=this;aq.load("marker",function(){i._draw()})}function c(t,e){au.call(this,e),e=e||{},this._config.fillOpacity=e.fillOpacity?e.fillOpacity:.65,""==e.fillColor?this._config.fillColor="":this._config.fillColor=e.fillColor?e.fillColor:"#fff",this.setPoints(t);var i=this;aq.load("poly",function(){i._draw()})}function ai(t,e){au.call(this,e),this.setPoints(t);var i=this;aq.load("poly",function(){i._draw()})}function Y(t,e,i){this.point=t,this.radius=Math.abs(e),c.call(this,[],i)}function G(t,e){c.call(this,t,e);var i=this;aq.load("poly",function(){i._draw()})}function aK(t,e){t=isNaN(t)?0:t,e=isNaN(e)?0:e,this.x=t,this.y=e}function V(){}function X(t,e){this.width=parseFloat(t)||0,this.height=parseFloat(e)||0}function ax(e,i,n,a,r){this.mgr=e,this.position=n,this.name=e.getTileName(a,r),this.info=a;var l=t("img");p(l),l.galleryImg=!1;var h=l.style;h.position="absolute",h.border="none",h.width=e.tileSize+"px",h.height=e.tileSize+"px",h.left=n[0]+"px",h.top=n[1]+"px",this.img=l,this.src=i;var c=this;this.img.onload=function(t){if(c.mgr){var e=c.mgr;e.map.temp._beginLoadTile&&(e.map.temp._loadTileTime=(new Date).getTime()-e.map.temp._beginLoadTile);var i=e.bufferTiles;e.bufferNumber>0&&(i[c.name]=c,i.push(c.name));for(var n=i.length-e.bufferNumber,a=0;n>0&&a<i.length;a++){var l=i[a];if(!e.mapTiles[l]){if(i[l]){i[l].mgr=null;var h=i[l].img;h.parentNode&&(o(h),h.parentNode.removeChild(h)),h=null,i[l].img=null,delete i[l]}i.splice(a,1),a--,n--}}if(c.loaded=!0,e.imgNumber++,!s(c.img)&&r.tilesDiv&&(r.tilesDiv.appendChild(c.img),FeBrowser.ie<=6&&FeBrowser.ie>0&&1==r.isTransparentPng())){c.src.toUpperCase();var u=c.img.style,p=u.width,d=u.height,_='position:absolute;FILTER: progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+c.src+'",sizingMethod=scale);';u.cssText=_,u.width=p,u.height=d,u.left=c.position[0]+"px",u.top=c.position[1]+"px"}(t=new aw("onimagechange")).action="show",t.tile=c.name,e.map.dispatchEvent(t)}},this.img.onerror=function(t){if(c.mgr){c.mgr;c.error=!0;var e=aJ[r.mapType];e.errorUrl&&(c.img.src=e.errorUrl),s(c.img)||r.tilesDiv&&r.tilesDiv.appendChild(c.img)}},FeBrowser.ie<=6&&FeBrowser.ie>0&&1==r.isTransparentPng()?l.src=aQ.imgPath+"blank.gif":l.src=i,l=null;var u=new aw("onimagebefore");u.tile=c.name,e.map.dispatchEvent(u)}function aE(t){this.tileLayers=[],this.cacheDiv=null,this.map=t,this.bufferNumber=300,this.mapTiles=[],this.bufferTiles=[],this.slideMaxZoom=4,this.config=aJ[this.map.mapType],this.errorUrl=this.config.errorUrl,this.tileSize=this.config.tileSize,this.baseUnits=this.config.baseUnits,this.minZoomLevel=this.config.zoomLevelMin,this.maxZoomLevel=this.config.zoomLevelMax,this.tileURLs=this.config.tileUrls,this.imgNumber=0,this.temp={}}function F(t){this.opts=t||{},this.copyright=this.opts.copyright||{},this.transparentPng=this.opts.transparentPng||!1,this.baseLayer=this.opts.baseLayer||!1,this.offset=[0,0],this._type="tilelayer"}function af(t,e,i){this.bounds=t,this.content=e,this.mapType=i}function aH(t){this._opts={},t=t||{},this._opts=l.extend(this._opts,t),this._opts.predictDate&&((this._opts.predictDate.weekday<1||this._opts.predictDate.weekday>7)&&(this._opts.predictDate=1),(this._opts.predictDate.hour<0||this._opts.predictDate.hour>23)&&(this._opts.predictDate.hour=0)),this._tileUrl="https://its.map.baidu.com:8002/traffic/"}function ao(t){E.call(this),t&&(this._opts={},this._map=t)}function ak(t,e){ao.call(this,t),this._opts=l.extend(l.extend(this._opts,{icon:null,iconFollow:!1,followText:"",cursor:"pointer"}),e),this._isOpen=!1,this._opts.followText=this._checkStr(this._opts.followText),this.followTitle=this._opts.followText,this.followMarker=null,this._overlays=[];var i=this;aq.load("tools",function(){i._draw()})}function S(t,e){ao.call(this,t),e=e||{},this._opts=l.extend(l.extend(this._opts||{},{autoClear:!1,tips:"测距",followText:"单击确定起点，双击结束绘制",unit:"metric",showResult:!0,lineColor:"blue",lineStroke:2,opacity:1,lineStyle:"solid",cursor:aQ.imgPath+"ruler.cur",styleCodes:{lnCode:0,spCode:0,slCode:0,tlCode:0},enableMassClear:!0}),e),0==this._opts.showResult&&(void 0===e.tips&&(this._opts.tips="绘制折线"),e.cursor||(this._opts.cursor="crosshair")),this._opts.lineStroke<=0&&(lineStroke=2),this._opts.opacity>1?this._opts.opacity=1:this._opts.opacity<0&&(this._opts.opacity=0),"solid"!=this._opts.lineStyle&&"dashed"!=this._opts.lineStyle&&(this._opts.lineStyle="solid"),this._checked=!1,this._drawing=null,this.followTitle=null,this._totalDis={},this._points=[],this._paths=[],this._dots=[],this._segDistance=[],this._overlays=[],this._units={metric:{name:"metric",conv:1,incon:1e3,u1:"米",u2:"公里"},us:{name:"us",conv:3.2808,incon:5279.856,u1:"英尺",u2:"英里"}},this._units[this._opts.unit]||(this._opts.unit="metric"),this._dLineColor="#ff6319",this._dLineStroke=3,this._dOpacity=.8,this._dLineStyle="solid",this._dCursor=aQ.imgPath+"ruler.cur",this._opts.showResult&&(this._opts.followText="单击确定起点"),this._followTextM="单击确定地点，双击结束",this._movingTimerId=null,this._opts.showResult?this.text="测距":this.text="绘线",this._isOpen=!1;var i=this;aq.load("tools",function(){i._draw()})}function n(t,e){ao.call(this,t),this._opts=l.extend(l.extend(this._opts,{zoomType:BMAP_ZOOM_IN,followText:"",strokeWeight:2,strokeColor:"#111",style:"solid",fillColor:"#ccc",opacity:.4,cursor:"crosshair",autoClose:!1}),e),this._opts.strokeWeight=this._opts.strokeWeight<=0?1:this._opts.strokeWeight,this._opts.opacity=this._opts.opacity<0?0:this._opts.opacity>1?1:this._opts.opacity,(this._opts.zoomType<BMAP_ZOOM_IN||this._opts.zoomType>BMAP_ZOOM_OUT)&&(this._opts.zoomType=BMAP_ZOOM_IN),this._isOpen=!1,this._fDiv=null,this.followTitle=null;var i=this;aq.load("tools",function(){i._draw()})}function ad(){this._container=null}function I(t){this.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT,this.defaultOffset=new X(1,0),this._useSmallImage=!!(l.Platform.ipad||l.Platform.iphone||l.Platform.android),this.IMG_URL=aQ.imgPath+(this._useSmallImage?"copyright_logo_s.png":"copyright_logo.png")}var l=l||{version:"20080809",emptyFn:function(){}};!function(){l._log=[];var t=0,e={};l.BaseClass=function(t){e[this.hashCode=t||l.BaseClass.guid()]=this},l.BaseClass.guid=function(){return"mz_"+(t++).toString(36)},l.BaseClass.create=function(){var t=new l.BaseClass;return t.decontrol(),t};l.instance=l.I=function(t){return e[t]};l.BaseClass.prototype.dispose=function(){this.hashCode&&delete e[this.hashCode];for(var t in this)"function"!=typeof this[t]&&delete this[t]},l.BaseClass.prototype.getHashCode=function(){return this.hashCode||(e[this.hashCode=l.BaseClass.guid()]=this),this.hashCode},l.BaseClass.prototype.decontrol=function(){delete e[this.hashCode]},l.BaseClass.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"},l.BaseClass.prototype._wlog=function(t,e){var i=l._log;i.length>100&&(i.reverse().length=50,i.reverse()),i[i.length]="["+t+"]["+(this._className||"Object")+" "+this.hashCode+"] "+e}}(),Function.prototype.inherits=function(t,e){var i,n,o=this.prototype,s=function(){};s.prototype=t.prototype,n=this.prototype=new s,"string"==typeof e&&(n._className=e);for(i in o)n[i]=o[i];return this.prototype.constructor=o.constructor,o=s=null,n},l.BaseEvent=function(t,e){this.type=t,this.returnValue=!0,this.target=e||null,this.currentTarget=this.srcElement=null,this.cancelBubble=!1,this.domEvent=null},l.BaseClass.prototype.addEventListener=function(t,e,i){if("function"!=typeof e)return this._wlog("error","addEventListener:"+e+" is not a function");this._listeners||(this._listeners={});var n,o=this._listeners;"string"==typeof i&&i&&(/[^\w\-]/.test(i)?this._wlog("warning","nonstandard key:"+i):(e.hashCode=i,n=i)),0!=t.indexOf("on")&&(t="on"+t),"object"!=typeof o[t]&&(o[t]={}),n=n||l.BaseClass.guid(),e.hashCode=n,o[t][n]&&this._wlog("warning","repeat key:"+n),o[t][n]=e},l.BaseClass.prototype.removeEventListener=function(t,e){if("function"==typeof e)e=e.hashCode;else if("string"!=typeof e)return;this._listeners||(this._listeners={}),0!=t.indexOf("on")&&(t="on"+t);var i=this._listeners;i[t]&&i[t][e]&&delete i[t][e]},l.BaseClass.prototype.dispatchEvent=function(t){this._listeners||(this._listeners={});var e,i=this._listeners,n=t.type;if(t.target=t.srcElement=t.target||t.srcElement||this,t.currentTarget=this,"function"==typeof this[n]&&this[n](t),"object"==typeof i[n])for(e in i[n])"function"==typeof i[n][e]&&i[n][e].call(this,t);return t.returnValue},l.BaseEvent.prototype.inherit=function(t){var e=this;if(this.domEvent=t=window.event||t,e.clientX=t.clientX||t.pageX,e.clientY=t.clientY||t.pageY,e.offsetX=t.offsetX||t.layerX,e.offsetY=t.offsetY||t.layerY,e.screenX=t.screenX,e.screenY=t.screenY,e.ctrlKey=t.ctrlKey||t.metaKey,e.shiftKey=t.shiftKey,e.altKey=t.altKey,t.touches){e.touches=[];for(i=0;i<t.touches.length;i++)e.touches.push({clientX:t.touches[i].clientX,clientY:t.touches[i].clientY,screenX:t.touches[i].screenX,screenY:t.touches[i].screenY,pageX:t.touches[i].pageX,pageY:t.touches[i].pageY,target:t.touches[i].target,identifier:t.touches[i].identifier})}if(t.changedTouches){e.changedTouches=[];for(i=0;i<t.changedTouches.length;i++)e.changedTouches.push({clientX:t.changedTouches[i].clientX,clientY:t.changedTouches[i].clientY,screenX:t.changedTouches[i].screenX,screenY:t.changedTouches[i].screenY,pageX:t.changedTouches[i].pageX,pageY:t.changedTouches[i].pageY,target:t.changedTouches[i].target,identifier:t.changedTouches[i].identifier})}if(t.targetTouches){e.targetTouches=[];for(var i=0;i<t.targetTouches.length;i++)e.targetTouches.push({clientX:t.targetTouches[i].clientX,clientY:t.targetTouches[i].clientY,screenX:t.targetTouches[i].screenX,screenY:t.targetTouches[i].screenY,pageX:t.targetTouches[i].pageX,pageY:t.targetTouches[i].pageY,target:t.targetTouches[i].target,identifier:t.targetTouches[i].identifier})}return e.rotation=t.rotation,e.scale=t.scale,e},l.Browser=function(){var t=navigator.userAgent,e=0,i=0,n=0,o=0,s=0,a=0,r=0;return"object"==typeof window.opera&&/Opera(\s|\/)(\d+(\.\d+)?)/.test(t)?i=parseFloat(RegExp.$2):/MSIE (\d+(\.\d+)?)/.test(t)?e=parseFloat(RegExp.$1):/Firefox(\s|\/)(\d+(\.\d+)?)/.test(t)?o=parseFloat(RegExp.$2):"Netscape"==navigator.vendor&&/Netscape(\s|\/)(\d+(\.\d+)?)/.test(t)?r=parseFloat(RegExp.$2):t.indexOf("Safari")>-1&&/Version\/(\d+(\.\d+)?)/.test(t)&&(n=parseFloat(RegExp.$1)),t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML")&&/rv\:(\d+(\.\d+)?)/.test(t)&&(a=parseFloat(RegExp.$1)),/chrome\/(\d+\.\d)/i.test(t)&&(s=parseFloat(RegExp.$1)),{ie:e,firefox:o,gecko:a,netscape:r,opera:i,safari:n,chrome:s}}(),window.FeBrowser=l.Browser,l.Dom={},l.Dom.createDom=function(t,e){l.isIE&&e&&e.name&&(t="<"+t+' name="'+l.String.escapeHTML(e.name)+'">');var i=document.createElement(t);return e&&l.Dom.setProperties(i,e),i},l.Dom.getOffset=function(t){var e=l.Dom.getOwnerDocument(t),i=l.isGecko>0&&e.getBoxObjectFor&&"absolute"==l.Dom.getStyle(t,"position")&&(""===t.style.top||""===t.style.left),n={left:0,top:0},o=l.isIE&&!l.isStrict?e.body:e.documentElement;if(t==o)return n;var s,a=null;if(t.getBoundingClientRect)s=t.getBoundingClientRect(),n.left=s.left+Math.max(e.documentElement.scrollLeft,e.body.scrollLeft),n.top=s.top+Math.max(e.documentElement.scrollTop,e.body.scrollTop),n.left-=e.documentElement.clientLeft,n.top-=e.documentElement.clientTop,l.isIE&&!l.isStrict&&(n.left-=2,n.top-=2);else if(e.getBoxObjectFor&&!i){s=e.getBoxObjectFor(t);var r=e.getBoxObjectFor(o);n.left=s.screenX-r.screenX,n.top=s.screenY-r.screenY}else{a=t;do{if(n.left+=a.offsetLeft,n.top+=a.offsetTop,l.isWebkit>0&&"fixed"==l.Dom.getStyle(a,"position")){n.left+=e.body.scrollLeft,n.top+=e.body.scrollTop;break}a=a.offsetParent}while(a&&a!=t);for((l.isOpera>0||l.isWebkit>0&&"absolute"==l.Dom.getStyle(t,"position"))&&(n.top-=e.body.offsetTop),a=t.offsetParent;a&&a!=e.body;)n.left-=a.scrollLeft,l.isOpera&&"TR"==a.tagName||(n.top-=a.scrollTop),a=a.offsetParent}return n},l.Dom.getOwnerDocument=function(t){return 9==t.nodeType?t:t.ownerDocument||t.document},l.Dom.setProperties=function(t,e){l.each(e,function(e,i){l.Dom._setProperty(t,i,e)})},l.Dom._setProperty=function(t,e,i){"style"==e?t.style.cssText=i:"class"==e?t.className=i:"for"==e?t.htmlFor=i:e in l.Dom._DIRECT_ATTRIBUTE_MAP?t.setAttribute(l.Dom._DIRECT_ATTRIBUTE_MAP[e],i):t[e]=i},l.Dom._DIRECT_ATTRIBUTE_MAP={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder"},l.G=function(){for(var t=[],e=arguments.length-1;e>-1;e--){var i=arguments[e];t[e]=null,"object"==typeof i&&i&&i.dom?t[e]=i.dom:"object"==typeof i&&i&&i.tagName||i==window||i==document?t[e]=i:"string"==typeof i&&(i=document.getElementById(i))&&(t[e]=i)}return t.length<2?t[0]:t},l.ac=function(t,e){(t=this.G(t))&&(e=this.trim(e),new RegExp("(^| )"+e.replace(/(\W)/g,"\\$1")+"( |$)").test(t.className)||(t.className=t.className.split(/\s+/).concat(e).join(" ")))},l.addClassName=l.ac,l.each=function(t,e){if("function"!=typeof e)return t;if(t)if(void 0===t.length)for(var i in t)e.call(t[i],t[i],i);else for(var n=0,o=t.length;n<o;n++)e.call(t[n],t[n],n);return t},l.extend=function(t,e){if(t&&e&&"object"==typeof e){for(var i in e)t[i]=e[i];for(var n,o=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],s=0;s<o.length;s++)n=o[s],Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},l.hide=function(){l.each(arguments,function(t){(t=l.G(t))&&(t.style.display="none")})},l.inherit=function(t,e,i){var n=t.prototype,o=function(){};o.prototype=e.prototype;var s=t.prototype=new o;"string"==typeof i&&(s._className=i);for(var a in n)s[a]=n[a];return t.prototype.constructor=n.constructor,n=null,s},l.isIE=0,navigator.userAgent.indexOf("MSIE")>0&&!window.opera&&(/MSIE (\d+(\.\d+)?)/.test(navigator.userAgent),l.isIE=parseFloat(RegExp.$1)),l.rc=function(t,e){if(t=this.G(t)){e=this.trim(e);var i=t.className.replace(new RegExp("(^| +)"+e.replace(/(\W)/g,"\\$1")+"( +|$)","g"),"$2");t.className!=i&&(t.className=i)}},l.removeClassName=l.rc,l.show=function(){this.each(arguments,function(t){(t=l.G(t))&&(t.style.display="")})},l.trim=function(t){return t.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+$)/g,"")};var E=l.BaseClass;E.prototype.toString=function(){return this._className||""};var aw=l.BaseEvent;if(l.on=function(t,e,i){return(t=l.G(t))?(e=e.replace(/^on/,"").toLowerCase(),t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i),t):t},l.un=function(t,e,i){return(t=l.G(t))?(e=e.replace(/^on/,"").toLowerCase(),t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent&&t.detachEvent("on"+e,i),t):t},l.hc=function(t,e){if(!t||!t.className||"string"!=typeof t.className)return!1;var i=-1;try{i=t.className==e||t.className.search(new RegExp("(\\s|^)"+e+"(\\s|$)"))}catch(t){return!1}return i>-1},"undefined"!=typeof HTMLElement&&HTMLElement.prototype.__lookupGetter__&&!HTMLElement.prototype.__lookupGetter__("children")&&!window.opera)try{HTMLElement.prototype.__defineGetter__("children",function(){for(var t,e=[],i=0,n=0,o=this.childNodes.length;n<o;n++)1==(t=this.childNodes[n]).nodeType&&(e[i++]=t,t.name&&(e[t.name]||(e[t.name]=[]),e[t.name][e[t.name].length]=t),t.id&&(e[t.id]=t));return e})}catch(t){}"undefined"==typeof HTMLElement||window.opera||!HTMLElement.prototype||HTMLElement.prototype.insertAdjacentHTML||(HTMLElement.prototype.insertAdjacentHTML=function(t,e){var i=this.ownerDocument.createRange();switch(i.setStartBefore(this),i=i.createContextualFragment(e),t=t.toLowerCase()){case"beforebegin":this.parentNode.insertBefore(i,this);break;case"afterbegin":this.insertBefore(i,this.firstChild);break;case"beforeend":this.appendChild(i);break;case"afterend":this.nextSibling?this.parentNode.insertBefore(i,this.nextSibling):this.parentNode.appendChild(i)}}),"undefined"==typeof HTMLElement||window.opera||(HTMLElement.prototype.contains=function(t){if(t==this)return!0;for(;t=t.parentNode;)if(t==this)return!0;return!1}),l.Browser.ie||"undefined"==typeof Event||window.opera||(Event.prototype.__defineSetter__("returnValue",function(t){return t||this.preventDefault(),t}),Event.prototype.__defineSetter__("cancelBubble",function(t){return t&&this.stopPropagation(),t})),l.each=function(t,e){if(av(e))for(var i=0,n=t.length;i<n&&!1!==e.call(t,t[i],i);i++);return t},l.Platform={x11:0,macintosh:0,windows:0,android:0,iphone:0,ipad:0};for(var N in l.Platform)l.Platform.hasOwnProperty(N)&&(l.Platform[N]=new RegExp(N,"i").test(window.navigator.userAgent)?1:0);aG.prototype._launch=function(){var t=this,e=(new Date).getTime();if(e>=t._endTime)return"function"==typeof t._opts.render&&t._opts.render(t._opts.transition(1)),void("function"==typeof t._opts.finish&&t._opts.finish());t.schedule=t._opts.transition((e-t._beginTime)/t._opts.duration),"function"==typeof t._opts.render&&t._opts.render(t.schedule),t.terminative||(t._timer=setTimeout(function(){t._launch()},1e3/t._opts.fps))},aG.prototype.stop=function(t){this.terminative=!0,this._timer&&clearTimeout(this._timer),t&&(this._endTime=this._beginTime,this._launch())},aG.prototype.cancel=function(){this._timer&&clearTimeout(this._timer),this._endTime=this._beginTime,this.schedule=0};var k={linear:function(t){return t},reverse:function(t){return 1-t},easeInQuad:function(t){return t*t},easeInCubic:function(t){return Math.pow(t,3)},easeOutQuad:function(t){return-t*(t-2)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutQuad:function(t){return t<.5?t*t*2:-2*(t-2)*t-1},easeInOutCubic:function(t){return t<.5?4*Math.pow(t,3):4*Math.pow(t-1,3)+1},easeInOutSine:function(t){return(1-Math.cos(Math.PI*t))/2}},aS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",aQ={imgPath:"https://api.map.baidu.com/images/",cityNames:{"北京":"bj","上海":"sh","深圳":"sz","广州":"gz"}};l.Browser.firefox?l.extend(aQ,{distCursor:"url("+aQ.imgPath+"ruler.cur),crosshair",defaultCursor:"-moz-grab",draggingCursor:"-moz-grabbing"}):l.Browser.chrome||l.Browser.safari?l.extend(aQ,{distCursor:"url("+aQ.imgPath+"ruler.cur) 2 6,crosshair",defaultCursor:"url("+aQ.imgPath+"openhand.cur) 8 8,default",draggingCursor:"url("+aQ.imgPath+"closedhand.cur) 8 8,move"}):l.extend(aQ,{distCursor:"url("+aQ.imgPath+"ruler.cur),crosshair",defaultCursor:"url("+aQ.imgPath+"openhand.cur),default",draggingCursor:"url("+aQ.imgPath+"closedhand.cur),move"}),window.BMap=window.BMap||{},window.BMap.version="1.1",window.BMap._register=[],window.BMap.register=function(t){this._register.push(t)},window.BMap.apiLoad=window.BMap.apiLoad||function(){},C.inherits(E,"Map"),l.extend(C.prototype,{render:function(){var e=t("div",{id:"platform"}),i=e.style;i.overflow="visible",i.position="absolute",i.zIndex="0",i.top=i.left="0px";var n=t("div",{id:"mask",class:"BMap_mask"}),o=n.style;return o.position="absolute",o.top=o.left="0px",o.zIndex="9",o.overflow="hidden",o.WebkitUserSelect="none",e.appendChild(n),e},_setStyle:function(t){var e=t.style;e.overflow="hidden","absolute"!=an(t).position&&(e.position="relative",e.zIndex=0),e.backgroundImage="url("+aQ.imgPath+"bg.png)",e.color="#000",e.textAlign="left"},_bind:function(){var t=this;t._watchSize=function(){var e=t.getSize();if(t.width!=e.width||t.height!=e.height){var i=(e.width-t.width)/2,n=(e.height-t.height)/2,o=t.getZoomUnits(),s=t.centerPoint;s&&(t.centerPoint=new f(s.lng+i*o,s.lat-n*o)),t.maskLayer.style.width=(t.width=e.width)+"px",t.maskLayer.style.height=(t.height=e.height)+"px",t.divhs&&(t.divhs.style.width=(t.width=e.width)+"px",t.divhs.style.height=(t.height=e.height)+"px");var a=new aw("onresize");a.size=e,t.dispatchEvent(a);var r=parseInt(t.platform.style.left)||0,l=parseInt(t.platform.style.top)||0;"undefined"==t.currentOperation||0==t.currentOperation||t.offsetX==r&&t.offsetY==l||t._setPlatformPosition(r,l)}},t._watchSize(),setInterval(t._watchSize,80)},_setPlatformPosition:function(t,e,i,n){if(!(isNaN(t)||isNaN(e)||this.offsetX==t&&this.offsetY==e)){var o=this.offsetX-t,s=this.offsetY-e,a=this.getZoomUnits(),r=new f(this.centerPoint.lng,this.centerPoint.lat);if(this.centerPoint=new f(r.lng+o*a,r.lat-s*a),i&&(this.centerPoint=i),this.config.restrictBounds){var l=aJ[this.mapType].bounds;(this.centerPoint.lng-this.width/2*a<=l.minX&&o<0||this.centerPoint.lng+this.width/2*a>l.maxX&&o>=0)&&(t=this.offsetX),(this.centerPoint.lat-this.height/2*a<=l.minY&&s>=0||this.centerPoint.lat+this.height/2*a>l.maxY&&s<0)&&(e=this.offsetY),this.centerPoint=new f(r.lng+(this.offsetX-t)*a,r.lat-(this.offsetY-e)*a);var h=new aw("onreachbounds");this.dispatchEvent(h)}t=Math.round(t),e=Math.round(e),this.offsetX=t,this.offsetY=e,this.platform.style.left=t+"px",this.platform.style.top=e+"px",this.maskLayer.style.left=-t+"px",this.maskLayer.style.top=-e+"px",this.divhs&&(this.divhs.style.left=-t+"px",this.divhs.style.top=-e+"px"),0!=n&&this.dispatchEvent(new aw("onmoving"))}},zoomTo:function(t,e){if("number"==typeof t&&aJ[this.mapType]&&(t=this._getProperZoom(t).zoom)!=this.zoomLevel){if(this.lastLevel=this.zoomLevel,e)this.temp._cPoint=e,this.temp._cPixel=this.pointToPixel(e);else if(this.getInfoWindow()){var i=this.getInfoWindow().getPoint();this.temp._cPixel=this.pointToPixel(i),this.temp._cPoint=i}if(e||this.temp.infoWin&&this.temp.infoWin.isOpen()){var n=this.config.coordType==BMAP_COORD_LNGLAT?ar.convertLL2MC(this.temp._cPoint):this.temp._cPoint,o=this.temp._cPixel,s=this.getZoomUnits(t);this.centerPoint=new f(n.lng+s*(this.width/2-o.x),n.lat-s*(this.height/2-o.y))}this.dispatchEvent(new aw("onzoomstart")),this.dispatchEvent(new aw("onzoomstartcode")),this.zoomLevel=t}},zoomIn:function(t){this.zoomTo(this.zoomLevel+1,t)},zoomOut:function(t){this.zoomTo(this.zoomLevel-1,t)},panTo:function(t,e,i){if(t&&"Point"==t.toString()){var n=this.pointToPixel(t);t=this.config.coordType==BMAP_COORD_LNGLAT?V.convertLL2MC(t):t,t=this.mapType==BMAP_PERSPECTIVE_MAP?V.convert2DTo3D(this.currentCity,t):t;var o=Math.round(this.width/2),s=Math.round(this.height/2);Math.abs(o-n.x)>this.width||Math.abs(s-n.y)>this.height||1==e?this._panTo(o-n.x,s-n.y,t):this._panBy(o-n.x,s-n.y,{duration:i})}},_panTo:function(t,e,i){var n=this.temp;1!=n.operating&&(n.dragAni&&(n.dragAni.stop(),n.dragAni=null,this.dispatchEvent(new aw("onmoveend"))),this.dispatchEvent(new aw("onmovestart")),this._setPlatformPosition(this.offsetX+t,this.offsetY+e,i),this.dispatchEvent(new aw("onmoveend")))},panBy:function(t,e){t=Math.round(t)||0,e=Math.round(e)||0,Math.abs(t)<=this.width&&Math.abs(e)<=this.height&&!arguments[3]?this._panBy(t,e,{fps:arguments[2]}):this._panTo(t,e)},_panBy:function(t,e,i){if(1!=this.temp.operating){i=i||{},this.dispatchEvent(new aw("onmovestart"));var n=this,o=n.temp;o.pl=n.offsetX,o.pt=n.offsetY,o.tlPan&&o.tlPan.cancel(),o.dragAni&&(o.dragAni.stop(),o.dragAni=null,this.dispatchEvent(new aw("onmoveend"))),o.tlPan=new aG({fps:i.fps||n.config.fps,duration:i.duration||n.config.actionDuration,transition:i.transition||k.easeInOutQuad,render:function(i){this.terminative=n.temp.operating,n.temp.operating||n._setPlatformPosition(o.pl+Math.ceil(t*i),o.pt+Math.ceil(e*i))},finish:function(t){n.dispatchEvent(new aw("onmoveend")),n.temp.tlPan=!1,1==n.temp.stopArrow&&(n.temp.stopArrow=!1,0!=n.temp.arrow&&n._arrow())}})}},addControl:function(t){t&&av(t._i)&&(t._i(this),this.dispatchEvent(new aw("onaddcontrol",t)))},removeControl:function(t){t&&av(t.remove)&&(t.remove(),this.dispatchEvent(new aw("onremovecontrol",t)))},addContextMenu:function(t){t&&"contextmenu"==t._type&&"function"==typeof t.initialize&&(t.initialize(this),this.dispatchEvent(new aw("onaddcontextmenu",t)))},removeContextMenu:function(t){t&&"contextmenu"==t._type&&"function"==typeof t.remove&&(this.dispatchEvent(new aw("onremovecontextmenu",t)),t.remove())},addOverlay:function(t){t&&av(t._i)&&(t._i(this),this.dispatchEvent(new aw("onaddoverlay",t)))},removeOverlay:function(t){t&&av(t.remove)&&(t.remove(),this.dispatchEvent(new aw("onremoveoverlay",t)))},clearOverlays:function(){this.dispatchEvent(new aw("onclearoverlays"))},addTileLayer:function(t){for(var e=0;e<this.tileMgr.tileLayers.length;e++){var i=this.tileMgr.tileLayers[e];if(i==t||i.getMapType()==t.getMapType())return;1==t.baseLayer&&(i.baseLayer=!1,i.zIndex=e)}t&&"tilelayer"==t._type&&av(t.initialize)&&(t.initialize(this),this.dispatchEvent(new aw("onaddtilelayer",t)))},removeTileLayer:function(t){t&&"tilelayer"==t._type&&av(t.remove)&&(t.remove(),this.dispatchEvent(new aw("onremovetilelayer",t)))},getTileLayer:function(t){if(this.tileMgr)return this.tileMgr.getTileLayer(t)},setMapType:function(t){if(this.mapType!=t){var e=this;e._changeMapType?e._changeMapType(t):aq.load("3dmap",function(){e._asyncRegister(),e._changeMapType(t)})}},getTileId:function(t,e){var i=aJ[this.mapType];if("object"!=typeof i)return null;var n=i.baseUnits*Math.pow(2,i.zoomLevelMax-e);return{row:parseInt(t.lng/n),column:parseInt(t.lat/n),level:e}},getViewTiles:function(){var t=this;return this._viewTiles[t.mapType]},setCenter:function(t){this.panTo(t,!0)},centerAndZoom:function(t,e,i){function n(t,e,i){t.centerPoint=new f(i.lng,i.lat),t.defaultZoomLevel=t.defaultZoomLevel||t.zoomLevel,t.defaultCenter=t.defaultCenter||t.centerPoint;var n=t.tileMgr&&t.tileMgr.tileLayers.length;if(!t.loaded&&!n){var o=new af("baidu",new y(-21364736,-10616832,23855104,15859712),"百度地图"),s=new F({mapType:t.mapType,copyright:o});s.baseLayer=!0,t.addTileLayer(s)}e.pixel=t.pointToPixel(t.centerPoint,t.zoomLevel,!0),t.dispatchEvent(e)}if(t&&e){e=this._getProperZoom(e).zoom,this.lastLevel=this.zoomLevel||e,this.zoomLevel=e;var o=new aw("onload");if(o.point=t,o.zoom=e,!i){this.config.coordType==BMAP_COORD_LNGLAT&&(t=this.config.coordType==BMAP_COORD_LNGLAT?V.convertLL2MC(t):t);var s=this;this._setCorrectPts(),this.mapType!=BMAP_PERSPECTIVE_MAP||this._get3DHotspots?(t=this.mapType==BMAP_PERSPECTIVE_MAP?V.convert2DTo3D(this.currentCity,t):t,this.mapType==BMAP_PERSPECTIVE_MAP&&this._get3DHotspots()):(t=s.mapType==BMAP_PERSPECTIVE_MAP?V.convert2DTo3D(s.currentCity,t):t,n(s,o,t),s.config.zoomLevelMin=15,s.config.zoomLevelMax=20,aq.load("3dmap",function(){s.temp.overlayDiv.appendChild(s.divhs),s._clear3DHotspots(),s._asyncRegister(),s.loaded||(s.addEventListener("zoomend",s._get3DHotspots),s.addEventListener("moveend",s._get3DHotspots)),s._get3DHotspots()}))}(this.mapType==BMAP_NORMAL_MAP||this.mapType==BMAP_PERSPECTIVE_MAP&&this._get3DHotspots)&&n(this,o,t)}},reset:function(){this.centerAndZoom(this.defaultCenter,this.defaultZoomLevel,!0)},enableDragging:function(){this.config.enableDragging=!0},disableDragging:function(){this.config.enableDragging=!1},enableInertialDragging:function(){this.config.enableInertialDragging=!0},disableInertialDragging:function(){this.config.enableInertialDragging=!1},enableScrollWheelZoom:function(){this.config.enableWheelZoom=!0},disableScrollWheelZoom:function(){this.config.enableWheelZoom=!1},enableContinuousZoom:function(){this.config.enableContinuousZoom=!0},disableContinuousZoom:function(){this.config.enableContinuousZoom=!1},enableClickPan:function(t){this.config.enableClickPan=!!t},enableDoubleClickZoom:function(){this.config.enableDblclickZoom=!0},disableDoubleClickZoom:function(){this.config.enableDblclickZoom=!1},enableKeyboard:function(){this.config.enableKeyboard=!0},disableKeyboard:function(){this.config.enableKeyboard=!1},getSize:function(){return new X(this.container.clientWidth,this.container.clientHeight)},getCenter:function(){var t=this.centerPoint;return this.config.coordType==BMAP_COORD_LNGLAT?(this.mapType==BMAP_PERSPECTIVE_MAP&&(t=V.convert3DTo2D(this.currentCity,t)),t=ar.convertMC2LL(t)):this.mapType==BMAP_PERSPECTIVE_MAP&&(t=V.convert3DTo2D(this.currentCity,t)),t},getZoom:function(){return this.zoomLevel},_getProperZoom:function(t){var e=this.config.zoomLevelMin,i=this.config.zoomLevelMax,n=!1;return t<e&&(n=!0,t=e),t>i&&(n=!0,t=i),{zoom:t,exceeded:n}},getContainer:function(){return this.container},getZoomUnits:function(t){var e=aJ[this.mapType];if("object"!=typeof e)return null;var i=t||this.zoomLevel;return Math.pow(2,e.zoomLevelMax-i)*e.baseUnits/e.tileSize},pointToPixel:function(t,e,i){if(t){i||(t=this.config.coordType==BMAP_COORD_LNGLAT?V.convertLL2MC(t):t,t=this.mapType==BMAP_PERSPECTIVE_MAP?V.convert2DTo3D(this.currentCity,t):t);var n=this.getZoomUnits(e);return new aK(Math.round((t.lng-this.centerPoint.lng)/n+this.width/2),Math.round((this.centerPoint.lat-t.lat)/n+this.height/2))}},pixelToPoint:function(t,e,i){if(t){var n=this.getZoomUnits(e),o=new f(this.centerPoint.lng+n*(t.x-this.width/2),this.centerPoint.lat-n*(t.y-this.height/2));if(!i)if(this.mapType==BMAP_PERSPECTIVE_MAP)if(this.config.coordType==BMAP_COORD_LNGLAT){var s=V.convert3DTo2D(this.currentCity,o);o=V.convertMC2LL(s)}else o=this.mapType==BMAP_PERSPECTIVE_MAP?V.convert3DTo2D(this.currentCity,o):o;else this.config.coordType==BMAP_COORD_LNGLAT&&(o=this.config.coordType==BMAP_COORD_LNGLAT?V.convertMC2LL(o):o);return o}},pointToOverlayPixel:function(t,e,i){var n=this.pointToPixel(t,e,i);if(n)return n.x-=this.offsetX,n.y-=this.offsetY,n},overlayPixelToPoint:function(t,e){if(t){var i=new aK(t.x,t.y);return i.x+=this.offsetX,i.y+=this.offsetY,this.pixelToPoint(i,e)}},lnglatToMercator:function(t,e){var i=new f(t,e),n=V.convertLL2MC(i);return[n.lng,n.lat]},mercatorToLnglat:function(t,e){if(isNaN(t)||isNaN(e))return[];var i=new f(t=parseFloat(t),e=parseFloat(e)),n=V.convertMC2LL(i);return[n.lng,n.lat]},getBounds:function(){if(!this.isLoaded())return new y;var t=arguments[0]||{},e=t.margins||[0,0,0,0],i=t.level||null,n=this.pixelToPoint({x:e[3],y:this.height-e[2]},i,!0),o=this.pixelToPoint({x:this.width-e[1],y:e[0]},i,!0);return this.config.coordType==BMAP_COORD_LNGLAT&&(n=V.convertMC2LL(n),o=V.convertMC2LL(o)),this.mapType==BMAP_PERSPECTIVE_MAP&&(n=V.convert3DTo2D(this.currentCity,n),o=V.convert3DTo2D(this.currentCity,o)),new y(n.lng,n.lat,o.lng,o.lat)},setConfig:function(t){if(t)for(var e in t)typeof this.config[e]==typeof t[e]&&(this.config[e]=t[e])},isLoaded:function(){return!!this.loaded},_getBestLevel:function(t,e){var i=aJ[this.mapType];if(!i)return this.getZoom();for(var n=e.margins||[10,10,10,10],o=e.zoomFactor||0,s=n[1]+n[3],a=n[0]+n[2],r=i.zoomLevelMin,l=i.zoomLevelMax,h=l;h>=r;h--){var c=this.getZoomUnits(h);if((t.maxX-t.minX)/c<this.width-s&&(t.maxY-t.minY)/c<this.height-a)break}return(h+=o)<r&&(h=r),h>l&&(h=l),h},getViewport:function(t,e){var i={center:this.getCenter(),zoom:this.getZoom()};if(!t||0==t.length)return i;e=e||{};var n=[],o=[];if(this.config.coordType==BMAP_COORD_LNGLAT)for(var s=0,a=t.length;s<a;s++)n.push(ar.convertLL2MC(t[s]));else n=t;if(this.mapType!=BMAP_PERSPECTIVE_MAP)o=n;else for(var s=0,a=n.length;s<a;s++)o.push(ar.convert2DTo3D(this.currentCity,n[s]));for(var r=new y,s=o.length-1;s>=0;s--)r.extend(o[s]);if(r.isEmpty())return i;var l=r.getCenter(),h=this._getBestLevel(r,e);if(e.margins){var c=e.margins,u=(c[1]-c[3])/2,p=(c[0]-c[2])/2,d=this.getZoomUnits(h);l.lng=l.lng+d*u,l.lat=l.lat+d*p}return this.mapType==BMAP_PERSPECTIVE_MAP&&(l=ar.convert3DTo2D(this.currentCity,l)),this.config.coordType==BMAP_COORD_LNGLAT&&(l=ar.convertMC2LL(l)),{center:l,zoom:h}},setViewport:function(t,e){var i;i=t&&t.center?t:this.getViewport(t,e);var n=(e=e||{}).delay||200;if(i.zoom==this.zoomLevel&&0!=e.enableAnimation){var o=this;setTimeout(function(){o.panTo(i.center,!1,210)},n)}else this.centerAndZoom(i.center,i.zoom)},addSpots:function(t,e){if(t&&0!=t.length){var i=(e=e||{}).zIndex||0,n=void 0===e.enableMultiResponse||!!e.enableMultiResponse;this.spotsPool=this.spotsPool||{};var o="sp"+this.temp.spotsGuid++;this.spotsPool[o]={spots:t.slice(0),zIndex:i,enableMultiResponse:n};var s=this;return aq.load("hotspot",function(){s._asyncRegister()}),o}},getSpots:function(t){return this.spotsPool[t]&&this.spotsPool[t].spots||[]},removeSpots:function(t){t&&this.spotsPool[t]&&delete this.spotsPool[t]},clearSpots:function(){delete this.spotsPool},setBounds:function(t){aJ[this.mapType].bounds=new y(t.minX,t.minY,t.maxX,t.maxY)},getCoordType:function(){return this.config.coordType},getPanes:function(){return this._panes},getInfoWindow:function(){return this.temp.infoWin&&this.temp.infoWin.isOpen()?this.temp.infoWin:null},getDistance:function(t,e){if(t&&e){return this.config.coordType==BMAP_COORD_LNGLAT?V.getDistanceByLL(t,e):V.getDistanceByMC(t,e)}},getOverlays:function(){var t=[],e=this._overlays,i=this._customOverlays;if(e)for(var n in e)e[n]instanceof aF&&t.push(e[n]);if(i)for(var n=0,o=i.length;n<o;n++)t.push(i[n]);return t},getMapType:function(){return this.mapType},_asyncRegister:function(){for(var t=this.temp.registerIndex;t<BMap._register.length;t++)BMap._register[t](this);this.temp.registerIndex=t},_setCorrectPts:function(){var t=aJ[BMAP_PERSPECTIVE_MAP].citys;for(var e in t){t[e][1];var i=t[e][0];if(e==this.currentCity){this.mapType==BMAP_PERSPECTIVE_MAP&&this.setBounds(i);break}}},setCurrentCity:function(t){var e=this;this.mapType==BMAP_PERSPECTIVE_MAP&&aq.load("3dmap",function(){e._asyncRegister(),e.addEventListener("zoomend",e._get3DHotspots),e.addEventListener("moveend",e._get3DHotspots)}),this._clear3DHotspots&&this._clear3DHotspots();var i=aJ[BMAP_PERSPECTIVE_MAP].citys;this.currentCity=this._get3DCityCode(t),this.cityCode=i[this.currentCity][2],this._setCorrectPts()},_get3DCityCode:function(t){if(!t)return"bj";var e=aQ.cityNames;for(var i in e)if(t.search(i)>-1)return e[i];return"bj"},setDefaultCursor:function(t){this.config.defaultCursor=t,this.platform&&(this.platform.style.cursor=this.config.defaultCursor)},getDefaultCursor:function(){return this.config.defaultCursor},setDraggingCursor:function(t){this.config.draggingCursor=t},getDraggingCursor:function(){return this.config.draggingCursor}}),window.BMAP_API_VERSION="1.1",window.BMAP_NORMAL_MAP="B_NORMAL_MAP",window.BMAP_PERSPECTIVE_MAP="B_DIMENSIONAL_MAP",window.BMAP_COORD_LNGLAT=0,window.BMAP_COORD_MERCATOR=1,window.BMAP_SYS_DRAWER=0,window.BMAP_SVG_DRAWER=1,window.BMAP_VML_DRAWER=2,window.BMAP_CANVAS_DRAWER=3,window._addStat=function(t,e){if(t){e=e||{};var i="";for(var n in e)i=i+"&"+n+"="+encodeURIComponent(e[n]);var o=function(t){t&&(_addStat._sending=!0,setTimeout(function(){_addStat._img.src="https://api.map.baidu.com/images/blank.gif?"+t.src},50))},s=function(){var t=_addStat._reqQueue.shift();t&&o(t)},a=(1e8*Math.random()).toFixed(0);_addStat._sending?_addStat._reqQueue.push({src:"t="+a+"&code="+t+i}):o({src:"t="+a+"&code="+t+i}),_addStat._binded||(l.on(_addStat._img,"load",function(){_addStat._sending=!1,s()}),l.on(_addStat._img,"error",function(){_addStat._sending=!1,s()}),_addStat._binded=!0)}},window._addStat._reqQueue=[],window._addStat._img=new Image;var az=5e3;_addStat(az,{v:BMap.version});var aJ={B_NORMAL_MAP:{tileUrls:["http://online0.map.bdimg.com/tile/","http://online1.map.bdimg.com/tile/","http://online2.map.bdimg.com/tile/","http://online3.map.bdimg.com/tile/","http://online4.map.bdimg.com/tile/"],tileSize:256,baseUnits:256,zoomLevelMin:1,zoomLevelMax:18,errorUrl:aQ.imgPath+"bg.png",bounds:new y(-21364736,-10616832,23855104,15859712),imgExtend:"png"},B_DIMENSIONAL_MAP:{tileUrls:["https://d0.map.baidu.com/resource/mappic/","https://d1.map.baidu.com/resource/mappic/","https://d2.map.baidu.com/resource/mappic/","https://d3.map.baidu.com/resource/mappic/"],tileSize:256,baseUnits:256,zoomLevelMin:15,zoomLevelMax:20,errorUrl:aQ.imgPath+"bg.png",bounds:new y(-21364736,-10616832,23855104,15859712),imgExtend:"jpg",hotspotUrl:["https://d0.map.baidu.com/resource/js/map/","https://d1.map.baidu.com/resource/js/map/","https://d2.map.baidu.com/resource/js/map/","https://d3.map.baidu.com/resource/js/map/"],entityUrl:"https://d0.map.baidu.com/resource/js/entity/",citys:{bj:[new y(524288,9363456,727040,9474048),new y(12821123.68,4784960.94,12958550,4862821.56),2],gz:[new y(1048576,8857601,1157119,8949760),new y(12589292.4,2591556.62,12646784.64,2647562.86),1],sz:[new y(524288,9375745,668415,9474048),new y(12668344.21,2560434.57,12710864.02,2587497.06),14],sh:[new y(983040,8890369,1130495,8994816),new y(13507877.45,3640466.88,13537325.71,3658712.59),4]}},BMAP_CUSTOM_LAYER:{tileUrls:[""],tileSize:256,baseUnits:256,zoomLevelMin:1,zoomLevelMax:18,errorUrl:aQ.imgPath+"blank.gif",bounds:new y(-21364736,-10616832,23855104,15859712),imgExtend:"png"}};l.extend(m,{num:{bj:{num:Math.sin(Math.PI/4),num2:Math.sin(Math.PI/6)},gz:{num:Math.sin(Math.PI/4),num2:Math.sin(Math.PI/4)},sz:{num:Math.sin(Math.PI/4),num2:Math.sin(Math.PI/4)},sh:{num:Math.sin(Math.PI/4),num2:Math.sin(Math.PI/4)}},correct_pts:{bj:[{j:116.305687,w:39.990912,utm_x:12947230.73,utm_y:4836903.65,x:630412,y:547340},{j:116.381837,w:40.000198,utm_x:12955707.8,utm_y:4838247.62,x:667412,y:561832},{j:116.430651,w:39.995216,utm_x:12961141.81,utm_y:4837526.55,x:686556,y:573372},{j:116.474111,w:39.976323,utm_x:12965979.81,utm_y:4834792.55,x:697152,y:586816},{j:116.280328,w:39.953159,utm_x:12944407.75,utm_y:4831441.53,x:603272,y:549976},{j:116.316117,w:39.952496,utm_x:12948391.8,utm_y:4831345.64,x:618504,y:557872},{j:116.350477,w:39.938107,utm_x:12952216.78,utm_y:4829264.65,x:627044,y:568220},{j:116.432025,w:39.947158,utm_x:12961294.76,utm_y:4830573.59,x:666280,y:584016},{j:116.46873,w:39.949516,utm_x:12965380.79,utm_y:4830914.63,x:683328,y:591444},{j:116.280077,w:39.913823,utm_x:12944379.8,utm_y:4825753.62,x:586150,y:558552},{j:116.308625,w:39.91374,utm_x:12947557.79,utm_y:4825741.62,x:598648,y:564732},{j:116.369853,w:39.912979,utm_x:12954373.73,utm_y:4825631.62,x:624561,y:578039},{j:116.433552,w:39.914694,utm_x:12961464.75,utm_y:4825879.53,x:652972,y:591348},{j:116.457034,w:39.914273,utm_x:12964078.78,utm_y:4825818.67,x:663028,y:596444},{j:116.490927,w:39.914127,utm_x:12967851.77,utm_y:4825797.57,x:677968,y:604188},{j:116.483839,w:39.877198,utm_x:12967062.73,utm_y:4820460.67,x:658596,y:610312},{j:116.405777,w:39.864461,utm_x:12958372.82,utm_y:4818620.62,x:619256,y:596088},{j:116.35345,w:39.859774,utm_x:12952547.74,utm_y:4817943.6,x:594633,y:585851},{j:116.403818,w:39.9141,utm_x:12958154.74,utm_y:4825793.66,x:639699,y:585226},{j:116.318111,w:39.891101,utm_x:12948613.78,utm_y:4822469.56,x:592856,y:571480},{j:116.413047,w:39.907238,utm_x:12959182.12,utm_y:4824801.76,x:640680,y:588704},{j:116.390843,w:39.906113,utm_x:12956710.35,utm_y:4824639.16,x:630620,y:584108},{j:116.446527,w:39.899438,utm_x:12962909.14,utm_y:4823674.4,x:651752,y:597416},{j:116.388665,w:39.95527,utm_x:12956467.9,utm_y:4831746.87,x:650656,y:572800},{j:116.398343,w:39.939704,utm_x:12957545.26,utm_y:4829495.6,x:648036,y:578452},{j:116.355101,w:39.973581,utm_x:12952731.53,utm_y:4834395.82,x:643268,y:560944},{j:116.380727,w:39.88464,utm_x:12955584.23,utm_y:4821535.94,x:616920,y:586496},{j:116.360843,w:39.946452,utm_x:12953370.73,utm_y:4830471.48,x:635293,y:568765},{j:116.340955,w:39.973421,utm_x:12951156.79,utm_y:4834372.67,x:638420,y:558632},{j:116.322585,w:40.023941,utm_x:12949111.83,utm_y:4841684.79,x:652135,y:543802},{j:116.356486,w:39.883341,utm_x:12952885.71,utm_y:4821348.24,x:606050,y:581443},{j:116.339592,w:39.992259,utm_x:12951005.06,utm_y:4837098.59,x:645664,y:554400},{j:116.3778,w:39.86392,utm_x:12955258.4,utm_y:4818542.48,x:606848,y:590328},{j:116.377354,w:39.964124,utm_x:12955208.75,utm_y:4833027.64,x:649911,y:568581},{j:116.361837,w:39.963897,utm_x:12953481.39,utm_y:4832994.8,x:643286,y:565175},{j:116.441397,w:39.939403,utm_x:12962338.06,utm_y:4829452.07,x:666772,y:587728},{j:116.359176,w:40.006631,utm_x:12953185.16,utm_y:4839178.78,x:660440,y:555411}],sz:[{j:113.88099,w:22.58884,utm_x:12677311.76,utm_y:2565810.52,x:569078,y:532290},{j:113.902002,w:22.566098,utm_x:12679650.83,utm_y:2563084.58,x:568318,y:545457},{j:113.869843,w:22.577711,utm_x:12676070.87,utm_y:2564476.5,x:561115,y:532494},{j:113.943387,w:22.555192,utm_x:12684257.84,utm_y:2561777.5,x:579437,y:558427},{j:113.899505,w:22.577052,utm_x:12679372.86,utm_y:2564397.51,x:571923,y:540181},{j:113.900376,w:22.596431,utm_x:12679469.82,utm_y:2566720.51,x:580142,y:535463},{j:113.92101,w:22.528931,utm_x:12681766.81,utm_y:2558630.58,x:560296,y:559780},{j:113.919672,w:22.517839,utm_x:12681617.86,utm_y:2557301.57,x:555296,y:562549},{j:113.938716,w:22.505569,utm_x:12683737.86,utm_y:2555831.55,x:557349,y:571072},{j:113.919203,w:22.483494,utm_x:12681565.66,utm_y:2553187.17,x:540853,y:572118},{j:113.942875,w:22.492046,utm_x:12684200.84,utm_y:2554211.57,x:553296,y:575994},{j:113.9567,w:22.530183,utm_x:12685739.85,utm_y:2558780.59,x:573378,y:568442},{j:113.989102,w:22.52697,utm_x:12689346.86,utm_y:2558395.61,x:584796,y:578728},{j:114.015467,w:22.533746,utm_x:12692281.83,utm_y:2559207.53,x:597126,y:584075},{j:113.972977,w:22.55702,utm_x:12687551.81,utm_y:2561996.58,x:591204,y:565924},{j:113.990368,w:22.561133,utm_x:12689487.79,utm_y:2562489.51,x:599240,y:569528},{j:114.143745,w:22.580535,utm_x:12706561.83,utm_y:2564815,x:663830,y:605622},{j:114.150374,w:22.557704,utm_x:12707299.77,utm_y:2562078.56,x:657016,y:613828},{j:114.106905,w:22.541858,utm_x:12702460.77,utm_y:2560179.58,x:634284,y:606528},{j:114.083927,w:22.535065,utm_x:12699902.85,utm_y:2559365.58,x:623132,y:602096},{j:114.049584,w:22.517997,utm_x:12696079.76,utm_y:2557320.5,x:603390,y:597564},{j:114.056304,w:22.542425,utm_x:12696827.84,utm_y:2560247.52,x:615980,y:592534},{j:114.051552,w:22.551321,utm_x:12696298.84,utm_y:2561313.59,x:617887,y:588719},{j:114.096377,w:22.559064,utm_x:12701288.79,utm_y:2562241.55,x:637568,y:598739},{j:114.135858,w:22.575851,utm_x:12705683.84,utm_y:2564253.55,x:659024,y:604806},{j:114.092029,w:22.575592,utm_x:12700804.77,utm_y:2564222.51,x:642776,y:592932},{j:114.054795,w:22.570617,utm_x:12696659.85,utm_y:2563626.21,x:626988,y:584142},{j:114.03075,w:22.553687,utm_x:12693983.15,utm_y:2561597.14,x:611068,y:582552},{j:114.074153,w:22.554124,utm_x:12698814.8,utm_y:2561649.51,x:627380,y:594008},{j:113.926721,w:22.546028,utm_x:12682402.56,utm_y:2560679.29,x:569340,y:556468},{j:113.938125,w:22.538296,utm_x:12683672.07,utm_y:2559752.74,x:570548,y:561748}],gz:[{j:113.335098,w:23.147289,utm_x:12616542.68,utm_y:2632892.7,x:1129109,y:1073920},{j:113.320932,w:23.146956,utm_x:12614965.71,utm_y:2632852.62,x:1125620,y:1071640},{j:113.321435,w:23.140119,utm_x:12615021.7,utm_y:2632029.65,x:1124032,y:1072882},{j:113.321471,w:23.119165,utm_x:12615025.71,utm_y:2629507.68,x:1118932,y:1076530},{j:113.340201,w:23.118616,utm_x:12617110.75,utm_y:2629441.61,x:1123238,y:1079667},{j:113.358068,w:23.116323,utm_x:12619099.71,utm_y:2629165.66,x:1126968,y:1083116},{j:113.357529,w:23.131271,utm_x:12619039.71,utm_y:2630964.68,x:1130508,y:1080440},{j:113.365811,w:23.150595,utm_x:12619961.67,utm_y:2633290.66,x:1137205,y:1078567},{j:113.294145,w:23.118467,utm_x:12611983.76,utm_y:2629423.68,x:1112245,y:1072043},{j:113.28615,w:23.121525,utm_x:12611093.75,utm_y:2629791.7,x:1110993,y:1070197},{j:113.307152,w:23.055497,utm_x:12613431.71,utm_y:2621847.21,x:1100144,y:1085123},{j:113.333445,w:23.052687,utm_x:12616358.66,utm_y:2621509.2,x:1105784,y:1089948},{j:113.347476,w:23.048755,utm_x:12617920.6,utm_y:2621036.24,x:1108099,y:1093064},{j:113.385774,w:23.036574,utm_x:12622183.96,utm_y:2619571.12,x:1113850,y:1101834},{j:113.364185,w:22.89798,utm_x:12619780.66,utm_y:2602910.64,x:1073186,y:1123374},{j:113.404577,w:22.906481,utm_x:12624277.13,utm_y:2603932.06,x:1084888,y:1128692},{j:113.430856,w:22.913156,utm_x:12627202.52,utm_y:2604734.12,x:1092892,y:1131761},{j:113.384554,w:22.933021,utm_x:12622048.15,utm_y:2607121.32,x:1086975,y:1120403},{j:113.263566,w:23.146333,utm_x:12608579.68,utm_y:2632777.63,x:1111742,y:1062098},{j:113.239213,w:23.152996,utm_x:12605868.69,utm_y:2633579.69,x:1107616,y:1056740},{j:113.253865,w:23.131628,utm_x:12607499.76,utm_y:2631007.65,x:1105912,y:1062966},{j:113.240767,w:23.088434,utm_x:12606041.68,utm_y:2625809.7,x:1092270,y:1068184},{j:113.279628,w:23.088284,utm_x:12610367.72,utm_y:2625791.65,x:1101412,y:1074883},{j:113.462271,w:23.107058,utm_x:12630699.66,utm_y:2628050.7,x:1148752,y:1101736},{j:113.401618,w:23.052957,utm_x:12623947.73,utm_y:2621541.68,x:1121925,y:1101535},{j:113.422504,w:23.05905,utm_x:12626272.77,utm_y:2622274.61,x:1128470,y:1104049},{j:113.362506,w:23.107149,utm_x:12619593.75,utm_y:2628061.65,x:1125835,y:1085505},{j:113.419629,w:23.143176,utm_x:12625952.73,utm_y:2632397.61,x:1148133,y:1089052},{j:113.23315,w:23.062251,utm_x:12605193.75,utm_y:2622659.67,x:1084184,y:1071368},{j:113.314525,w:23.101412,utm_x:12614252.48,utm_y:2627371.29,x:1113011,y:1078426},{j:113.307947,w:23.131369,utm_x:12613520.21,utm_y:2630976.47,x:1118622,y:1072198}],sh:[{j:121.524411,w:31.245875,utm_x:13528182.75,utm_y:3642354.51,x:1086581,y:1065728},{j:121.419229,w:31.244887,utm_x:13516473.81,utm_y:3642226.51,x:1032616,y:1029148},{j:121.405637,w:31.237871,utm_x:13514960.74,utm_y:3641317.54,x:1022724,y:1027244},{j:121.415348,w:31.222879,utm_x:13516041.78,utm_y:3639375.47,x:1018548,y:1036980},{j:121.422561,w:31.224261,utm_x:13516844.73,utm_y:3639554.48,x:1022976,y:1038908},{j:121.412581,w:31.204148,utm_x:13515733.75,utm_y:3636949.48,x:1006568,y:1043696},{j:121.443025,w:31.206202,utm_x:13519122.8,utm_y:3637215.49,x:1022656,y:1053704},{j:121.524061,w:31.246917,utm_x:13528143.79,utm_y:3642489.52,x:1082052,y:1064124},{j:121.529343,w:31.217769,utm_x:13528731.78,utm_y:3638713.59,x:1072696,y:1079064},{j:121.530268,w:31.210341,utm_x:13528834.75,utm_y:3637751.53,x:1068748,y:1082416},{j:121.511601,w:31.227303,utm_x:13526756.73,utm_y:3639948.53,x:1069276,y:1068716},{j:121.4966,w:31.243614,utm_x:13525086.81,utm_y:3642061.58,x:1071220,y:1056805},{j:121.485021,w:31.26138,utm_x:13523797.82,utm_y:3644363.54,x:1075708,y:1045540},{j:121.465114,w:31.278803,utm_x:13521581.76,utm_y:3646621.48,x:1073740,y:1031268},{j:121.454784,w:31.266566,utm_x:13520431.82,utm_y:3645035.58,x:1063591,y:1033191},{j:121.46851,w:31.24951,utm_x:13521959.81,utm_y:3642825.48,x:1060200,y:1044520},{j:121.446384,w:31.248422,utm_x:13519496.73,utm_y:3642684.51,x:1048784,y:1037750},{j:121.509499,w:31.246469,utm_x:13526522.73,utm_y:3642431.47,x:1079309,y:1060105},{j:121.481643,w:31.283943,utm_x:13523421.78,utm_y:3647287.68,x:1087096,y:1035304},{j:121.508054,w:31.280609,utm_x:13526361.87,utm_y:3646855.56,x:1098432,y:1045648},{j:121.493854,w:31.19121,utm_x:13524781.12,utm_y:3635274.07,x:1039624,y:1077288},{j:121.500079,w:31.185541,utm_x:13525474.09,utm_y:3634540.04,x:1039960,y:1081640},{j:121.484482,w:31.202846,utm_x:13523737.82,utm_y:3636780.87,x:1041388,y:1069232},{j:121.480877,w:31.189587,utm_x:13523336.51,utm_y:3635063.92,x:1032484,y:1073640},{j:121.502652,w:31.195209,utm_x:13525760.52,utm_y:3635791.9,x:1046384,y:1078728}]},getLnglatIndex:function(t,e,i){for(var n=0,o=0,s=1e7,a=1e9,r=0;r<this.correct_pts[t].length;r++){var l=this.getDis(this.correct_pts[t][r].x,this.correct_pts[t][r].y,e,i);l<a&&(l<s?(a=s,s=l,o=n,n=r):(sedMinDis=l,o=r))}return{lt:n,rb:o}},getOMapIndex_mm:function(t,e,i){for(var n=0,o=0,s=1294723e3,a=1294723e3,r=0;r<this.correct_pts[t].length;r++){var l=this.getDis(this.correct_pts[t][r].utm_x,this.correct_pts[t][r].utm_y,e,i);l<a&&(l<s?(a=s,s=l,o=n,n=r):(sedMinDis=l,o=r))}return{lt:n,rb:o}},getDis:function(t,e,i,n){return Math.abs(t-i)+Math.abs(e-n)},toMap:function(t,e,i){return{x:(e-i)*this.num[t].num,y:(e+i)*this.num[t].num*this.num[t].num2}},fromMap:function(t,e,i){return{x:(e+(i/=this.num[t].num2))/(2*this.num[t].num),y:(i-e)/(2*this.num[t].num)}},getDgPix_mm:function(t,e,i){var n=this.fromMap(t,this.correct_pts[t][e].x,this.correct_pts[t][e].y),o=this.fromMap(t,this.correct_pts[t][i].x,this.correct_pts[t][i].y),s=n.x,a=n.y,r=o.x,l=o.y,h=this.correct_pts[t][e].utm_x,c=this.correct_pts[t][e].utm_y,u=this.correct_pts[t][i].utm_x,p=this.correct_pts[t][i].utm_y,d=Math.abs(1e5*(u-h)/(r-s)),_=Math.abs(1e5*(p-c)/(l-a));return{j:d,w:_,x:1e5/d,y:1e5/_}},getPx_mm:function(t,e,i,n,o){var s=this.correct_pts[t][n],a=this.correct_pts[t][n],r=this.getDgPix_mm(t,n,o),l=this.fromMap(t,s.x,s.y),h=a.utm_x,c=a.utm_y,u=e,p=i,d=l.x,_=l.y,f=p-c,g=(u-h)*r.x+d,m=-f*r.y+_;return this.toMap(t,g,m)},getJw_mm:function(t,e,i,n,o){var s=this.correct_pts[t][n],a=this.correct_pts[t][n],r=this.getDgPix_mm(t,n,o),l=this.fromMap(t,e,i),h=this.fromMap(t,s.x,s.y),c=a.utm_x,u=a.utm_y,p=h.x,d=h.y,_=l.x-p,f=d-l.y;return{lng:_/r.x+c,lat:f/r.y+u}},getOMap_pts:function(t,e){return this.getOMap_index(t,e.lng,e.lat,e.lt,e.rb)},getMapJw_pts:function(t,e){return this.getMapJw_index(t,e.lng,9998336-e.lat,e.lt,e.rb)},getOMap_mm:function(t,e,i){var n=this.getOMapIndex_mm(t,e,i);return this.getOMap_index(t,e,i,n.lt,n.rb)},getMapJw_mm:function(t,e,i){i=9998336-i;var n=this.getLnglatIndex(t,e,i);return this.getMapJw_index(t,e,i,n.lt,n.rb)},getMapJw_Array:function(t,e){for(var i=this.getLnglatIndex(t,e[0].lng,e[0].lat),n=new Array,o=0;o<e.length;o++){var s=this.getJw_mm(t,e[o].lng,e[o].lat,i.lt,i.rb);n[o]={lng:s.lng,lat:s.lat,lt:i.lt,rb:i.rb}}return n},getOMap_Array:function(t,e){for(var i=this.getOMapIndex_mm(t,e[0].lng,e[0].lat),n=new Array,o=0;o<e.length;o++){var s=this.getPx_mm(t,e[o].lng,e[o].lat,i.lt,i.rb);n[o]={lng:s.x,lat:s.y,lt:i.lt,rb:i.rb}}return n},getOMap_index:function(t,e,i,n,o){if(n&&o)s={lt:n,rb:o};else var s=this.getOMapIndex_mm(t,e,i);var a=this.getPx_mm(t,e,i,s.lt,s.rb);return{x:Math.floor(a.x),y:9998336-Math.floor(a.y),lt:s.lt,rb:s.rb}},getMapJw_index:function(t,e,i,n,o){if(n&&o)s={lt:n,rb:o};else var s=this.getLnglatIndex(t,e,i);var a=this.getJw_mm(t,e,i,s.lt,s.rb);return{lng:a.lng,lat:a.lat,lt:s.lt,rb:s.rb}}}),z.inherits(E,"DataRequest"),l.extend(z.prototype,{send:function(e,i){this.url=e,this.userData=i;var n=this,o=t("script");o.type="text/javascript",o.userData=i,o.setAttribute("defer","true"),o.defer=!0,o.loaded=!1,o.stime=(new Date).getTime(),o.addEventListener?(o.addEventListener("load",function(t){n._loadData(n.objName,o)},!1),o.addEventListener("error",function(t){n._loadError(n.objName,o)},!1)):o.attachEvent&&o.attachEvent("onreadystatechange",function(t){var e=window.event.srcElement;o.timer=setInterval(function(){o.etime=(new Date).getTime();var t=parseInt(o.etime-o.stime);!e||"loaded"!=e.readyState&&"complete"!=e.readyState||(o.loaded=!0),1==o.loaded?(n._loadData(n.objName,o),clearInterval(o.timer)):t>5e3&&(n._loadError(n.objName,o),clearInterval(o.timer))},5)}),o.charset=n.charset,o.src=n.url,document.getElementsByTagName("head")[0].appendChild(o)},_loadData:function(t,e){var i=window[t],n=new aw("onloaded");n.data=i;for(var o in e.userData)!n[o]&&e.userData[o]&&(n[o]=e.userData[o]);this.dispatchEvent(n),e.parentNode&&e.parentNode.removeChild(e),e=null},_loadError:function(t,e){e.parentNode&&e.parentNode.removeChild(e),e=null}});var aI={request:function(e){var i=t("script",{src:e,type:"text/javascript",charset:"utf-8"});i.addEventListener?i.addEventListener("load",function(t){var e=t.target;e.parentNode.removeChild(e)},!1):i.attachEvent&&i.attachEvent("onreadystatechange",function(t){var e=window.event.srcElement;!e||"loaded"!=e.readyState&&"complete"!=e.readyState||e.parentNode.removeChild(e)}),setTimeout(function(){document.getElementsByTagName("head")[0].appendChild(i),i=null},1)}};l.extend(aq,{Request:{INITIAL:-1,WAITING:0,COMPLETED:1},Dependency:{control:[],marker:[],poly:["marker"],infowindow:["marker"],hotspot:["poly"],menu:[],tools:["marker","poly"],oppc:[],opmb:[],"3dmap":["hotspot"]},preLoaded:{},Config:{_baseUrl:"https://api.map.baidu.com/getmodules?v=1.1",_timeout:5e3},delayFlag:!1,Module:{_modules:{},_arrMdls:[]},load:function(t,e){var i=this.current(t);if(i._status!=this.Request.COMPLETED){if(i._status==this.Request.INITIAL){this.combine(t),this.pushUniqueMdl(t);var n=this;0==n.delayFlag&&(n.delayFlag=!0,window.setTimeout(function(){var t=n.Config._baseUrl+"&mod="+n.Module._arrMdls.join(",");aI.request(t),n.Module._arrMdls.length=0,n.delayFlag=!1},1)),i._status=this.Request.WAITING}i._callbacks.push(e)}},combine:function(t){if(t&&this.Dependency[t])for(var e=this.Dependency[t],i=0;i<e.length;i++)this.combine(e[i]),this.Module._modules[e[i]]||this.pushUniqueMdl(e[i])},pushUniqueMdl:function(t){for(var e=0;e<this.Module._arrMdls.length;e++)if(this.Module._arrMdls[e]==t)return;this.Module._arrMdls.push(t)},run:function(aV,aX){var aU=this.current(aV);try{eval(aX)}catch(t){return}aU._status=this.Request.COMPLETED;for(var aW=0,aT=aU._callbacks.length;aW<aT;aW++)aU._callbacks[aW]();aU._callbacks.length=0},check:function(t,e){var i=this;i.timeout=setTimeout(function(){i.Module._modules[t]._status!=i.Request.COMPLETED?(i.remove(t),i.load(t,e)):clearTimeout(i.timeout)},i.Config._timeout)},current:function(t){return this.Module._modules[t]||(this.Module._modules[t]={},this.Module._modules[t]._status=this.Request.INITIAL,this.Module._modules[t]._callbacks=[]),this.Module._modules[t]},remove:function(t){this.current(t)}}),window._jsload=function(t,e){aq.run(t,e)},P.inherits(E,"Control"),l.extend(P.prototype,{initialize:function(t){if(this._map=t,this._container)return t.container.appendChild(this._container),this._container},_i:function(t){!this._container&&this.initialize&&av(this.initialize)&&(this._container=this.initialize(t)),this._opts=this._opts||{printable:!1},this._setStyle(),this._setPosition(),this._container&&(this._container._jsobj=this)},_setStyle:function(){var t=this._container;if(t){var e=t.style;e.position="absolute",e.zIndex=this._cZIndex||"10",e.MozUserSelect="none",this._opts.printable||l.ac(t,"BMap_noprint"),l.on(t,"contextmenu",aC)}},remove:function(){this._map=null,this._container&&(this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._container._jsobj=null,this._container=null)},_render:function(){return this._container=Z(this._map.container,"<div unselectable='on'></div>"),0==this._visible&&(this._container.style.display="none"),this._container},_setPosition:function(){this.setAnchor(this._opts.anchor)},setAnchor:function(t){(this.anchorFixed||"number"!=typeof t||isNaN(t)||t<BMAP_ANCHOR_TOP_LEFT||t>BMAP_ANCHOR_BOTTOM_RIGHT)&&(t=this.defaultAnchor),this._opts=this._opts||{printable:!1},this._opts.offset=this._opts.offset||this.defaultOffset;var e=this._opts.anchor;if(this._opts.anchor=t,this._container){var i=this._container,n=this._opts.offset.width,o=this._opts.offset.height;switch(i.style.left=i.style.top=i.style.right=i.style.bottom="auto",t){case BMAP_ANCHOR_TOP_LEFT:i.style.top=o+"px",i.style.left=n+"px";break;case BMAP_ANCHOR_TOP_RIGHT:i.style.top=o+"px",i.style.right=n+"px";break;case BMAP_ANCHOR_BOTTOM_LEFT:i.style.bottom=o+"px",i.style.left=n+"px";break;case BMAP_ANCHOR_BOTTOM_RIGHT:i.style.bottom=o+"px",i.style.right=n+"px"}var s=["TL","TR","BL","BR"];l.rc(this._container,"anchor"+s[e]),l.ac(this._container,"anchor"+s[t])}},getAnchor:function(){return this._opts.anchor},setOffset:function(t){!t||t&&"Size"!=t.toString()||(this._opts=this._opts||{printable:!1},this._opts.offset=new X(t.width,t.height),this._container&&this.setAnchor(this._opts.anchor))},getOffset:function(){return this._opts.offset},getDom:function(){return this._container},show:function(){1!=this._visible&&(this._visible=!0,this._container&&(this._container.style.display=""))},hide:function(){0!=this._visible&&(this._visible=!1,this._container&&(this._container.style.display="none"))},isPrintable:function(){return!!this._opts.printable},isVisible:function(){return!(!this._container&&!this._map)&&!!this._visible}}),window.BMAP_ANCHOR_TOP_LEFT=0,window.BMAP_ANCHOR_TOP_RIGHT=1,window.BMAP_ANCHOR_BOTTOM_LEFT=2,window.BMAP_ANCHOR_BOTTOM_RIGHT=3,K.inherits(P,"CopyrightControl"),l.extend(K.prototype,{initialize:function(t){return this._map=t,this._container},addCopyright:function(t){if(t&&"number"==typeof t.id&&!isNaN(t.id)){var e={minZoom:0,bounds:null,content:"",mapType:""};for(var i in t)e[i]=t[i];if(this._map){var n=e.minZoom;(-1==n||n<aJ[this._map.mapType].zoomLevelMin||n>aJ[this._map.mapType].zoomLevelMax)&&(e.minZoom=aJ[this._map.mapType].zoomLevelMin),""==e.mapType||aJ[e.mapType]||(e.mapType=BMAP_NORMAL_MAP)}var o=this.getCopyright(t.id);if(o)for(var s in e)o[s]=e[s];else this._copyrightCollection.push(e)}},getCopyright:function(t){for(var e=0,i=this._copyrightCollection.length;e<i;e++)if(this._copyrightCollection[e].id==t)return this._copyrightCollection[e]},getCopyrightCollection:function(){return this._copyrightCollection},removeCopyright:function(t){for(var e=0,i=this._copyrightCollection.length;e<i;e++)this._copyrightCollection[e].id==t&&(r=this._copyrightCollection.splice(e,1),e--,i=this._copyrightCollection.length)},_asyncLoadCode:function(){var t=this;aq.load("control",function(){t._asyncDraw()})}}),ah.inherits(P,"OverviewMapControl"),l.extend(ah.prototype,{initialize:function(t){return this._map=t,this._container},setAnchor:function(t){P.prototype.setAnchor.call(this,t)},changeView:function(){this.changeView._running=!0,this._opts.isOpen=!this._opts.isOpen,this._container||(this.changeView._running=!1)},setSize:function(t){t&&"Size"==t.toString()||(t=new X(150,150)),t.width=t.width>0?t.width:150,t.height=t.height>0?t.height:150,this._opts.size=t},getSize:function(){return this.isOpen()?this._opts.size:new X(this._btnWidth,this._btnHeight)},isOpen:function(){return this._opts.isOpen},_asyncLoadCode:function(){var t=this;aq.load("control",function(){t._asyncDraw()})}}),window.BMAP_UNIT_METRIC="metric",window.BMAP_UNIT_IMPERIAL="us",T.inherits(P,"ScaleControl"),l.extend(T.prototype,{initialize:function(t){return this._map=t,this._container},setUnit:function(t){this._opts.unit=this._units[t]&&this._units[t].name||this._opts.unit},getUnit:function(){return this._opts.unit},_asyncLoadCode:function(){var t=this;aq.load("control",function(){t._asyncDraw()})}}),window.BMAP_NAVIGATION_CONTROL_LARGE=0,window.BMAP_NAVIGATION_CONTROL_SMALL=1,window.BMAP_NAVIGATION_CONTROL_PAN=2,window.BMAP_NAVIGATION_CONTROL_ZOOM=3,H.inherits(P,"NavigationControl"),l.extend(H.prototype,{initialize:function(t){return this._map=t,this._container},setType:function(t){"number"==typeof t&&t>=BMAP_NAVIGATION_CONTROL_LARGE&&t<=BMAP_NAVIGATION_CONTROL_ZOOM?this._opts.type=t:this._opts.type=BMAP_NAVIGATION_CONTROL_LARGE},getType:function(){return this._opts.type},_asyncLoadCode:function(){var t=this;aq.load("control",function(){t._asyncDraw()})}}),ae.inherits(P,"MapTypeControl"),l.extend(ae.prototype,{initialize:function(t){return this._map=t,this._container},select:function(t){},_asyncLoadCode:function(){var t=this;aq.load("control",function(){t._asyncDraw()})}}),g.inherits(E,"ContextMenu"),l.extend(g.prototype,{initialize:function(t){this._map=t},remove:function(){this._map=null},addItem:function(t){if(t&&"menuitem"==t._type&&""!=t._text&&!(t._width<=0)){for(var e=0,i=this._items.length;e<i;e++)if(this._items[e]===t)return;this._items.push(t),this._rItems.push(t)}},removeItem:function(t){if(t&&"menuitem"==t._type){for(var e=0,i=this._items.length;e<i;e++)this._items[e]===t&&(this._items[e].remove(),this._items.splice(e,1),i--);for(var e=0,i=this._rItems.length;e<i;e++)this._rItems[e]===t&&(this._rItems[e].remove(),this._rItems.splice(e,1),i--)}},addSeparator:function(){this._items.push({_type:"divider",_dIndex:this._dividers.length}),this._dividers.push({dom:null})},removeSeparator:function(t){if(this._dividers[t]){for(var e=0,i=this._items.length;e<i;e++)this._items[e]&&"divider"==this._items[e]._type&&this._items[e]._dIndex==t&&(this._items.splice(e,1),i--),this._items[e]&&"divider"==this._items[e]._type&&this._items[e]._dIndex>t&&this._items[e]._dIndex--;this._dividers.splice(t,1)}},getDom:function(){return this._container},show:function(){1!=this._isOpen&&(this._isOpen=!0)},hide:function(){0!=this._isOpen&&(this._isOpen=!1)},setCursor:function(t){t&&(this._opts.cursor=t)},getItem:function(t){return this._rItems[t]},enable:function(){this._enable=!0},disable:function(){this._enable=!1}}),L.inherits(E,"MenuItem"),l.extend(L.prototype,{initialize:function(t,e){this._map=t,this._contextmenu=e},remove:function(){this._contextmenu=null,this._map=null},setText:function(t){t&&(this._text=t+"")},getDom:function(){return this._container},enable:function(){this._enabled=!0},disable:function(){this._enabled=!1}}),l.extend(y.prototype,{isEmpty:function(){var t="number";return typeof this.minX!=t||typeof this.minY!=t||typeof this.maxX!=t||typeof this.maxY!=t},equals:function(t){if(t&&"Bounds"==t.toString())return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},getMaxX:function(){return this.maxX},getMaxY:function(){return this.maxY},getMinX:function(){return this.minX},getMinY:function(){return this.minY},containsBounds:function(t){if(t&&"Bounds"==t.toString())return t.minX>this.minX&&t.maxX<this.maxX&&t.minY>this.minY&&t.maxY<this.maxY},getCenterPoint:function(){return new f((this.minX+this.maxX)/2,(this.minY+this.maxY)/2)},getCenter:function(){return this.getCenterPoint()},intersects:function(t){if(t&&"Bounds"==t.toString()){if(Math.max(t.minX,t.maxX)<Math.min(this.minX,this.maxX)||Math.min(t.minX,t.maxX)>Math.max(this.minX,this.maxX)||Math.max(t.minY,t.maxY)<Math.min(this.minY,this.maxY)||Math.min(t.minY,t.maxY)>Math.max(this.minY,this.maxY))return null;var e=Math.max(this.minX,t.minX),i=Math.min(this.maxX,t.maxX);return new y(e,Math.max(this.minY,t.minY),i,Math.min(this.maxY,t.maxY))}},containsPoint:function(t){if(t&&"Point"==t.toString())return t.lng>=this.minX&&t.lng<=this.maxX&&t.lat>=this.minY&&t.lat<=this.maxY},extend:function(t){if(t&&"Point"==t.toString()){var e=t.lng,i=t.lat;(!this.minX||this.minX>e)&&(this.minX=e),(!this.maxX||this.maxX<e)&&(this.maxX=e),(!this.minY||this.minY>i)&&(this.minY=i),(!this.maxY||this.maxY<i)&&(this.maxY=i)}},getIntersectLine:function(t){if(t&&"Line"==t.toString()){var e=t.sPoint,i=t.ePoint,n=[];return e.lat==i.lat?e.lng==i.lng?null:(e.lat>this.minY&&(e.lat,this.maxY),t=new Line(n.lng,n.lat)):void 0}},getMin:function(){return new f(this.minX,this.minY)},getMax:function(){return new f(this.maxX,this.maxY)},toString:function(){return"Bounds"}});var u=f.prototype;u.equals=function(t){if(t&&"Point"==t.toString())return this.lat==t.lat&&this.lng==t.lng},u.toString=function(){return"Point"},x.inherits(E,"Area"),x.prototype={containsPoint:function(t){for(var e=0,i=0,n=this.points,o=0;o<n.length;o++)e=o==n.length-1?0:e+1,n[o].lat!=n[e].lat&&(t.lat>=n[o].lat&&t.lat<n[e].lat||t.lat>=n[e].lat&&t.lat<n[o].lat)&&t.lng<(n[e].lng-n[o].lng)*(t.lat-n[o].lat)/(n[e].lat-n[o].lat)+n[o].lng&&i++;return i%2>0},getQuad:function(t){return t.lng>=0?t.lat>=0?0:3:t.lat>=0?1:2}};var aL={undo:1,redo:2,zoom:4,drag:8,move:16,mousewheel:32,toolbarOperation:64,stdMapCtrlDrag:128,dblclick:256},ap={_map:null,_html:"<div class='BMap_opMask' unselectable='on'></div>",_maskElement:null,_cursor:"default",inUse:!1,show:function(t){this._map||(this._map=t),this.inUse=!0,this._maskElement||this._createMask(t),this._maskElement.style.display="block"},_createMask:function(t){if(this._map||(this._map=t),this._map){var e=this._maskElement=Z(this._map.container,this._html);l.on(e,"mouseup",function(t){2==t.button&&aC(t)}),l.on(e,"contextmenu",aC),e.style.display="none"}},getDrawPoint:function(t,e,i){var n=(t=window.event||t).layerX||t.offsetX||0,o=t.layerY||t.offsetY||0,s=t.target||t.srcElement;if(s!=ap.getDom(this._map)&&1==e)for(;s&&s!=this._map.container;)0==s.clientWidth&&0==s.clientHeight&&s.offsetParent&&"td"==s.offsetParent.nodeName.toLowerCase()||(n+=s.offsetLeft,o+=s.offsetTop),s=s.offsetParent;if(!(s!=ap.getDom(this._map)&&s!=this._map.container||void 0===n||void 0===o||isNaN(n)||isNaN(o)))return i&&(n+=i.x,o+=i.y),this._map.pixelToPoint(new aK(n,o))},hide:function(){this._map&&(this.inUse=!1,this._maskElement&&(this._maskElement.style.display="none"))},getDom:function(t){return this._maskElement||this._createMask(t),this._maskElement},setCursor:function(t){this._cursor=t||"default",this._maskElement&&(this._maskElement.style.cursor=this._cursor)}};O.inherits(l.BaseClass,"Overlay"),O.getZIndex=function(t,e){return(t*=1)?(e&&e==BMAP_COORD_MERCATOR&&(t=V.convertMC2LL(new BMap.Point(0,t)).lat),-1e5*t<<1):0},l.extend(O.prototype,{_i:function(t){!this.domElement&&av(this.initialize)&&(this.domElement=this.initialize(t),this.domElement&&(this.domElement.style.WebkitUserSelect="none")),this.draw()},initialize:function(t){throw"initialize方法未实现"},draw:function(){throw"draw方法未实现"},remove:function(){this.domElement&&this.domElement.parentNode&&this.domElement.parentNode.removeChild(this.domElement),this.domElement=null,this.dispatchEvent(new aw("onremove"))},hide:function(){l.hide(this.domElement)},show:function(){l.show(this.domElement)},isVisible:function(){return!!this.domElement&&("none"!=this.domElement.style.display&&"hidden"!=this.domElement.style.visibility)},dispose:function(){l.BaseClass.prototype.decontrol.call(this)}}),BMap.register(function(e){function i(e,i){var n=t("div"),o=n.style;return o.position="absolute",o.top=o.left=o.width=o.height="0",o.zIndex=i,e.appendChild(n),n}e.temp.overlayDiv=e.overlayDiv=i(e.platform,200),e._panes.floatPane=i(e.temp.overlayDiv,800),e._panes.markerMouseTarget=i(e.temp.overlayDiv,700),e._panes.floatShadow=i(e.temp.overlayDiv,600),e._panes.labelPane=i(e.temp.overlayDiv,500),e._panes.markerPane=i(e.temp.overlayDiv,400),e._panes.mapPane=i(e.temp.overlayDiv,200)}),aF.inherits(O,"OverlayInternal"),l.extend(aF.prototype,{initialize:function(t){return this.map=t,l.BaseClass.call(this,this.hashCode),null},draw:function(){},remove:function(){this.map=null,this.decontrol(),O.prototype.remove.call(this)},hide:function(){0!=this._visible&&(this._visible=!1)},show:function(){1!=this._visible&&(this._visible=!0)},isVisible:function(){return!!this.domElement&&!!this._visible},getDom:function(){return this.domElement},setConfig:function(t){t=t||{};for(var e in t)typeof this._config[e]==typeof t[e]&&(this._config[e]=t[e])},getPoint:function(){return this.point},setZIndex:function(t){this.zIndex=t},enableMassClear:function(){this._config.enableMassClear=!0},disableMassClear:function(){this._config.enableMassClear=!1}}),BMap.register(function(t){var e=new at;e.map=t,t._overlays=e._overlays,t._customOverlays=e._customOverlays,t.addEventListener("load",function(t){e.draw(t)}),t.addEventListener("moveend",function(t){e.draw(t)}),l.Browser.ie&&l.Browser.ie<8||"BackCompat"==document.compatMode?t.addEventListener("zoomend",function(t){setTimeout(function(){e.draw(t)},20)}):t.addEventListener("zoomend",function(t){e.draw(t)}),t.addEventListener("maptypechange",function(t){e.draw(t)}),t.addEventListener("addoverlay",function(t){var i=t.target;if(i instanceof aF)e._overlays[i.hashCode]||(e._overlays[i.hashCode]=i);else{for(var n=!1,o=0,s=e._customOverlays.length;o<s;o++)if(e._customOverlays[o]===i){n=!0;break}n||e._customOverlays.push(i)}}),t.addEventListener("removeoverlay",function(t){var i=t.target;if(i instanceof aF)delete e._overlays[i.hashCode];else for(var n=0,o=e._customOverlays.length;n<o;n++)if(e._customOverlays[n]===i){e._customOverlays.splice(n,1);break}}),t.addEventListener("clearoverlays",function(t){this.closeInfoWindow();for(var i in e._overlays)e._overlays[i]._config.enableMassClear&&(e._overlays[i].remove(),delete e._overlays[i]);for(var n=0,o=e._customOverlays.length;n<o;n++)0!=e._customOverlays[n].enableMassClear&&(e._customOverlays[n].remove(),e._customOverlays[n]=null,e._customOverlays.splice(n,1),n--,o--)}),t.addEventListener("infowindowopen",function(t){var e=this.infoWindow;e&&(l.hide(e.popDom),l.hide(e.shadowDom))}),t.addEventListener("movestart",function(){this.getInfoWindow()&&this.getInfoWindow()._setOverflow()}),t.addEventListener("moveend",function(){this.getInfoWindow()&&this.getInfoWindow()._resetOverflow()})}),at.prototype.draw=function(t){for(var e in this._overlays)this._overlays[e].draw();l.each(this._customOverlays,function(t){t.draw()}),this.map.temp.infoWin&&this.map.temp.infoWin.setPosition(),BMap.DrawerSelector&&BMap.DrawerSelector.getDrawer(this.map).setPalette()},au.inherits(aF,"Graph"),au.getGraphPoints=function(t){var e=[];if(!t)return e;if("string"==typeof t){var i=t.split(";");l.each(i,function(t){var i=t.split(",");e.push(new f(i[0],i[1]))})}return t.constructor==Array&&t.length>0&&(e=t),e},au.parseTolerance={0:[.09,.005,1e-4,1e-5],1:[9e3,500,10,1]},l.extend(au.prototype,{initialize:function(t){return this.map=t,null},draw:function(){},setPoints:function(t){this._parseCache.length=0,this.points=au.getGraphPoints(t).slice(0),this._calcBounds()},_calcBounds:function(){if(this.points){var t=this;t._bounds=new y,l.each(this.points,function(e){t._bounds.extend(e)})}},getPoints:function(){return this.points},setPointAt:function(t,e){e&&this.points[t]&&(this._parseCache.length=0,this.points[t]=new f(e.lng,e.lat),this._calcBounds())},setStrokeColor:function(t){this._config.strokeColor=t},getStrokeColor:function(){return this._config.strokeColor},setStrokeWeight:function(t){t>0&&(this._config.strokeWeight=t)},getStrokeWeight:function(){return this._config.strokeWeight},setStrokeOpacity:function(t){!t||t>1||t<0||(this._config.strokeOpacity=t)},getStrokeOpacity:function(){return this._config.strokeOpacity},setFillOpacity:function(t){t>1||t<0||(this._config.fillOpacity=t)},getFillOpacity:function(){return this._config.fillOpacity},setStrokeStyle:function(t){"solid"!=t&&"dashed"!=t||(this._config.strokeStyle=t)},getStrokeStyle:function(){return this._config.strokeStyle},setFillColor:function(t){this._config.fillColor=t||""},getFillColor:function(){return this._config.fillColor},getBounds:function(){return this._bounds},remove:function(){this.map&&this.map.removeEventListener("onmousemove",this._graphMouseEvent),aF.prototype.remove.call(this),this._parseCache.length=0},enableEditing:function(){this._config.enableEditing=!0},disableEditing:function(){this._config.enableEditing=!1}}),l.Browser.ie&&l.on(document.body,"load",function(){document.namespaces&&!document.namespaces.olv&&document.namespaces.add("olv","urn:schemas-microsoft-com:vml")}),aj.inherits(aF,"Division"),l.extend(aj.prototype,{_addDom:function(){var t=this._config,e=this.content,i=['<div class="BMap_Division" style="position:absolute;'];i.push("width:"+t.width+"px;display:block;"),i.push("overflow:hidden;"),"none"!=t.borderColor&&i.push("border:"+t.lineStroke+"px "+t.lineStyle+" "+t.lineColor+";"),i.push("opacity:"+t.opacity+"; filter:(opacity="+100*t.opacity+")"),i.push("background:"+t.background+";"),i.push('z-index:60;">'),i.push(e),i.push("</div>"),this.domElement=Z(this.map.getPanes().markerMouseTarget,i.join(""))},initialize:function(t){return this.map=t,this._addDom(),this.domElement&&l.on(this.domElement,"mousedown",function(t){ag(t)}),this.domElement},draw:function(){var t=this.map.pointToOverlayPixel(this._config.point);this._config.offset=new X(-Math.round(this._config.width/2)-Math.round(this._config.lineStroke),-Math.round(this._config.height/2)-Math.round(this._config.lineStroke)),this.domElement.style.left=t.x+this._config.offset.width+"px",this.domElement.style.top=t.y+this._config.offset.height+"px"},getPoint:function(){return this._config.point},_getPixel:function(t){return this.map.pointToPixel(this.getPoint())},setPoint:function(t){this._config.point=t,this.draw()},setDimension:function(t,e){this._config.width=Math.round(t),this._config.height=Math.round(e),this.domElement&&(this.domElement.style.width=this._config.width+"px",this.domElement.style.height=this._config.height+"px",this.draw())}});var R=w.prototype;R.setImageUrl=function(t){t&&(this.imageUrl=t)},R.setPrintImageUrl=function(t){t&&(this.printImageUrl=t)},R.setSize=function(t){t&&(this.size=new X(t.width,t.height))},R.setOffset=function(t){t&&(this.offset=new X(t.width,t.height))},R.setImageOffset=function(t){t&&(this.imageOffset=new X(t.width,t.height))},R.setInfoWindowOffset=function(t){t&&(this.infoWindowOffset=new X(t.width,t.height))},R.toString=function(){return"Icon"},ay.inherits(l.BaseClass,"InfoWindow"),l.extend(ay.prototype,{setWidth:function(t){!(t*=1)&&0!=t||isNaN(t)||t<0||(0!=t&&(t<220&&(t=220),t>730&&(t=730)),this._config.width=t)},setHeight:function(t){!(t*=1)&&0!=t||isNaN(t)||t<0||(0!=t&&(t<60&&(t=60),t>650&&(t=650)),this._config.height=t)},setMaxWidth:function(t){!(t*=1)&&0!=t||isNaN(t)||t<0||(0!=t&&(t<220&&(t=220),t>730&&(t=730)),this._config.maxWidth=t)},setTitle:function(t){this._config.title=t||""},setContent:function(t){this.content=t||""},setMaxContent:function(t){this._config.maxContent=t||""},redraw:function(){},enableAutoPan:function(){this._config.enableAutoPan=!0},disableAutoPan:function(){this._config.enableAutoPan=!1},enableCloseOnClick:function(){this._config.enableCloseOnClick=!0},disableCloseOnClick:function(){this._config.enableCloseOnClick=!1},enableMaximize:function(){this._config.enableMaximize=!0},disableMaximize:function(){this._config.enableMaximize=!1},show:function(){this._visible=!0},hide:function(){this._visible=!1},close:function(){this.hide()},dispose:function(){l.BaseClass.prototype.decontrol.call(this)},maximize:function(){this.isWinMax=!0},restore:function(){this.isWinMax=!1},setConfig:function(t){if(t)for(var e in t)typeof this._config[e]==typeof t[e]&&(this._config[e]=t[e])},isVisible:function(){return this.isOpen()},isOpen:function(){return!1},getPoint:function(){if(this.overlay&&this.overlay.getPoint)return this.overlay.getPoint()},getOffset:function(){return this._config.offset},toString:function(){return"InfoWindow"}}),C.prototype.openInfoWindow=function(t,e){if(t&&"InfoWindow"==t.toString()&&e&&"Point"==e.toString()){var i=this.temp;if(i.marker)i.marker.setPoint(e);else{var n=new w(aQ.imgPath+"blank.gif",{width:1,height:1});i.marker=new J(e,{icon:n,width:1,height:1,offset:new X(0,0),infoWindowOffset:new X(0,0),clickable:!1}),i.marker._fromMap=1}this.addOverlay(i.marker),i.marker.openInfoWindow(t)}},C.prototype.closeInfoWindow=function(){var t=this.temp.infoWin||this.temp._infoWin;t&&t.overlay&&t.overlay.closeInfoWindow()},aF.prototype.openInfoWindow=function(t){this.map&&(this.map.closeInfoWindow(),t._visible=!0,this.map.temp._infoWin=t,t.overlay=this,l.BaseClass.call(t,t.hashCode))},aF.prototype.closeInfoWindow=function(){this.map&&this.map.temp._infoWin&&(this.map.temp._infoWin._visible=!1,this.map.temp._infoWin.decontrol(),this.map.temp._infoWin=null)},q.inherits(aF,"Label"),l.extend(q.prototype,{setPoint:function(t){t&&"Point"==t.toString()&&!this.getMarker()&&(this.point=this._config.point=new f(t.lng,t.lat))},setContent:function(t){this.content=t},setOpacity:function(t){t>=0&&t<=1&&(this._config.opacity=t)},setOffset:function(t){t&&"Size"==t.toString()&&(this._config.offset=new X(t.width,t.height))},getOffset:function(){return this._config.offset},setStyle:function(t){t=t||{},this._config.styles=l.extend(this._config.styles,t)},setStyles:function(t){return this.setStyle(t)},setTitle:function(t){this._config.title=t||""},getTitle:function(){return this._config.title},setMarker:function(t){this._marker=t,this.point=this._config.point=t?t.getPoint():null},getMarker:function(){return this._marker||null}}),J.TOP_ZINDEX=O.getZIndex(-90)+1e6,J.DRAG_ZINDEX=J.TOP_ZINDEX+1e6,J.inherits(aF,"Marker"),l.extend(J.prototype,{setIcon:function(t){t&&"Icon"==t.toString()&&(this._config.icon=t)},setIconClassName:function(t){this.iconDom&&(this.iconDom.className=t)},getIcon:function(){return this._config.icon},setLabel:function(t){t&&"Label"==t.toString()&&(this._config.label=t)},getLabel:function(){return this._config.label},enableDragging:function(t){this._config.enableDragging=!0},disableDragging:function(){this._config.enableDragging=!1},setPoint:function(t){t&&"Point"==t.toString()&&(this.point=this._config.point=new f(t.lng,t.lat))},setTop:function(t,e){this._config.isTop=!!t,t&&(this._addi=e||0)},setTitle:function(t){this._config.title=t},getTitle:function(){return this._config.title||""},setOffset:function(t){t&&"Size"==t.toString()&&(this._config.offset=t)},getOffset:function(){return this._config.offset}}),c.inherits(au,"Polygon"),l.extend(c.prototype,{setPoints:function(t,e){this._userPoints=au.getGraphPoints(t).slice(0);var i=au.getGraphPoints(t).slice(0);i.length>1&&!i[0].equals(i[i.length-1])&&i.push(new f(i[0].lng,i[0].lat)),au.prototype.setPoints.call(this,i,e)},setPointAt:function(t,e){this._userPoints[t]&&(this._userPoints[t]=new f(e.lng,e.lat),this.points[t]=new f(e.lng,e.lat),0!=t||this.points[0].equals(this.points[this.points.length-1])||(this.points[this.points.length-1]=new f(e.lng,e.lat)),this._calcBounds())},getPoints:function(){var t=this._userPoints;return 0==t.length&&(t=this.points),t}}),ai.inherits(au,"Polyline"),Y.parseTolerance={0:[.01,1e-4,1e-5,4e-6],1:[1e3,10,1,.4]},Y.inherits(c,"Circle"),l.extend(Y.prototype,{initialize:function(t){return this.map=t,this.points=this._getPerimeterPoints(this.point,this.radius),this._calcBounds(),null},getPoint:function(){return this.point},getCenter:function(){return this.point},setPoint:function(t,e){t&&(this.point=t)},setCenter:function(t,e){this.setPoint(t,e)},getRadius:function(){return this.radius},setRadius:function(t,e){this.radius=Math.abs(t)},_getPerimeterPoints:function(t,e){if(!t||!e||!this.map)return[];var i=this.map,n=t.lng,o=t.lat;if(i.config.coordType==BMAP_COORD_MERCATOR){var s=ar.convertMC2LL(t);n=s.lng,o=s.lat}for(var a=[],r=e/6378800,l=Math.PI/180*o,h=Math.PI/180*n,c=0;c<360;c+=9){var u=Math.PI/180*c,p=Math.asin(Math.sin(l)*Math.cos(r)+Math.cos(l)*Math.sin(r)*Math.cos(u)),d=new f(((h-Math.atan2(Math.sin(u)*Math.sin(r)*Math.cos(l),Math.cos(r)-Math.sin(l)*Math.sin(p))+Math.PI)%(2*Math.PI)-Math.PI)*(180/Math.PI),p*(180/Math.PI));i.config.coordType==BMAP_COORD_LNGLAT?a.push(d):a.push(V.convertLL2MC(d))}var _=a[0];return a.push(new f(_.lng,_.lat)),a}}),G.inherits(c,"Rectangle"),l.extend(G.prototype,{setPoints:function(t){if(t){var e=t[0],i=t[1];if(e&&i&&"Point"==e.toString()&&"Point"==i.toString()){var n=e,o=i,s=new f(n.lng,o.lat),a=new f(o.lng,n.lat),r=e;this.points=[n,s,o,a,r],this._calcBounds()}}},getPoints:function(){return[this.points[0],this.points[2]]}}),aK.prototype.equals=function(t){return!!t&&(t.x==this.x&&t.y==this.y)},aK.prototype.toString=function(){return"Pixel"};var ar=V;l.extend(V,{EARTHRADIUS:6370996.81,MCBAND:[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],getDistanceByMC:function(t,e){if(void 0===t||void 0===e)return 0;var i,n,o,s;return void 0===(t=this.convertMC2LL(t))?0:(i=this.toRadians(t.lng),n=this.toRadians(t.lat),void 0===(e=this.convertMC2LL(e))?0:(o=this.toRadians(e.lng),s=this.toRadians(e.lat),this.getDistance(i,o,n,s)))},getDistanceByLL:function(t,e){if(void 0===t||void 0===e)return 0;t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74),e.lng=this.getLoop(e.lng,-180,180),e.lat=this.getRange(e.lat,-74,74);var i,n,o,s;return i=this.toRadians(t.lng),o=this.toRadians(t.lat),n=this.toRadians(e.lng),s=this.toRadians(e.lat),this.getDistance(i,n,o,s)},convertMC2LL:function(t){var e,i;e=new f(Math.abs(t.lng),Math.abs(t.lat));for(var n=0;n<this.MCBAND.length;n++)if(e.lat>=this.MCBAND[n]){i=this.MC2LL[n];break}var o=this.convertor(t,i);return t=new f(o.lng.toFixed(6),o.lat.toFixed(6))},convertLL2MC:function(t){var e,i;t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74),e=new f(t.lng,t.lat);for(n=0;n<this.LLBAND.length;n++)if(e.lat>=this.LLBAND[n]){i=this.LL2MC[n];break}if(!i)for(var n=this.LLBAND.length-1;n>=0;n--)if(e.lat<=-this.LLBAND[n]){i=this.LL2MC[n];break}var o=this.convertor(t,i);return t=new f(o.lng.toFixed(2),o.lat.toFixed(2))},convertor:function(t,e){if(t&&e){var i=e[0]+e[1]*Math.abs(t.lng),n=Math.abs(t.lat)/e[9],o=e[2]+e[3]*n+e[4]*n*n+e[5]*n*n*n+e[6]*n*n*n*n+e[7]*n*n*n*n*n+e[8]*n*n*n*n*n*n;return i*=t.lng<0?-1:1,o*=t.lat<0?-1:1,new f(i,o)}},getDistance:function(t,e,i,n){return this.EARTHRADIUS*Math.acos(Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos(e-t))},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},getRange:function(t,e,i){return null!=e&&(t=Math.max(t,e)),null!=i&&(t=Math.min(t,i)),t},getLoop:function(t,e,i){for(;t>i;)t-=i-e;for(;t<e;)t+=i-e;return t},convert2DTo3D:function(t,e){t||(t="bj");var i=m.getOMap_pts(t,e);return new f(i.x,i.y)},convert3DTo2D:function(t,e){t||(t="bj");var i=m.getMapJw_pts(t,e);return new f(i.lng,i.lat)},batch3DTo2D:function(t,e){return t||(t="bj"),m.getMapJw_Array(t,e)},batch2DTo3D:function(t,e){return t||(t="bj"),m.getOMap_Array(t,e)}}),X.prototype.equals=function(t){return!(!t||this.width!=t.width||this.height!=t.height)},X.prototype.toString=function(){return"Size"},BMap.register(function(t){var e=t.tileMgr=new aE(t);t.addEventListener("dragstart",function(t){e.dragStart(t)}),t.addEventListener("dragend",function(t){e.dragEnd(t)}),t.addEventListener("click",function(t){e.click(t)}),t.addEventListener("mousewheel",function(t){e.mouseWheel(t)}),t.addEventListener("dblclick",function(t){e.dblClick(t)}),t.addEventListener("rightdblclick",function(t){e.dblClick(t)}),t.addEventListener("minuspress",function(t){e.keypress(t)}),t.addEventListener("pluspress",function(t){e.keypress(t)}),t.addEventListener("load",function(t){e.loadTiles()}),t.addEventListener("zoomstartcode",function(t){e._zoom(t)}),t.addEventListener("moving",function(t){e.mend(t)}),t.addEventListener("resize",function(t){e.resizeMap(t)}),t.addEventListener("addtilelayer",function(t){e.addTileLayer(t)}),t.addEventListener("removetilelayer",function(t){e.removeTileLayer(t)})}),l.extend(aE.prototype,{addTileLayer:function(t){var e=this,i=t.target;e.tileLayers.push(i),e.map.loaded&&e.moveGridTiles(!0)},removeTileLayer:function(t){var e=this,i=t.target,n=i.mapType,o=e.mapTiles,s=e.bufferTiles;for(var a in s)(r=a.split("-")[1])==n&&delete s[a];for(var a in o){var r=a.split("-")[1];r==n&&delete o[a]}e.zoomsDiv&&e.zoomsDiv.parentNode&&(e.zoomsDiv.parentNode.removeChild(e.zoomsDiv),e.zoomsDiv.innerHTML="");for(var l=0,h=e.tileLayers.length;l<h;l++)i==e.tileLayers[l]&&(e.tileLayers.splice(l,1),delete i);e.moveGridTiles(!0)},getTileLayer:function(t){for(var e=this,i=0,n=e.tileLayers.length;i<n;i++)if(tilelayer=e.tileLayers[i],tilelayer.mapType==t)return tilelayer},mend:function(t){this.moveGridTiles(!0)},_zoom:function(t){var e=this;e.zoomsDiv&&"none"!=e.zoomsDiv.style.display&&(e.zoomsDiv.style.display="none"),setTimeout(function(){e.moveGridTiles(!0),e.map.dispatchEvent(new aw("onzoomend"))},10)},resizeMap:function(t){this.loaded=!1,this.moveGridTiles(!0)},showTile:function(t,e,i,n){this.centerPos=e;var o=aJ[n.mapType],s=this.getTileName(t,n),a=t[0]*o.tileSize+e[0],r=0;n.mapType==BMAP_PERSPECTIVE_MAP&&15==this.map.getZoom()&&(r=.5);var l=[a,(r-1-t[1])*o.tileSize+e[1]],h=this.mapTiles[s];if(h)i&&aR(h.img,l);else{if(h=this.bufferTiles[s]){this.imgNumber++,n.tilesDiv.insertBefore(h.img,n.tilesDiv.lastChild),this.mapTiles[s]=h,aR(h.img,l);var c=new aw("onimagechange");return c.action="cache",c.tile=this.getTileName(t,n),void this.map.dispatchEvent(c)}var u=o.baseUnits*Math.pow(2,o.zoomLevelMax-t[2]),p=(new f(t[0]*u,t[1]*u),new aK(t[0],t[1]));h=new ax(this,n.getTilesUrl(p,t[2]),l,t,n),this.mapTiles[s]=h}},getTileName:function(t,e){var i=e.mapType;return i==BMAP_PERSPECTIVE_MAP?"TILE-"+i+"-"+this.map.cityCode+"-"+t[0]+"-"+t[1]+"-"+t[2]:"TILE-"+i+"-"+t[0]+"-"+t[1]+"-"+t[2]},hideTile:function(t,e){var i=!1,n=t.img;s(n)&&(t.loaded&&(this.imgNumber--,i=!0),n.parentNode&&(o(n),n.parentNode.removeChild(n)));var a=new aw("onimagechange");a.tile=this.getTileName(t.info,e),a.action="hide",delete this.mapTiles[t.name],i||(n.parentNode&&(o(n),n.parentNode.removeChild(n)),n=null,t.img=null,t.mgr=null,t=null),this.map.dispatchEvent(a)},loadTiles:function(){var t=this;if(l.Browser.ie)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(t){}this.zoomsDiv&&"none"!=this.zoomsDiv.style.display&&(this.zoomsDiv.style.display="none"),t.moveGridTiles(!0),t.map.loaded=!0},getCell:function(t,e){var i=this.baseUnits*Math.pow(2,this.maxZoomLevel-e),n=parseInt(t.lng/i),o=parseInt(t.lat/i);return[n,o,i*(n+.5),i*(o+.5)]},moveGridTiles:function(t){for(var e=this.tileLayers.length,i=0;i<e;i++){var n=this.tileLayers[i];(n.baseLayer||1==e)&&(this.tilesDiv=n.tilesDiv,n.baseLayer=!0);var o=aJ[n.mapType],s=this.map,a=s.zoomLevel,r=s.centerPoint;this.mapCenterPoint=r;var l=s.getZoomUnits(s.zoomLevel),h=o.baseUnits*Math.pow(2,o.zoomLevelMax-a),c=parseInt(r.lng/h);r.lng<0&&(c-=1);var u=parseInt(r.lat/h);r.lat<0&&(u-=1);var p=o.tileSize,d=[c,u,(r.lng-c*h)/h*p,(r.lat-u*h)/h*p],_=d[0]-Math.ceil((s.width/2-d[2])/p),g=d[1]-Math.ceil((s.height/2-d[3])/p),m=d[0]+Math.ceil((s.width/2+d[2])/p),y=0;n.mapType==BMAP_PERSPECTIVE_MAP&&15==s.getZoom()&&(y=1);var v=d[1]+Math.ceil((s.height/2+d[3])/p)+y;t&&(this.areaCenter=new f(r.lng,r.lat));var T=this.mapTiles,w=-this.areaCenter.lng/l,P=this.areaCenter.lat/l,M=[Math.round(w),Math.round(P)];for(var E in T){var x=T[E],b=x.info;b&&(b[2]==s.zoomLevel&&(_>b[0]||m<=b[0]||g>b[1]||v<=b[1])?this.hideTile(x,n):b[2]!=s.zoomLevel?this.hideTile(x,n):b[2]==s.lastLevel&&this.showTile(b,[M[0]*Math.pow(2,s.zoomLevel-s.lastLevel),M[1]*Math.pow(2,s.zoomLevel-s.lastLevel)],t,n))}var C=-s.offsetX+s.width/2,L=-s.offsetY+s.height/2;n.tilesDiv.style.left=Math.round(w+C)-M[0]+"px",n.tilesDiv.style.top=Math.round(P+L)-M[1]+"px";var R=[];this.imgTotalNumber=0;for(I=_;I<m;I++)for(var A=g;A<v;A++)R.push([I,A]),this.imgTotalNumber++;R.sort(function(t){return function(e,i){return Math.abs(e[0]-t[0]+e[1]-t[1])-Math.abs(i[0]-t[0]+i[1]-t[1])}}([d[0],d[1]])),s.temp._beginLoadTile||(s.temp._beginLoadTile=(new Date).getTime());for(var I=0,S=R.length;I<S;I++)this.showTile([R[I][0],R[I][1],s.zoomLevel],M,t,n)}},dragStart:function(t){this.temp.pps={x:this.map.offsetX,y:this.map.offsetY}},dragEnd:function(t){this.temp.ppe={x:this.map.offsetX,y:this.map.offsetY},(l.Platform.iphone||l.Platform.ipad||l.Platform.android)&&this.zoomsDiv&&"none"!=this.zoomsDiv.style.display&&(this.zoomsDiv.style.display="none")},click:function(t){if(this.map.config.enableClickPan){var e=this.temp;(0==this.map.currentOperation&&!e.ppe&&!e.pps||e.ppe&&e.pps&&e.ppe.x-e.pps.x==0&&e.ppe.y-e.pps.y==0)&&this.map.panBy(this.map.width/2-t.offsetX,this.map.height/2-t.offsetY),e.pps=null,e.ppe=null}},mouseWheel:function(t){var e=this.map;if(e.config.enableWheelZoom){var i=e.zoomLevel+(1==t.trend?1:-1),n=e._getProperZoom(i);if(!n.exceeded){e.dispatchEvent(new aw("onzoomstart")),e.lastLevel=e.zoomLevel,e.zoomLevel=n.zoom;var o=t.pixel,s=e.pixelToPoint(o,e.lastLevel,!0),a=e.getZoomUnits(e.zoomLevel);e.centerPoint=new f(s.lng+a*(e.width/2-o.x),s.lat-a*(e.height/2-o.y)),this.zoom(o)}}},dblClick:function(t){var e=this.map;if(e.config.enableDblclickZoom){var i=t.pixel,n=e.pixelToPoint(i,null,!0),o=1,s=i,a=new X(0,0);"onrightdblclick"==t.type&&(o=-1,s=new aK(e.width/2,e.height/2));var r=e.zoomLevel+o,l=e._getProperZoom(r);if(l.exceeded){if(1==o){var h=e.pixelToPoint(i,null);e.panTo(h)}}else{if(e.dispatchEvent(new aw("onzoomstart")),e.lastLevel=e.zoomLevel,e.zoomLevel=l.zoom,1==o){e.centerPoint=new f(n.lng,n.lat);var c=e.getZoomUnits(e.lastLevel)/e.getZoomUnits(l.zoom)*.5;a.width=i.x-Math.round(e.width/2)*c,a.height=i.y-Math.round(e.height/2)*c}this.zoom(s,a)}}},keypress:function(t){var e=this.map;if(e.config.enableContinuousZoom){if(!this._zTimeLine){var i=e.zoomLevel+("onpluspress"==t.type?1:-1),n=e._getProperZoom(i);if(!n.exceeded){e.dispatchEvent(new aw("onzoomstart"));var o=new aK(e.width/2,e.height/2);if(e.lastLevel=e.zoomLevel,e.zoomLevel=n.zoom,e.getInfoWindow()){o=e.pointToPixel(e.getInfoWindow().getPoint(),e.lastLevel);var s=e.pixelToPoint(o,e.lastLevel,!0),a=e.getZoomUnits(e.zoomLevel);e.centerPoint=new f(s.lng+a*(e.width/2-o.x),s.lat-a*(e.height/2-o.y))}this.zoom(o)}}}else"onpluspress"==t.type?e.zoomIn():e.zoomOut()}}),F.inherits(E,"TileLayer"),l.extend(F.prototype,{isTransparentPng:function(){return this.transparentPng},getTilesUrl:function(t,e){var i=aJ[this.mapType];if("object"!=typeof i)return null;i.baseUnits,Math.pow(2,i.zoomLevelMax-e);var n=t.x,o=t.y,s=(Math.floor(n/200),Math.floor(o/200),"");if(this.opts.tileUrlTemplate)s=(s=(s=(s=this.opts.tileUrlTemplate).replace(/\{X\}/,n)).replace(/\{Y\}/,o)).replace(/\{Z\}/,e);else if(this.mapType==BMAP_NORMAL_MAP&&(s=(s=i.tileUrls[Math.abs(n+o)%i.tileUrls.length]+"?qt=tile&x="+n+"&y="+o+"&z="+e+"&styles=pl&udt=20140928").replace(/-(\d+)/gi,"M$1")),this.mapType==BMAP_PERSPECTIVE_MAP){var a=Math.pow(2,i.zoomLevelMax-e)*i.baseUnits;o=Math.round((9998336-a*o)/a)-1,s=i.tileUrls[Math.abs(n+o)%i.tileUrls.length]+this.map.currentCity+"/"+this.map.cityCode+"/3/lv"+(21-e)+"/"+n+","+o+"."+(i.imgExtend||"jpg")}return s},initialize:function(t){t.temp.layerZIndex||(t.temp.layerZIndex=0),this.zIndex=this.zIndex||0,this.baseLayer&&(this.zIndex=-1),t.temp.layid||(t.temp.layid=0),this.opts.mapType?this.mapType=this.opts.mapType:(this.mapType="BMAP_CUSTOM_LAYER_"+t.temp.layid,t.temp.layid++),aJ[this.mapType]||(aJ[this.mapType]={tileUrls:[],tileSize:256,baseUnits:256,zoomLevelMin:1,zoomLevelMax:18,errorUrl:aQ.imgPath+"/blank.gif",bounds:new y(-21364736,-10616832,23855104,15859712),imgExtend:"png"});var e=Z(t.platform,'<div style="position:absolute;z-index:'+this.zIndex+'"></div>');e.style.display="",e.style.left=Math.ceil(-t.offsetX+t.width/2)+"px",e.style.top=Math.ceil(-t.offsetY+t.height/2)+"px",this.tilesDiv=e,this.map=t},remove:function(){this.tilesDiv&&this.tilesDiv.parentNode&&(this.tilesDiv.innerHTML="",this.tilesDiv.parentNode.removeChild(this.tilesDiv)),delete this.tilesDiv},getCopyright:function(){return this.copyright},getMapType:function(){return this.mapType},setZIndex:function(t){this.zIndex=t,this.tilesDiv&&(this.tilesDiv.style.zIndex=t)}}),af.inherits(E,"Copyright"),aH.prototype=new F,aH.prototype.initialize=function(t){F.prototype.initialize.call(this,t),this._map=t},aH.prototype.isTransparentPng=function(){return this._opts.transparentPng},aH.prototype.getTilesUrl=function(t,e){var i="";i=this._opts.predictDate?"HistoryService?day="+(this._opts.predictDate.weekday-1)+"&hour="+this._opts.predictDate.hour+"&t="+(new Date).getTime()+"&":"TrafficTileService?time="+(new Date).getTime()+"&";this._map;var n=t.x,o=t.y;Math.floor(n/200),Math.floor(o/200);return(this._tileUrl+i+"level="+e+"&x="+n+"&y="+o).replace(/-(\d+)/gi,"M$1")},ao.inherits(E,"ToolbarItem"),l.extend(ao.prototype,{open:function(){return 1==this._isOpen||!this._map._toolInUse&&(this._map._toolInUse=!0,this._isOpen=!0,!0)},close:function(){this._isOpen&&(this._map._toolInUse=!1,this._isOpen=!1)},_checkStr:function(t){return t?t.replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}}),ak.inherits(ao,"PushpinTool"),l.extend(ak.prototype,{setIcon:function(t){!t||t&&"Icon"!=t.toString()||(this._opts.icon=t)},getIcon:function(){return this._opts.icon},setCursor:function(t){this._opts.cursor=t},getCursor:function(){return this._opts.cursor},clear:function(){for(var t=0,e=this._overlays.length;t<e;t++)this._overlays[t].remove&&(this._overlays[t].remove(),this._overlays[t].dispose());this._overlays.length=0},toString:function(){return"PushPinTool"}}),S.inherits(ao,"PolylineTItem"),l.extend(S.prototype,{setLineColor:function(t){this._opts.lineColor=t},setLineStroke:function(t){Math.round(t)>0&&(this._opts.lineStroke=Math.round(t))},setOpacity:function(t){t>=0&&t<=1&&(this._opts.opacity=t)},setLineStyle:function(t){"solid"!=t&&"dashed"!=t||(this._opts.lineStyle=t)},clear:function(){for(var t=0,e=this._overlays.length;t<e;t++)this._overlays[t]&&this._map.removeOverlay(this._overlays[t]);this._overlays.length=0;for(var t=0,e=this._dots.length;t<e;t++)this._dots[t]&&this._dots[t].parentNode&&this._dots[t].parentNode.removeChild(this._dots[t]);this._dots.length=0},setCursor:function(t){1==this._opts.showResult||(this._opts.cursor=t)},getCursor:function(){if(1==this._opts.showResult)return this._dCursor;var t=this._opts.cursor.match(/^url\((.+)\)(,.*)?/);return null!=t?t[1]:this._opts.cursor},showResult:function(t){this._opts.showResult=!!t},toString:function(){return"DistanceTool"}}),window.BMAP_ZOOM_IN=0,window.BMAP_ZOOM_OUT=1,n.inherits(ao,"DragAndZoomTool"),l.extend(n.prototype,{setStrokeColor:function(t){"string"==typeof t&&(this._opts.strokeColor=t)},setLineStroke:function(t){"number"==typeof t&&Math.round(t)>0&&(this._opts.strokeWeight=Math.round(t))},setLineStyle:function(t){"solid"!=t&&"dashed"!=t||(this._opts.style=t)},setOpacity:function(t){"number"==typeof t&&t>=0&&t<=1&&(this._opts.opacity=t)},setLineStyle:function(t){"solid"!=t&&"dashed"!=t||(this._opts.style=t)},setFillColor:function(t){this._opts.fillColor=t},setCursor:function(t){this._opts.cursor=t},getCursor:function(){return this._opts.cursor},toString:function(){return"DragAndZoomTool"}}),BMap.register(function(t){if(!t.config.isOverviewMap){var e=new ad;t.container.insertAdjacentHTML("beforeEnd",e.render(t.config.defaultCursor)),e._container=t.container.lastChild,t.temp.zoomer=e}}),ad.prototype.render=function(t){var e=['<div id=zoomer style="position:absolute;z-index:0;top:0px;left:0px;overflow:hidden;visibility:hidden;cursor:'+t+'">'];return e.push('<div class="BMap_zoomer" style="top:0;left:0;"></div>'),e.push('<div class="BMap_zoomer" style="top:0;right:0;"></div>'),e.push('<div class="BMap_zoomer" style="bottom:0;left:0;"></div>'),e.push('<div class="BMap_zoomer" style="bottom:0;right:0;"></div>'),e.push("</div>"),e.join("")},ad.prototype.action=function(t,e){if(!ad._timeline){var i=this._container;if(i){var n=e,o=Math.ceil((n?60:120)/2),s=Math.max(15,o/(4/3)),a=i.style;a.width=2*o+"px",a.height=2*s+"px",a.visibility="visible";var r=i.children;n?(r[0].style.backgroundPosition="0 0",r[1].style.backgroundPosition="-7px 0",r[2].style.backgroundPosition="0 -7px",r[3].style.backgroundPosition="-7px -7px"):(r[0].style.backgroundPosition="-7px -7px",r[1].style.backgroundPosition="0 -7px",r[2].style.backgroundPosition="-7px 0",r[3].style.backgroundPosition="0 0"),r=null;var l=t.x-o,h=t.y-s;if(!isNaN(l)&&!isNaN(h)){a.left=l+"px",a.top=h+"px";var c=Math.ceil((n?120:60)/2),u=Math.max(15,c/(4/3));c-=o,u=Math.ceil(u-s);var p=this._container.style;ad._timeline&&ad._timeline.end(),ad._timeline=new aG({fps:20,duration:240,transition:k.easeInQuad,delay:100,render:function(t){if(!(t<.1)){var e=Math.ceil(c*t),i=Math.ceil(u*t);p.width=2*(o+e)+"px",p.height=2*(s+i)+"px",p.left=l-e+"px",p.top=h-i+"px"}},finish:function(){ad._timeline=!1,setTimeout(function(){a.visibility="hidden"},300)}})}}}},BMap.Map=C,BMap.MapType=aJ,BMap.Point=f,BMap.Pixel=aK,BMap.Size=X,BMap.Bounds=y,BMap.Area=x,BMap.TileLayer=F,BMap.Copyright=af,BMap.CoordTrans=m,BMap.Projection=V,BMap.Overlay=O,BMap.Label=q,BMap.Marker=J,BMap.Icon=w,BMap.Polyline=ai,BMap.Polygon=c,BMap.Rectangle=G,BMap.InfoWindow=ay,BMap.Circle=Y,BMap.Control=P,BMap.NavigationControl=H,BMap.OverviewMapControl=ah,BMap.CopyrightControl=K,BMap.ScaleControl=T,BMap.MapTypeControl=ae,BMap.PushpinTool=ak,BMap.DistanceTool=S,BMap.DragAndZoomTool=n,BMap.TrafficLayer=aH,BMap.ContextMenu=g,BMap.MenuItem=L,BMap.OperationMask=ap,BMap.register(function(t){t.config&&t.config.isOverviewMap||t.addEventListener("load",function(){if(!t.temp.copyadded){t.temp.copyadded=!0;var e=new K({offset:new X(81,2),printable:!0}),i="&copy; 2015 Baidu";t.getMapType()==BMAP_PERSPECTIVE_MAP&&(i='<span style="color:#fff">&copy; 2013 Baidu - Data &copy; </span><a href="https://o.cn" target="_blank" style="color:#fff">都市圈</a>'),e.addCopyright({content:i,id:1}),t.addEventListener("maptypechange",function(){var i=t.getMapType();i==BMAP_PERSPECTIVE_MAP&&e.addCopyright({id:1,content:'<span style="color:#fff;text-shadow:0 1px 3px black">&copy; 2013 Baidu - Data &copy; </span><a href="https://o.cn" target="_blank" style="color:#fff;text-shadow:0 1px 3px black">都市圈</a>'}),i==BMAP_NORMAL_MAP&&e.addCopyright({id:1,content:"&copy; 2013 Baidu"})}),t.addControl(e);var n=new I;n._opts={printable:!0},t.addControl(n),t.addEventListener("resize",function(){this.getSize().width>=220&&t.getSize().height>=100?(n.show(),e.setOffset(new X(81,2))):(n.hide(),e.setOffset(new X(4,2)))}),t.getSize().width>=220&&t.getSize().height>=100?n.show():(n.hide(),e.setOffset(new X(4,2)))}})}),I.prototype=new P,I.prototype.initialize=function(e){this._map=e;var i=t("div");i.style.height="32px";var n=t("a",{title:"到百度地图首页",target:"_blank",href:"https://map.baidu.com/?sr=1"});return n.style.outline="none",6==l.Browser.ie?n.innerHTML="<div style='cursor:pointer;width:77px;height:32px;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+this.IMG_URL+")'></div>":n.innerHTML="<img style='border:none;width:77px;height:32px' src='"+this.IMG_URL+"' />",this._useSmallImage&&(i.style.height="25px",n.href="#",n.innerHTML="<img style='border:none;width:68px;height:25px' src='"+this.IMG_URL+"' />"),i.appendChild(n),e.getContainer().appendChild(i),n=null,i},window.BMap.apiLoad()}(),function(){function addSearchPoi(t,e,i,n,o){var s=getPoiPoint(e,t.config.coordType,o);if(s&&!(i<0||i>9)){var a=new BMap.Icon(API_URL+"img/markers.png",RED_ICON_SIZE,{offset:RED_ICON_OFFSET,imageOffset:new BMap.Size(0,-25*i),infoWindowOffset:RED_ICON_INFOWND_OFFSET}),r=new BMap.Marker(s,{icon:a});return t.addOverlay(r),n&&r.setTitle(n),r}}function addCenterPoi(t,e,i,n){var o=getPoiPoint(e,t.config.coordType,n);if(o){var s=new BMap.Icon(API_URL+"img/markers.png",RED_ICON_SIZE,{offset:RED_ICON_OFFSET,imageOffset:new BMap.Size(0,-250),infoWindowOffset:RED_ICON_INFOWND_OFFSET}),a=new BMap.Marker(o,{icon:s});return t.addOverlay(a),i&&a.setTitle(i),a}}function addSearchInBoundsPoi(t,e,i,n){var o=getPoiPoint(e,t.config.coordType,n);if(o){var s=new BMap.Icon(API_URL+"img/markers.png",RED_ICON_SIZE,{offset:RED_ICON_OFFSET,imageOffset:new BMap.Size(0,-300),infoWindowOffset:RED_ICON_INFOWND_OFFSET}),a=new BMap.Marker(o,{icon:s});return t.addOverlay(a),i&&a.setTitle(i),a}}function getPoiPoint(t,e,i){var n=[],o=null;if(t&&"Point"==t.toString())o=t;else{if("string"==typeof t){if((n=baidu.trim(t).split(",")).length<2)return;n[0]=parseFloat(baidu.trim(n[0])),n[1]=parseFloat(baidu.trim(n[1]))}else if((n=t.slice(0)).length<2)return;o=new BMap.Point(n[0],n[1])}return o=convertCoord(o,i,e)}function createSearchInfoWnd(t,e){var i=t.title,n=t.addr,o=t.tel,s=(t.uid,t.url,t.poiType||BMAP_POI_TYPE_NORMAL);if(e=e||{},!i)return null;var a=i;s==BMAP_POI_TYPE_BUSSTOP?a+="-公交车站":s==BMAP_POI_TYPE_SUBSTOP&&(a+="-地铁站"),a.replace(/[\u0100-\uffff]/g,"##").length>27&&(a=a.substring(0,13)+"&#8230");var r="<p style='width:210px;font-family:arial,simsun,sans-serif;line-height:16px;margin:0;font-size:14px;color:#cc5522;font-weight:bold;white-space:nowrap;overflow:hidden' title='"+i+"'>"+a+"</p>",l=[];if(l.push("<div style='font:12px arial,sans-serif;margin-top:10px'>"),n){var h="地址：";s!=BMAP_POI_TYPE_BUSSTOP&&s!=BMAP_POI_TYPE_SUBSTOP||(h="车次："),l.push('<table cellspacing="0" style="table-layout:fixed;width:100%;font:12px arial,simsun,sans-serif" >'),l.push('<tr><td style="vertical-align:top;width:38px;white-space:nowrap;word-break:keep-all">'+h+'&nbsp;</td><td style="line-height:16px">'),l.push(n+"&nbsp;</td></tr>"),o&&l.push("<tr><td>电话：</td><td>"+o+"</td></tr>"),l.push("</table>")}else o&&(l.push('<table cellspacing="0" style="table-layout:fixed;width:100%;font:12px arial,simsun,sans-serif">'),l.push('<tr><td style="vertical-align:top;width:36px;white-space:nowrap;word-break:keep-all">电话：</td><td>'+o+"</td></tr></table>"));return l.push("</div>"),new BMap.InfoWindow(l.join(""),{title:r,height:0,width:230,margin:[10,10,20,10]})}function addDestPoi(t,e,i,n,o){var s=getPoiPoint(e,t.config.coordType,o);if(s){var a=new BMap.Icon(API_URL+"img/dest_markers.png",new BMap.Size(42,34),{offset:new BMap.Size(14,32),imageOffset:new BMap.Size(0,-34*n),infoWindowOffset:new BMap.Size(14,0)}),r=new BMap.Marker(s,{icon:a,baseZIndex:35e5});return t.addOverlay(r),i&&r.setTitle(i),r}}function addLine(t,e,i){return addRoute(t,e,ROUTE_TYPE_TRANSIT,i)}function addRoute(t,e,i,n){var o=[{stroke:6,color:"#0030ff",opacity:.45,style:"solid"},{stroke:6,color:"#0030ff",opacity:.45,style:"solid"},{stroke:4,color:"#30a208",opacity:.55,style:"dashed"},{stroke:5,color:"#0030ff",opacity:.45,style:"solid"}];if(void 0===i&&(i=0),o[i]){var s=[],a=o[i];if(t.config.coordType!=n)for(var r=0,l=e.length;r<l;r++)s.push(convertCoord(e[r],n,t.config.coordType));else s=e;var h=new BMap.Polyline(s,{strokeWeight:a.stroke,strokeColor:a.color,strokeOpacity:a.opacity,strokeStyle:a.style,clickable:!1});if(t.addOverlay(h),h._routeType=i,i==ROUTE_TYPE_TRANSIT){var c=new BMap.Polyline(s,{strokeWeight:a.stroke-2,strokeColor:"#fff",strokeOpacity:.3,clickable:!1});h._p=c,t.addOverlay(c)}return h}}function createTransInfoWnd(t){var e=t.content,i=t.curIndex,n=t.total,o=t.nextTransCbk,s=t.obj,a=(t.type,["<div style='font:12px arial,simsun,sans-serif'>"]);e&&a.push("<div style='margin:0 1em 24px 0'>"+e+"</div>"),a.push('<table width="99%" cols="2" style="background:#eaf2ff;font:12px arial,simsun,sans-serif"><tbody><tr>'),a.push('<td nowrap="nowrap" width="50%" align="left">'),0==i?a.push('<span unselectable="on" style="color:#9c9d99;-moz-user-select:none" >上一步</span>'):a.push('<a id="trans_prev" style="color:#7777cc;-moz-user-select:none" href="javascript:void(0)">上一步</a>'),a.push("</td>"),a.push('<td nowrap="nowrap" width="50%" align="right">'),i==n+1?a.push('<span unselectable="on" style="color:#9c9d99;-moz-user-select:none" >下一步</span>'):a.push('<a style="color:#7777cc" id="trans_next" href="javascript:void(0)">下一步</a>'),a.push("</td></tr></tbody></table>");var r=new BMap.InfoWindow(a.join(""),{title:"",height:0,width:220,margin:[10,10,20,10]});return r.addEventListener("open",function(){baidu.G("trans_prev")&&baidu.on(baidu.G("trans_prev"),"click",function(){o&&"function"==typeof o&&o(i-1,s)}),baidu.G("trans_next")&&baidu.on(baidu.G("trans_next"),"click",function(){o&&"function"==typeof o&&o(i+1,s)})}),r}function addTransPoi(t,e,i,n,o){var s=getPoiPoint(e,t.config.coordType,o);if(s){var a=-55;(i=i||BMAP_LINE_TYPE_BUS)==BMAP_LINE_TYPE_SUBWAY&&(a=-76);var r=new BMap.Icon(API_URL+"img/trans_icons.png",new BMap.Size(21,21),{imageOffset:new BMap.Size(0,a),infoWindowOffset:new BMap.Size(10,0)}),l=new BMap.Marker(s,{icon:r});return t.addOverlay(l),n&&l.setTitle(n),l}}function getInfoWindowDom(t){return t&&t.infoWindowDoms&&t.infoWindowDoms.contentDiv?t.infoWindowDoms.contentDiv.childNodes[0]:null}function BaseSearch(t,e){baidu.lang.Class.call(this),this._loc={},this.setLocation(t),this._opts={coordType:BMAP_COORD_LNGLAT,renderOptions:{panel:null,map:null,autoViewport:!0},onSearchComplete:function(){},onMarkersSet:function(){},onInfoHtmlSet:function(){},onResultsHtmlSet:function(){}},baidu.extend(this._opts,e),this._opts.renderOptions.autoViewport=!!this._opts.renderOptions.autoViewport,this._opts.renderOptions.panel=baidu.G(this._opts.renderOptions.panel),this._setCoordType(this._opts.coordType)}function LocalResult(t){this.keyword=t.keyword||"",this._pageIndex=t.pageIdx||0,this._currentNumPois=t.count||0,this._numPois=t.total||0,this._numPages=Math.ceil(t.total/t.pc),this.center=t.center,this.radius=t.radius,this.bounds=t.bounds,this.city=t.city,this.viewport=t.viewport,this.moreResultsUrl=t.moreUrl,this._pois=t.pois&&t.pois.slice(0)||[],this._cityList=t.cityList&&t.cityList.slice(0)}function Route(t){this._steps=t.steps&&t.steps.slice(0)||[],this._distance=t.distance||0,this._index=t.index||0,this._points=t.points.slice(0),this._planIndex=t.planIndex||0,this._rt=t.rt,0===this._distance&&this._points.length>2&&(this._points.length=2)}function RoutePlan(t){this._routes=t.routes.slice(0),this._distance=t.distance||0,this._duration=t.duration||0}function TransitRoute(t,e){BaseRoute.call(this,t,e),e=e||{},this.setPolicy(e.policy),this.setPageCapacity(e.pageCapacity),this.QUERY_TYPE=QUERY_TYPE_TRANSIT,this.RETURN_TYPE=RETURN_TYPE_TRANSIT,this.ROUTE_TYPE=ROUTE_TYPE_TRANSIT,this._overlays=[],this._curIndex=-1}function TransitRoutePlan(t){RoutePlan.call(this,t),this._lines=t.lines,this._description=t.description,this._duration=t.duration||0}function Step(t){this._point=t.point,this._index=t.index,this._description=t.description,this._distance=t.distance||0,this._routeIndex=t.routeIndex||0,this._planIndex=t.planIndex||0}function DrivingRoute(t,e){DWRoute.call(this,t,e),e=e||{},this.setPolicy(e.policy),this.QUERY_TYPE=QUERY_TYPE_DRIVING,this.RETURN_TYPE=RETURN_TYPE_DRIVING,this.ROUTE_TYPE=BMAP_ROUTE_TYPE_DRIVING,this.TRANS_INFO_WND_TYPE=TRANS_INFO_WND_DRIVING}function WalkingRoute(t,e){DWRoute.call(this,t,e),this.QUERY_TYPE=QUERY_TYPE_WALKING,this.RETURN_TYPE=RETURN_TYPE_WALKING,this.ROUTE_TYPE=BMAP_ROUTE_TYPE_WALKING,this.TRANS_INFO_WND_TYPE=TRANS_INFO_WND_WALKING}function Line(t){this.title=t.title,this.uid=t.uid,this.type=t.type,this._stops=t.stops.slice(0),this._points=t.points.slice(0),this._distance=t.distance||0,this._numViaStops=t.numViaStops||0}function Popup(t){baidu.lang.Class.call(this),this.visible=!1,this.config=t,this.config&&(this.config.addDom=this.config.addDom?baidu.G(this.config.addDom):document.body,null!=t.clickClose&&0==t.clickClose?this.config.clickClose=!1:this.config.clickClose=!0,this.connectDom=new Array)}function RouteResult(t){this.city=t.city,this._start=t.start,this._end=t.end,this._plans=t.plans,this.moreResultsUrl=t.url,this.taxiFare=t.taxiFare||null}function DrivingRouteResult(t){RouteResult.call(this,t),this.policy=t.policy}function WalkingRouteResult(t){RouteResult.call(this,t)}function TransitRouteResult(t){RouteResult.call(this,t),this.policy=t.policy}function Geolocation(t){this._opts={coordType:BMAP_COORD_LNGLAT},baidu.extend(this._opts,t)}function scriptRequest(url,echo,id,charset){var isIe=/msie/i.test(window.navigator.userAgent);if(isIe&&baidu.G("_script_"+id))var script=baidu.G("_script_"+id);else{baidu.G("_script_"+id)&&baidu.G("_script_"+id).parentNode.removeChild(baidu.G("_script_"+id));var script=document.createElement("script");null!=charset&&(script.charset=charset),null!=id&&""!=id&&script.setAttribute("id","_script_"+id),script.setAttribute("type","text/javascript"),document.body.appendChild(script)}var t=new Date;url.indexOf("?")>-1?url+="&t="+t.getTime():url+="?t="+t.getTime();var _complete=function(){script.readyState&&"loaded"!=script.readyState&&"complete"!=script.readyState||("function"==typeof echo?echo():eval(echo))};isIe?script.onreadystatechange=_complete:script.onload=_complete,script.setAttribute("src",url)}function getBPoints(t){if(t&&0!=t.length){for(var e=[],i=0;i<t.length;i++)if(t[i])for(var n=t[i].split(";"),o=0;o<n.length;o++){var s=getPointByStr(n[o]);e.push(s)}return e}}function getPosition(t){for(var e={left:0,top:0};t&&t.offsetParent;)e.left+=t.offsetLeft,e.top+=t.offsetTop,t=t.offsetParent;return e}function LocalCity(t){this._opts={coordType:BMAP_COORD_LNGLAT,renderOptions:{map:null}},baidu.extend(this._opts,t)}function Geocoder(t){this._opts={coordType:BMAP_COORD_LNGLAT},baidu.extend(this._opts,t)}function mg(t,e){window.BMap||(window.BMap={}),window.BMap[t]=e}function jsonToQuery(t,e){var i=[];e=e||function(t){return t};for(var n in t)i.push(n+"="+e(t[n]));return i.join("&")}function create(t,e){var i=document.createElement(t);e=e||{};for(var n in e)if("style"!=(n={for:"htmlFor",class:"cssClass"}[n]||n))if(i.setAttribute)i.setAttribute(n,e[n]);else try{i[n]=e[n]}catch(i){}else i.style.cssText=e[n];return i}function unique(t){for(var e=[],i={},n=0,o=t.length;n<o;n++)i[t[n]]||(i[t[n]]=!0,e.push(t[n]));return e}function getBestLevel(t,e){if(e){var i=Math.min(e.width/1100,e.height/660);t=Math.round(t+Math.log(i)/Math.log(2))}return t<1&&(t=1),t>18&&(t=18),t}function parseGeo(t,e,i){if("string"==typeof t&&t){var n,o,s,a=t.split("|");if(1==a.length)n=decode_geo_diff(t);else if(n=decode_geo_diff(a[2]),o=decode_geo_diff(a[0]),s=decode_geo_diff(a[1]),!e)return n;var r={type:n.geoType};if(e)switch(r.type){case GEO_TYPE_POINT:if(r.point=new BMap.Point(n.geo[0][0],n.geo[0][1]),r.points=[r.point],"number"==typeof i&&i==BMAP_COORD_LNGLAT){var l=BMap.Projection.convertMC2LL(r.point);r.point=l,r.points=[l]}break;case GEO_TYPE_LINE:r.points=[];for(var h=n.geo[0],c=0,u=h.length-1;c<u;c+=2){var p=new BMap.Point(h[c],h[c+1]);"number"==typeof i&&i==BMAP_COORD_LNGLAT&&(p=BMap.Projection.convertMC2LL(p)),r.points.push(p)}o=new BMap.Point(o.geo[0][0],o.geo[0][1]),s=new BMap.Point(s.geo[0][0],s.geo[0][1]),"number"==typeof i&&i==BMAP_COORD_LNGLAT&&(o=BMap.Projection.convertMC2LL(o),s=BMap.Projection.convertMC2LL(s)),r.bounds=new BMap.Bounds(o.lng,o.lat,s.lng,s.lat)}return r}}function decode_geo_diff(t){for(var e=_decode_type(t.charAt(0)),i=t.substr(1),n=0,o=i.length,s=[],a=[];n<o;)if(i.charAt(n)==_EXT_CHARS_[0]){if(o-n<13)return 0;if(_decode_6byte_(i.substr(n,13),s)<0)return 0;n+=13}else if(";"==i.charAt(n))a.push(s.slice(0)),s.length=0,++n;else{if(o-n<8)return 0;if(_decode_4byte_(i.substr(n,8),s)<0)return 0;n+=8}for(var r=0,l=a.length;r<l;r++)for(var h=0,c=a[r].length;h<c;h++)a[r][h]/=100;return{geoType:e,geo:a}}function _decode_type(t){var e=-1;return t==_EXT_CHARS_[1]?e=GEO_TYPE_POINT:t==_EXT_CHARS_[2]?e=GEO_TYPE_LINE:t==_EXT_CHARS_[3]&&(e=GEO_TYPE_AREA),e}function _decode_6byte_(t,e){for(var i=0,n=0,o=0,s=0;s<6;s++){if((o=_char2num_(t.substr(1+s,1)))<0)return-1-s;if(i+=o<<6*s,(o=_char2num_(t.substr(7+s,1)))<0)return-7-s;n+=o<<6*s}return e.push(i),e.push(n),0}function _decode_4byte_(t,e){var i=e.length;if(i<2)return-1;for(var n=0,o=0,s=0,a=0;a<4;a++){if((s=_char2num_(t.substr(a,1)))<0)return-1-a;if(n+=s<<6*a,(s=_char2num_(t.substr(4+a,1)))<0)return-5-a;o+=s<<6*a}return n>_MAX_DELTA_&&(n=_MAX_DELTA_-n),o>_MAX_DELTA_&&(o=_MAX_DELTA_-o),e.push(e[i-2]+n),e.push(e[i-1]+o),0}function _char2num_(t){var e=t.charCodeAt(0);return t>="A"&&t<="Z"?e-"A".charCodeAt(0):t>="a"&&t<="z"?26+e-"a".charCodeAt(0):t>="0"&&t<="9"?52+e-"0".charCodeAt(0):"+"==t?62:"/"==t?63:-1}function formatDistance(t){"string"==typeof t&&(t=parseFloat(t));var e;return"1000米"==(e=!t||t<0?"0米":t<=10?"10米":t<1e3?10*Math.round(t/10)+"米":(t/1e3).toFixed(1)+"公里")&&(e="1.0公里"),e}function formatTime(t,e){if(!t||isNaN(t))return"";var i="",n=Math.ceil(t/60);if("bustime"==e){var o=n%10,s=parseInt(n/10);n=0!=o?o>5?10*++s:s?10*s:5:n}var a=parseInt(n/1440);n%=1440;var r=parseInt(n/60);if(n%=60,a>=1&&(i+=a+"天"),r>=1&&(i+=r+"小时"),n>=1){if(e&&"nav"==e&&a>=1)return i;i+=n+"分钟"}return i}function convertCoord(t,e,i){var n=t;switch(e){case BMAP_COORD_MERCATOR:switch(i){case BMAP_COORD_LNGLAT:n=BMap.Projection.convertMC2LL(t)}break;case BMAP_COORD_LNGLAT:switch(i){case BMAP_COORD_MERCATOR:n=BMap.Projection.convertLL2MC(t)}}return n}function getPointsByBounds(t,e,i){var n=new BMap.Point(t.minX,t.minY),o=new BMap.Point(t.maxX,t.maxY);return void 0!==e&&void 0!==i&&(n=convertCoord(n,e,i),o=convertCoord(o,e,i)),[n,o]}function parseGeoStr(t,e){var i=t.split(",");return convertCoord(new BMap.Point(i[0],i[1]),BMAP_COORD_MERCATOR,e)}function Page(t,e,i){if(baidu.lang.Class.call(this),t){this.container="object"==typeof t?t:baidu.G(t),this.page=1,this.pageCount=100,this.argName="pg",this.pagecap=4,this.callback=e,this.update=!0;i||(i={page:1,totalCount:100,pageCount:100,pagecap:4,argName:"pg",update:!0});for(var n in i)void 0!==i[n]&&(this[n]=i[n]);this.render()}}function Boundary(t){this._opts={coordType:BMAP_COORD_LNGLAT},baidu.extend(this._opts,t)}var baidu=baidu||{version:"1-1-0"};baidu.event=baidu.event||{},baidu.event._unload=function(){for(var t,e,i=baidu.event._listeners,n=i.length,o=!!window.removeEventListener;n--;)(e=(t=i[n])[0]).removeEventListener?e.removeEventListener(t[1],t[3],!1):e.detachEvent&&e.detachEvent("on"+t[1],t[3]);o?window.removeEventListener("unload",baidu.event._unload,!1):window.detachEvent("onunload",baidu.event._unload)},window.attachEvent?window.attachEvent("onunload",baidu.event._unload):window.addEventListener("unload",baidu.event._unload,!1),baidu.event._listeners=baidu.event._listeners||[],baidu.event.un=function(t,e,i){"string"==typeof t&&(t=baidu.dom.g(t)),e=e.replace(/^on/i,"");for(var n,o=baidu.event._listeners,s=o.length,a=!i;s--;)(n=o[s])[1]!==e||n[0]!==t||!a&&n[2]!==i||(t.detachEvent?t.detachEvent("on"+e,n[3]):t.removeEventListener&&t.removeEventListener(e,n[3],!1),o.splice(s,1));return t},baidu.un=baidu.event.un,baidu.array=baidu.array||{},baidu.string=baidu.string||{},baidu.string.trim=function(t){return String(t).replace(new RegExp("(^[\\s\\t\\xa0\\u3000]+)|([\\u3000\\xa0\\s\\t]+$)","g"),"")},baidu.trim=baidu.string.trim,baidu.object=baidu.object||{},baidu.object.extend=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},baidu.extend=baidu.object.extend,baidu.event.on=function(t,e,i){e=e.replace(/^on/i,""),"string"==typeof t&&(t=baidu.dom.g(t));var n=function(e){i.call(t,e)},o=baidu.event._listeners;return o[o.length]=[t,e,i,n],t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener&&t.addEventListener(e,n,!1),t},baidu.on=baidu.event.on,baidu.lang=baidu.lang||{},baidu.lang._instances=baidu.lang._instances||{},baidu.lang.instance=function(t){return baidu.lang._instances[t]||null},baidu.lang.inherits=function(t,e,i){var n,o,s=t.prototype,a=new Function;a.prototype=e.prototype,o=t.prototype=new a;for(n in s)o[n]=s[n];t.prototype.constructor=t,t.superClass=e.prototype,"string"==typeof i&&(o._className=i)},baidu.inherits=baidu.lang.inherits,baidu.dom=baidu.dom||{},baidu.dom.g=function(t){return"string"==typeof t||t instanceof String?document.getElementById(t):t&&t.nodeName&&(1==t.nodeType||9==t.nodeType)?t:null},baidu.g=baidu.G=baidu.dom.g,baidu.lang._insCounter=baidu.lang._insCounter||1,baidu.lang.Class=function(t){this.guid=t||baidu.lang.Class.guid(),baidu.lang._instances[this.guid]=this},baidu.lang.Class.guid=function(){return"TANGRAM__"+(baidu.lang._insCounter++).toString(36)},baidu.lang.Class.create=function(t){var e=new baidu.lang.Class;for(var i in t)e[i]=t[i];return e},baidu.lang.Class.prototype.dispose=function(){this.guid&&delete baidu.lang._instances[this.guid];for(var t in this)"function"!=typeof this[t]&&delete this[t]},baidu.lang.Class.prototype.toString=function(){return this._className||"Object"};var CITY_TYPE_PROV=1,CITY_TYPE_CITY=2,CITY_TYPE_DIST=3,RED_ICON_SIZE=new BMap.Size(23,25),RED_ICON_OFFSET=new BMap.Size(9,25),RED_ICON_INFOWND_OFFSET=new BMap.Size(9,0);window.BMAP_POI_TYPE_NORMAL=0,window.BMAP_POI_TYPE_BUSSTOP=1,window.BMAP_POI_TYPE_BUSLINE=2,window.BMAP_POI_TYPE_SUBSTOP=3,window.BMAP_POI_TYPE_SUBLINE=4;var DEST_START=0,DEST_END=1,ROUTE_TYPE_DEFAULT=0,ROUTE_TYPE_TRANSIT=1,TRANS_INFO_WND_TRANSIT=0,TRANS_INFO_WND_DRIVING=1,TRANS_INFO_WND_WALKING=2,DataMgr={RawDispatcher:{},REQ_BASE_URL:"https://api.map.baidu.com/",request:function(t,e,i,n){var o=(1e5*Math.random()).toFixed(0);DataMgr.RawDispatcher["_cbk"+o]=function(e){i=i||{},t&&t(e,i),delete DataMgr.RawDispatcher["_cbk"+o]},n=n||"";var s=jsonToQuery(e,encodeURIComponent),a=this,r=window._key||"",l=create("script",{src:a.REQ_BASE_URL+n+"?"+s+"&key="+r+"&ie=utf-8&oue=1&res=api&callback=BMap.DataMgr.RawDispatcher._cbk"+o});l.addEventListener?l.addEventListener("load",function(){l.parentNode.removeChild(l)},!1):l.attachEvent&&l.attachEvent("onreadystatechange",function(t){var e=window.event.srcElement;e&&"loaded"==e.readyState&&l.parentNode.removeChild(l)}),setTimeout(function(){document.getElementsByTagName("head")[0].appendChild(l)},1)}};mg("DataMgr",DataMgr),baidu.inherits(BaseSearch,baidu.lang.Class),BaseSearch.CBK_SEARCH_COMPLETE=1,BaseSearch.CBK_MARKERS_SET=2,BaseSearch.CBK_INFO_HTML_SET=3,BaseSearch.CBK_POLYLINES_SET=4,BaseSearch.CBK_RESULTS_HTML_SET=5,BaseSearch._getPoiUrl=function(t,e){return t?MAP_URL+"?s="+encodeURIComponent("inf&uid="+t+"&c="+e)+"&i=0&sr=1":""},BaseSearch._getLocType=function(t){return t?"string"==typeof t?LOC_TYPE_STRING:t.constructor==BMap.Point?LOC_TYPE_POINT:t.constructor==BMap.Map?LOC_TYPE_MAP:LOC_TYPE_UNKNOWN:LOC_TYPE_UNKNOWN},baidu.extend(BaseSearch.prototype,{getCoordType:function(){return this._opts.coordType},getResults:function(){return this._results},enableAutoViewport:function(){this._opts.renderOptions.autoViewport=!0},disableAutoViewport:function(){this._opts.renderOptions.autoViewport=!1},setLocation:function(t){t&&(this._loc.src=t)},_getIdByLoc:function(t,e){var i=BaseSearch._getLocType(t.src);if(i!=LOC_TYPE_UNKNOWN){var n=this;if(i==LOC_TYPE_STRING){if(t.curLocType==i&&t.curSrc==t.src&&t.curId)return void(e&&e(t.curId));t.curLocType=i,t.curSrc=t.src,DataMgr.request(function(t){t&&t.result&&t.result.type==RETURN_TYPE_CURRENT_CITY&&(n._loc.curId=t.content.code,e&&e(n._loc.curId))},{qt:QUERY_TYPE_CURRENT_CITY,wd:t.src})}else{var o,s=18;if(i==LOC_TYPE_MAP?(o=t.src.getCenter(),s=t.src.getZoom()):o=t.src,i==t.curLocType&&t.curSrc.equals(o)&&t.curId)return void(e&&e(t.curId));i==LOC_TYPE_MAP&&t.src.config.coordType==BMAP_COORD_LNGLAT&&(o=BMap.Projection.convertLL2MC(o)),i==LOC_TYPE_POINT&&this._opts.coordType==BMAP_COORD_LNGLAT&&(o=BMap.Projection.convertLL2MC(o)),t.curLocType=i,t.curSrc=new BMap.Point(o.lng,o.lat),DataMgr.request(function(t){t&&t.result&&t.result.type==RETURN_TYPE_CENTER&&(n._loc.curId=t.content.uid,e&&e(n._loc.curId))},{qt:QUERY_TYPE_CENTER,b:o.lng+","+o.lat+";"+o.lng+","+o.lat,l:s})}}},setSearchCompleteCallback:function(t){this._opts.onSearchComplete=t||function(){}},setMarkersSetCallback:function(t){this._opts.onMarkersSet=t||function(){}},setInfoHtmlSetCallback:function(t){this._opts.onInfoHtmlSet=t||function(){}},setResultsHtmlSetCallback:function(t){this._opts.onResultsHtmlSet=t||function(){}},getStatus:function(){return this._status},_setStatus:function(t){"number"==typeof t?this._status=t:delete this._status},_setCoordType:function(t){t===BMAP_COORD_LNGLAT||t===BMAP_COORD_MERCATOR?this._opts.coordType=t:this._opts.coordType=BMAP_COORD_LNGLAT},_triggerCbk:function(t,e,i){var n;switch(t){case BaseSearch.CBK_SEARCH_COMPLETE:n=this._opts.onSearchComplete;break;case BaseSearch.CBK_MARKERS_SET:n=this._opts.onMarkersSet;break;case BaseSearch.CBK_POLYLINES_SET:n=this._opts.onPolylinesSet;break;case BaseSearch.CBK_INFO_HTML_SET:n=this._opts.onInfoHtmlSet;break;case BaseSearch.CBK_RESULTS_HTML_SET:n=this._opts.onResultsHtmlSet}n&&n(e,i)}});var LocalSearch=function(t,e){BaseSearch.call(this,t,e),(e=e||{}).renderOptions=e.renderOptions||{},this.setPageCapacity(e.pageCapacity),void 0===e.renderOptions.selectFirstResult||e.renderOptions.selectFirstResult?this.enableFirstResultSelection():this.disableFirstResultSelection(),this._overlays=[],this._curIndex=-1};baidu.inherits(LocalSearch,BaseSearch,"LocalSearch"),LocalSearch.DEFAULT_PAGE_CAPACITY=10,LocalSearch.MIN_PAGE_CAPACITY=1,LocalSearch.MAX_PAGE_CAPACITY=50,LocalSearch.DEFAULT_RADIUS=2e3,LocalSearch.MAX_RADIUS=5e3,LocalSearch.isReqDataMap=function(t,e){return!(!t||void 0===e)&&((t!=QUERY_TYPE_POI_SEARCH||e==RETURN_TYPE_POI_SEARCH||e==RETURN_TYPE_CITY_LIST||e==RETURN_TYPE_CURRENT_CITY||e==RETURN_TYPE_SPECIAL_REGION||e==RETURN_TYPE_NODATA_REGION)&&((t!=QUERY_TYPE_SEARCH_NEARBY||e==RETURN_TYPE_SEARCH_NEARBY)&&(t!=QUERY_TYPE_SEARCH_INBOUNDS||e==RETURN_TYPE_SEARCH_INBOUNDS)))},baidu.extend(LocalSearch.prototype,{search:function(t){if(!t)return this.clearResults(),this._setStatus(BMAP_STATUS_INVALID_REQUEST),void this._triggerCbk(BaseSearch.CBK_SEARCH_COMPLETE);var e=arguments[1]||{},i=this;this._getIdByLoc(this._loc,function(n){var o={qt:QUERY_TYPE_POI_SEARCH,c:n=n||1,wd:t,rn:i.getPageCapacity(QUERY_TYPE_POI_SEARCH)};baidu.extend(o,e.params);var s={params:o,userKw:e.userKw||t};baidu.extend(s,e),DataMgr.request(function(t,e){i._rawDataCbk(t,e)},o,s)})},searchInBounds:function(t,e){if(!t||!e)return this.clearResults(),this._setStatus(BMAP_STATUS_INVALID_REQUEST),void this._triggerCbk(BaseSearch.CBK_SEARCH_COMPLETE);var i=this,n=arguments[2]||{};this._getIdByLoc(this._loc,function(o){o=o||1;var s=new BMap.Point(e.minX,e.minY),a=new BMap.Point(e.maxX,e.maxY);i._opts.coordType==BMAP_COORD_LNGLAT&&(s=BMap.Projection.convertLL2MC(s),a=BMap.Projection.convertLL2MC(a));var r="("+s.lng+","+s.lat+";"+a.lng+","+a.lat+")",l={qt:QUERY_TYPE_SEARCH_INBOUNDS,c:o,wd:t,ar:r,rn:i._opts.pageCapacity,l:18};baidu.extend(l,n.params);var h;h=n&&n.center&&n.radius?{params:l,bounds:e,center:n.center,radius:n.radius,userKw:n.userKw||t}:{params:l,bounds:e,userKw:n.userKw||t},DataMgr.request(function(t,e){i._rawDataCbk(t,e)},l,h)})},searchNearby:function(t,e,i){if(!(t&&e&&(e instanceof BMap.Point||"object"!=typeof e||e.uid)))return this.clearResults(),this._setStatus(BMAP_STATUS_INVALID_REQUEST),void this._triggerCbk(BaseSearch.CBK_SEARCH_COMPLETE);i=i||LocalSearch.DEFAULT_RADIUS,i=i<1?1:i>LocalSearch.MAX_RADIUS?LocalSearch.MAX_RADIUS:i;var n=this,o=arguments[3]||{};if(e&&e instanceof BMap.Point){var s;s=n._opts.coordType==BMAP_COORD_LNGLAT?BMap.Projection.convertLL2MC(e):e;var a,r,l=new BMap.Point(s.lng-i,s.lat-i),h=new BMap.Point(s.lng+i,s.lat+i);n._opts.coordType==BMAP_COORD_LNGLAT?(a=BMap.Projection.convertMC2LL(l),r=BMap.Projection.convertMC2LL(h)):(a=l,r=h);var c=new BMap.Bounds(a.lng,a.lat,r.lng,r.lat);return o.center=e,o.radius=i,void this.searchInBounds(t,c,o)}this._getIdByLoc(this._loc,function(s){var a={qt:QUERY_TYPE_SEARCH_NEARBY,c:s=s||1,wd:t,rn:n.getPageCapacity(QUERY_TYPE_SEARCH_NEARBY),uid:e.uid,r:i};"string"==typeof e&&(a.qt=QUERY_TYPE_POI_SEARCH,a.wd=e+" "+t,delete a.r,delete a.uid),baidu.extend(a,o.params),DataMgr.request(function(t,e){n._rawDataCbk(t,e)},a,{params:a,center:e,radius:i,userKw:o.userKw||t})})},_rawDataCbk:function(t,e){s=this;this.clearResults(),s._json=t,this._ud=e;var i=t.result,n=e.params.qt;if(0!=i.error||!LocalSearch.isReqDataMap(n,i.type)){var o=t.current_city;return this._results=new LocalResult({keyword:e.userKw,city:o.name,ccode:o.code,pc:s.getPageCapacity(e.params.qt),center:e.center,radius:e.radius,bounds:e.center&&e.radius?void 0:e.bounds,moreUrl:this._getMoreUrl(e,o)}),this._results._qt=e.params.qt,this._setStatus(BMAP_STATUS_UNKNOWN_LOCATION),this._triggerCbk(BaseSearch.CBK_SEARCH_COMPLETE,this._results),void this._renderList()}if(s._processRaw(e),s._renderMap(),s._renderList(),this._opts.renderOptions.selectFirstResult&&this._results&&this._results.getNumPois()>0){var s=this;setTimeout(function(){s._select(0)},240)}},_processRaw:function(t){var e=this._json.result,i=this._json.content,n=this._json.current_city,o=e.type,s=this,a=e.page_num||0,r=0,l=0,h=[],c=[],u=[];if(o!=RETURN_TYPE_CITY_LIST&&o!=RETURN_TYPE_SPECIAL_REGION){l=e.count-(0==a?e.spec_dispnum||0:0),r=e.total<760?e.total:760;var p=0==a?e.spec_dispnum||0:0;if(o!=RETURN_TYPE_CURRENT_CITY){for(m=p;m<e.count;m++)if(i&&i[m]){var d=i[m],_=this._formatAddr(d.addr,d.poiType),f={title:d.name,uid:d.uid,point:parseGeo(d.geo,!0,s._opts.coordType).point,url:BaseSearch._getPoiUrl(d.uid,n.code),address:_,city:n.name,phoneNumber:d.tel,postcode:d.zip,type:d.poiType||BMAP_POI_TYPE_NORMAL};h.push(f),c.push(f.point)}}else{l=r=1;f={title:i.cname,uid:i.uid,point:parseGeo(i.geo,!0,s._opts.coordType).point,address:i.cname,url:MAP_URL+"?s="+encodeURIComponent("s&wd="+e.wd)};h.push(f),c.push(f.point)}}else{if(o==RETURN_TYPE_SPECIAL_REGION){l=r=1;f={title:e.wd,point:parseGeoStr(i[0],s._opts.coordType),url:MAP_URL+"?s="+encodeURIComponent("s&wd="+e.wd)};h.push(f),c.push(f.point)}if(o==RETURN_TYPE_CITY_LIST){l=r=0;for(m=0;m<i.length;m++)u.push({city:i[m].name,_code:i[m].code,numResults:i[m].num});if(this._json.more_city)for(var g=this._json.more_city,m=0,y=g.length;m<y;m++)for(var v=0,T=g[m].city.length;v<T;v++){i=g[m].city[v];u.push({city:i.name,_code:i.code,numResults:i.num})}}}this._results=new LocalResult({keyword:t.userKw,count:l,total:r,pageIdx:e.page_num,city:n.name,ccode:n.code,pois:h,cityList:u,pc:s.getPageCapacity(t.params.qt),center:t.center,radius:t.radius,bounds:t.center&&t.radius?void 0:t.bounds,moreUrl:this._getMoreUrl(t,n)}),this._results._qt=t.params.qt,0==r&&o!=RETURN_TYPE_CITY_LIST?this._setStatus(BMAP_STATUS_UNKNOWN_LOCATION):o!=RETURN_TYPE_CITY_LIST?this._setStatus(BMAP_STATUS_SUCCESS):this._setStatus(BMAP_STATUS_CITY_LIST),this._triggerCbk(BaseSearch.CBK_SEARCH_COMPLETE,this._results)},_getMoreUrl:function(t,e){var i="string"==typeof t.center?t.center+" "+t.userKw:t.userKw,n="s",o="",s="";if("object"==typeof t.center&&!(t.center instanceof BMap.Point)){n="nb";a=t.center.point;this._opts.coordType==BMAP_COORD_LNGLAT&&(a=BMap.Projection.convertLL2MC(a)),o=encodeURIComponent("&uid="+t.center.uid+"&r="+t.radius)+"&l=13&c="+a.lng+","+a.lat}if(t.bounds&&!t.center){n="bd";a=t.bounds.getCenter();this._opts.coordType==BMAP_COORD_LNGLAT&&(a=BMap.Projection.convertLL2MC(a)),s="&c="+a.lng+","+a.lat+"&l=13"}if(t.center&&t.center instanceof BMap.Point){var a=t.center;this._opts.coordType==BMAP_COORD_LNGLAT&&(a=BMap.Projection.convertLL2MC(a)),s="&c="+a.lng+","+a.lat+"&l=13";var r=t.radius;n="tpl:PoiSearch?nb&ar=("+(a.lng-r)+","+(a.lat-r)+";"+(a.lng+r)+","+(a.lat+r)+")"}return MAP_URL+"?sr=1"+s+"&s="+encodeURIComponent(n+"&wd="+i+"&c="+e.code)+o},_formatAddr:function(t,e){return(e=e||BMAP_POI_TYPE_NORMAL)==BMAP_POI_TYPE_BUSSTOP||e==BMAP_POI_TYPE_SUBSTOP?unique(t.split(";")).join("; "):t},_renderMap:function(){if(this._opts.renderOptions.map&&this._results&&this._results.getCurrentNumPois()>0){for(var t=this,e=this._opts.renderOptions.map,i=[],n=0;n<this._results.getCurrentNumPois();n++){var o=this._results.getPoi(n);i.push(o.point);var s=this._addPoi(o.point,n,o.title);s&&(o.marker=s,function(){var e=n;s.addEventListener("click",function(){t._select(e)})}(),this._overlays.push(s))}var a=this._results.center;if(a&&"string"!=typeof a&&!(a instanceof BMap.Point)){var r=this._centerMkr=addCenterPoi(e,a.point,a.title,this._opts.coordType);r.addEventListener("click",function(){t._select(-1),t._curIndex="c";var i=createSearchInfoWnd({title:a.title,addr:a.address,tel:a.phoneNumber,url:a.url,poiType:a.type});i.addEventListener("open",function(){t._triggerCbk(BaseSearch.CBK_INFO_HTML_SET,a,getInfoWindowDom(e))}),r.openInfoWindow(i)})}var l={};switch(this._json.result&&this._json.result.type){case RETURN_TYPE_POI_SEARCH:case RETURN_TYPE_SEARCH_NEARBY:case RETURN_TYPE_SEARCH_INBOUNDS:l.points=i;break;case RETURN_TYPE_CURRENT_CITY:l.center=this._results.getPoi(0).point,l.level=this._json.content.level;break;case RETURN_TYPE_NODATA_REGION:l.center=this._results.getPoi(0).point,l.level=13;break;case RETURN_TYPE_SPECIAL_REGION:l.center=this._results.getPoi(0).point,l.level=parseInt(this._json.content[1])}this._getBestViewport(l),this._triggerCbk(BaseSearch.CBK_MARKERS_SET,this._results._pois)}},_addPoi:function(t,e,i){return this._results.getCurrentNumPois()<=LocalSearch.DEFAULT_PAGE_CAPACITY?addSearchPoi(this._opts.renderOptions.map,t,e,i,this._opts.coordType):addSearchInBoundsPoi(this._opts.renderOptions.map,t,i,this._opts.coordType)},_select:function(t){var e=this._curIndex,i=this._opts.renderOptions.map,n=this._opts.renderOptions.panel;if(i&&t>-1&&this._overlays[t]){var o=this._overlays[t];i.closeInfoWindow();var s=this._results.getPoi(t),a=createSearchInfoWnd({title:s.title,addr:s.address,tel:s.phoneNumber,url:s.url,poiType:s.type}),r=this;a.addEventListener("close",function(){n&&"number"==typeof r._curIndex&&-1!=r._curIndex&&n.getElementsByTagName("li")[r._curIndex]&&(n.getElementsByTagName("li")[r._curIndex].style.backgroundColor=""),r._curIndex=-1}),a.addEventListener("open",function(){r._triggerCbk(BaseSearch.CBK_INFO_HTML_SET,s,getInfoWindowDom(i))}),o.openInfoWindow(a)}n&&("number"==typeof e&&-1!=e&&n.getElementsByTagName("li")[e]&&(n.getElementsByTagName("li")[e].style.backgroundColor=""),"number"==typeof t&&-1!=t&&n.getElementsByTagName("li")[t]&&(n.getElementsByTagName("li")[t].style.backgroundColor="#f0f0f0")),this._curIndex=t},_clearOverlays:function(){for(var t=0,e=this._overlays.length;t<e;t++)this._overlays[t].remove(),this._overlays[t].dispose(),this._overlays[t]=null;this._overlays.length=0,this._centerMkr&&(this._centerMkr.remove(),this._centerMkr.dispose(),this._centerMkr=null)},_renderList:function(){if(this._opts.renderOptions.panel&&this._opts.renderOptions.panel.appendChild&&this._results){var t=create("div",{style:"font-family:arial,sans-serif;border:1px solid #999;font-size:12px"}),e=this.getStatus(),i=create("div",{style:"background:#fff"}),n=create("ol",{style:"list-style:none;padding:0;margin:0"});if(e==BMAP_STATUS_SUCCESS)for(var o=0,s=this._results.getCurrentNumPois();o<s;o++){a=this._createItem(o);n.appendChild(a)}if(e==BMAP_STATUS_CITY_LIST)for(var o=0,s=Math.min(6,this._results.getCityList().length);o<s;o++){var a=this._createCityItem(o);n.appendChild(a)}e==BMAP_STATUS_UNKNOWN_LOCATION&&((a=create("li",{style:"margin:2px 0;padding:0 5px 0 3px;overflow:hidden;line-height:17px"})).innerHTML="抱歉，未找到相关地点。",n.appendChild(a)),i.appendChild(n),t.appendChild(i);var r=this,l=create("div",{style:"white-space:nowrap;text-align:right;background:#e5ecf9;margin-top:5px;padding:2px"}),h=create("a",{style:"color:#7777cc",href:this._results.moreResultsUrl,target:"_blank",title:"到百度地图查看更多结果"});h.innerHTML="更多结果&#187;";var c=create("div",{style:"float:left;margin-right:5px"});if(this._results.getNumPages()>1)new Page(c,function(t){r.gotoPage(t-1)},{pageCount:r._results.getNumPages(),page:r._results.getPageIndex()+1,update:!1});l.appendChild(c),l.appendChild(h),t.appendChild(l),this._opts.renderOptions.panel.appendChild(t),this._triggerCbk(BaseSearch.CBK_RESULTS_HTML_SET,t)}},_createItem:function(t){var e=this._results;if(e&&e.getPoi(t)){var i=e.getPoi(t),n=this._results.keyword,o=create("li",{style:"margin:2px 0;padding:0 5px 0 3px;cursor:pointer;overflow:hidden;line-height:17px"});this._curIndex>-1&&t==this._curIndex&&(o.style.backgroundColor="#f0f0f0");var s=0==t?t+2+"px":"-"+(20*t-2)+"px";this._results.getCurrentNumPois()>LocalSearch.DEFAULT_PAGE_CAPACITY&&(s="-218px");var a=["<span style='background:url("+API_URL+"bmap/red_labels.gif) 0 "+s+" no-repeat;padding-left:10px;margin-right:3px'>&nbsp;</span>"],r=new RegExp(n,"ig"),l=i.title.replace(r,"<b>$&</b>");i.type==BMAP_POI_TYPE_BUSSTOP?l+="-公交车站":i.type==BMAP_POI_TYPE_SUBSTOP&&(l+="-地铁站"),a.push("<span style='color:#00c;text-decoration:underline'>"+l+"</span>"),i.address&&a.push("<span style='color:#666;'> - "+i.address.replace(r,"<b>$&</b>")+"</span>"),o.innerHTML=a.join("");var h=this;return o.onclick=function(){h._select(t)},o}},_createCityItem:function(t){var e=create("li",{style:"margin:2px 0;padding:0 5px 0 3px;cursor:pointer;overflow:hidden;line-height:17px"});e._index=t;var i=this._results.getCityList();e.innerHTML="<span style='color:#00c;text-decoration:underline'>"+i[t].city+"</span> <span style='color:#666'>(共"+i[t].numResults+"条结果)</span>";var n=this;return e.onclick=function(){n.setLocation(n._results.getCityList()[t].city),n.search(n._results.keyword)},e},clearResults:function(){delete this._json,delete this._status,delete this._results,delete this._ud,this._curIndex=-1,this._setStatus(),this._clearOverlays(),this._opts.renderOptions.panel&&(this._opts.renderOptions.panel.innerHTML="")},gotoPage:function(t){if(this._ud)if("number"==typeof t&&!isNaN(t)&&t>=0&&t<=this._results.getNumPages()-1)switch(this._ud.params.pn=t,this._ud.params.qt){case QUERY_TYPE_POI_SEARCH:this.search(this._ud.params.wd,this._ud);break;case QUERY_TYPE_SEARCH_INBOUNDS:this.searchInBounds(this._ud.params.wd,this._ud.bounds,this._ud);break;case QUERY_TYPE_SEARCH_NEARBY:this.searchNearby(this._ud.params.wd,this._ud.center,this._ud.radius,this._ud)}else this._setStatus(BMAP_STATUS_INVALID_REQUEST),this._triggerCbk(BaseSearch.CBK_SEARCH_COMPLETE)},enableFirstResultSelection:function(){this._opts.renderOptions.selectFirstResult=!0},disableFirstResultSelection:function(){this._opts.renderOptions.selectFirstResult=!1},setPageCapacity:function(t){"number"!=typeof t||isNaN(t)?this._opts.pageCapacity=LocalSearch.DEFAULT_PAGE_CAPACITY:this._opts.pageCapacity=t<1?LocalSearch.DEFAULT_PAGE_CAPACITY:t>LocalSearch.MAX_PAGE_CAPACITY?LocalSearch.DEFAULT_PAGE_CAPACITY:t},getPageCapacity:function(){return arguments[0]&&arguments[0]!=QUERY_TYPE_SEARCH_INBOUNDS?this._opts.pageCapacity<=LocalSearch.DEFAULT_PAGE_CAPACITY?this._opts.pageCapacity:LocalSearch.DEFAULT_PAGE_CAPACITY:this._opts.pageCapacity},_getBestViewport:function(t){var e=this._opts.renderOptions,i=e.map;if(i)if(t.points){var n=t.points;if(this._opts.coordType!=i.config.coordType)if(i.config.coordType==BMAP_COORD_MERCATOR)for(o=0;o<n.length;o++)n[o]=BMap.Projection.convertLL2MC(n[o]);else if(i.config.coordType==BMAP_COORD_LNGLAT)for(var o=0;o<n.length;o++)n[o]=BMap.Projection.convertMC2LL(n[o]);var s=!e.autoViewport,a=!e.selectFirstResult&&e.autoViewport,r=i.getViewport(n,{margins:[30,30,30,30]});s||i.setViewport(r,{enableAnimation:a})}else{var l=convertCoord(t.center,this._opts.coordType,i.config.coordType);t.level=getBestLevel(t.level,i),this._opts.renderOptions.autoViewport&&i.centerAndZoom(l,t.level)}},toString:function(){return"LocalSearch"}}),baidu.extend(LocalResult.prototype,{getPoi:function(t){if(this._pois[t])return this._pois[t]},getNumPois:function(){return this._numPois},getNumPages:function(){return this._numPages},getCurrentNumPois:function(){return this._currentNumPois},getPageIndex:function(){return this._pageIndex},getCityList:function(){return this._cityList},toString:function(){return"LocalResult"}});var BaseRoute=function(t,e){BaseSearch.call(this,t,e),e=e||{},this.setPolylinesSetCallback(e.onPolylinesSet)};baidu.inherits(BaseRoute,BaseSearch,"BaseRoute"),BaseRoute._genTitle=function(t,e,i){var n="border-bottom:1px solid #ccc",o="-21px";0===i&&(n+=";border-top:1px solid #ccc",o="5px");var s=["<div style='"+n+"'><div style='cursor:pointer;background:url("];return s.push(API_URL+"img/trans_icons.png) no-repeat 5px "+o+";padding:8px 0 8px 33px;line-height:15px' "),s.push("onclick='"+e+"'><span style='white-space:nowrap'>"),s.push(t),s.push("</span></div></div>"),s.join("")},baidu.extend(BaseRoute.prototype,{search:function(t,e){return!(!t||!e)||(this.clearResults(),this._setStatus(BMAP_STATUS_INVALID_REQUEST),this._triggerCbk(BaseSearch.CBK_SEARCH_COMPLETE),!1)},clearResults:function(){delete this._results,delete this._ud,delete this._json,delete this._boundsPoints,this._setStatus(),this._opts.renderOptions.panel&&(this._opts.renderOptions.panel.innerHTML=""),this._opts.renderOptions.map&&this._opts.renderOptions.map.closeInfoWindow(),this._clearOverlays(),this._curIndex=-1},_formatDestQuery:function(t){var e;if("string"==typeof t)e=[2,"","",t,"",""];else if(t instanceof BMap.Point)e=[1,"",(i=convertCoord(t,this._opts.coordType,BMAP_COORD_MERCATOR)).lng+","+i.lat,"","",""];else{var i=convertCoord(t.point,this._opts.coordType,BMAP_COORD_MERCATOR);e=[1,t.uid,i.lng+","+i.lat,t.title,"",""]}return e.join("$$")},setPolylinesSetCallback:function(t){this._opts.onPolylinesSet=t||function(){}}}),baidu.extend(Route.prototype,{getNumSteps:function(){return this._steps.length},getStep:function(t){if(this._steps[t])return this._steps[t]},getDistance:function(t){return!1===t?this._distance:formatDistance(this._distance)},getIndex:function(){return this._index},getPolyline:function(){return this._polyline},getPoints:function(){return this._points},getRouteType:function(){return this._rt},getPlanIndex:function(){return this._planIndex}}),baidu.extend(RoutePlan.prototype,{getRoute:function(t){if(this._routes[t])return this._routes[t]},getNumRoutes:function(){return this._routes.length},getDistance:function(t){return!1===t?this._distance:formatDistance(this._distance)},getDuration:function(t){return!1===t?this._duration:formatTime(this._duration,"nav")}}),window.BMAP_TRANSIT_POLICY_LEAST_TIME=0,window.BMAP_TRANSIT_POLICY_LEAST_TRANSFER=2,window.BMAP_TRANSIT_POLICY_LEAST_WALKING=3,window.BMAP_LINE_TYPE_BUS=0,window.BMAP_LINE_TYPE_SUBWAY=1,window.BMAP_LINE_TYPE_FERRY=2,TransitRoute.MAX_PAGE_CAPACITY=5,TransitRoute.LINE_TYPE_MAPPING=[0,1,0,0,0,0,0,0,2,0,0,0,1,1,1],baidu.inherits(TransitRoute,BaseRoute,"TransitRoute"),baidu.extend(TransitRoute.prototype,{setPolicy:function(t){t>=BMAP_TRANSIT_POLICY_LEAST_TIME&&t<=BMAP_TRANSIT_POLICY_LEAST_WALKING?this._opts.policy=t:this._opts.policy=BMAP_TRANSIT_POLICY_LEAST_TIME},_internalSearch:function(t,e,i){function n(t){var e=t.split("$$"),i=e[0],n=null;return/^[0-2]$/.test(i)&&e.length>3&&(n=e[parseInt(i)+1]),n}var o=this;this._getIdByLoc(this._loc,function(s){s||(this._setStatus(BMAP_STATUS_INVALID_REQUEST),this._triggerCbk(BaseSearch.CBK_SEARCH_COMPLETE));var a=n(t),r=n(e),l={qt:o.QUERY_TYPE,c:s,sn:t,en:e,sy:o._opts.policy||0,brn:o._opts.pageCapacity};i=i||{};for(var h in i)l[h]=i[h];DataMgr.request(function(t,e){o._rawDataCbk(t,e)},l,{start:a,end:r})})},search:function(t,e){if(1==BaseRoute.prototype.search.call(this,t,e)){var i=this;this._getIdByLoc(this._loc,function(n){n||(this._setStatus(BMAP_STATUS_INVALID_REQUEST),this._triggerCbk(BaseSearch.CBK_SEARCH_COMPLETE));var o={qt:i.QUERY_TYPE,c:n,sn:i._formatDestQuery(t),en:i._formatDestQuery(e),sy:i._opts.policy||0,brn:i._opts.pageCapacity};DataMgr.request(function(t,e){i._rawDataCbk(t,e)},o,{start:t,end:e})})}},_rawDataCbk:function(t,e){this.clearResults(),this._json=t;var i=t.result;if(this._ud=e,0!=i.error||i.type!=this.RETURN_TYPE)return this._results=new TransitRouteResult({city:t.current_city.name,plans:[],policy:i.sy}),this._setStatus(BMAP_STATUS_UNKNOWN_ROUTE),void this._triggerCbk(BaseSearch.CBK_SEARCH_COMPLETE,this._results);this._processRaw(),this._renderList(),this._selectPlan(0)},_processRaw:function(){var t=this._json.result,e=this._json.content,i=this._json.current_city,n={},o={};"object"==typeof this._ud.start&&!this._ud.start instanceof BMap.Point?baidu.extend(n,this._ud.start):(n.title=t.start.wd||"起点",n.uid=t.start.uid,n.url=BaseSearch._getPoiUrl(n.uid,i.code),n.point=parseGeo(t.start.pt,!0,this._opts.coordType).point,n.city=i.name),"object"==typeof this._ud.end&&!this._ud.end instanceof BMap.Point?baidu.extend(o,this._ud.end):(o.title=t.end.wd||"终点",o.uid=t.end.uid,o.url=BaseSearch._getPoiUrl(o.uid,i.code),o.point=parseGeo(t.end.pt,!0,this._opts.coordType).point,o.city=i.name);var s=[];this._boundsPoints=[];for(var a=0;a<e.length;a++){this._boundsPoints[a]=[];for(var r=e[a].stops[0],l=e[a].lines[0],h=0,c=0,u=l.length;c<u;c++)"object"==typeof l[c]&&h++;for(var p=l[h+1],d=[],_=[],f=0,g="",m=0;m<r.length-1;m++){var y=r[m].getOn,v={title:y.name,uid:y.uid,url:BaseSearch._getPoiUrl(y.uid,i.code),city:i.name,point:parseGeo(y.geo,!0,this._opts.coordType).point},T=r[m+1].getOff,w={title:T.name,uid:T.uid,url:BaseSearch._getPoiUrl(T.uid,i.code),city:i.name,point:parseGeo(T.geo,!0,this._opts.coordType).point};r[m].walk.distance>0&&_.push(new Route({distance:r[m].walk.distance,points:parseGeo(r[m].walk.geo,!0,this._opts.coordType).points,rt:BMAP_ROUTE_TYPE_WALKING,index:m,planIndex:a})),f+=r[m].walk.distance,m==r.length-2&&r[m+1].walk.distance>0&&(_.push(new Route({distance:r[m+1].walk.distance,points:parseGeo(r[m+1].walk.geo,!0,this._opts.coordType).points,rt:BMAP_ROUTE_TYPE_WALKING,index:m+1,planIndex:a})),f+=r[m+1].walk.distance);var P=parseGeo(l[m].geo,!0,this._opts.coordType);d.push(new Line({title:l[m].name,uid:l[m].uid,distance:l[m].distance,points:P.points,stops:[v,w],type:this._getLineType(l[m].type),numViaStops:l[m].station_num}));var M=getPointsByBounds(P.bounds,this._opts.coordType,this._opts.renderOptions.map?this._opts.renderOptions.map.config.coordType:this._opts.coordType);this._boundsPoints[a].push(M[0],M[1]),f+=l[m].distance,r[m].walk.distance&&(g+="<b>步行</b>约"+formatDistance(r[m].walk.distance)+"，到达<b>"+v.title+"</b>，"),g+="乘坐<b>"+this._shortTitle(l[m].name)+"</b>，经过"+l[m].station_num+"站，到达<b>"+w.title+"</b>",m<r.length-2?g+="，":r[m+1].walk.distance&&(g+="，<b>步行</b>约"+formatDistance(r[m+1].walk.distance)+"，到达<b>"+r[m+1].getOn.name+"</b>")}s.push(new TransitRoutePlan({routes:_,distance:f,duration:p,lines:d,description:g}))}var E=MAP_URL+"?s="+encodeURIComponent(this.QUERY_TYPE+"&c="+i.code+"&sy="+t.sy+"&sn="+this._formatDestQuery(this._ud.start)+"&en="+this._formatDestQuery(this._ud.end)+"&sq="+(this._ud.start.title?this._ud.start.title:this._ud.start)+"&eq="+(this._ud.end.title?this._ud.end.title:this._ud.end))+"&sr=1";"Point"==this._ud.start.toString()&&"Point"==this._ud.start.toString()&&(E=""),this._results=new TransitRouteResult({city:i.name,plans:s,start:n,end:o,url:E,policy:t.sy}),this._setStatus(BMAP_STATUS_SUCCESS),this._triggerCbk(BaseSearch.CBK_SEARCH_COMPLETE,this._results)},_shortTitle:function(t){return t.replace(/\(.*\)/,"")},_renderPlan:function(t){var e=this._opts.renderOptions.map;if(e){var i=this._results.getPlan(t);if(i){var n=this._results.getStart(),o=this._results.getEnd(),s=addDestPoi(e,n.point,n.title,DEST_START,this._opts.coordType);n.marker=s,s.addEventListener("click",function(){c._select(0)}),this._overlays.push(s);var a=addDestPoi(e,o.point,o.title,DEST_END,this._opts.coordType);o.marker=a,this._overlays.push(a),a.addEventListener("click",function(){c._selectLast()});var r=convertCoord(n.point,this._opts.coordType,e.config.coordType),l=convertCoord(o.point,this._opts.coordType,e.config.coordType);this._boundsPoints[t].push(r,l);for(var h=[],c=this,u=0,p=i.getNumLines();u<p;u++){var d=i.getLine(u),_=addLine(e,d.getPoints(),this._opts.coordType);d._polyline=_,this._overlays.push(_);var f=d.getGetOnStop();h.push(f);var g=addTransPoi(e,f.point,d.type,f.title,this._opts.coordType);f.marker=g,this._overlays.push(g);var m=d.getGetOffStop();h.push(m);var y=addTransPoi(e,m.point,d.type,m.title,this._opts.coordType);m.marker=y,function(){var t=u;g.addEventListener("click",function(){c._select(2*(t+1)-1)}),y.addEventListener("click",function(){c._select(2*(t+1))})}(),this._overlays.push(y),(v=i.getRoute(u)).getDistance(!1)>0&&(_=addRoute(e,v.getPoints(),v.getRouteType(),this._opts.coordType),v._polyline=_,this._overlays.push(_))}var v=i.getRoute(u);_=addRoute(e,v.getPoints(),v.getRouteType(),this._opts.coordType),v._polyline=_,this._overlays.push(_);c=this;this._opts.renderOptions.autoViewport&&e.setViewport(this._boundsPoints[t],{margins:[30,30,30,30]}),this._triggerCbk(BaseSearch.CBK_POLYLINES_SET,i._lines,i._routes),this._triggerCbk(BaseSearch.CBK_MARKERS_SET,[n,o],h)}}},_renderList:function(){if(this._opts.renderOptions.panel&&this._opts.renderOptions.panel.appendChild&&this._results&&this._results.getNumPlans()>0){for(var t=create("div",{style:"font-size:12px;font-family:arial,sans-serif;background:#fff"}),e=BaseRoute._genTitle(this._results.getStart().title,'Instance("'+this.guid+'")._select(0)',0),i=["<table style='font:12px arial,simsun,sans-serif;border-collapse:collapse' cellpadding='0' cellspacing='0' border='0'>"],n=0,o=this._results.getNumPlans();n<o;n++){var s=this._results.getPlan(n),a=s.getDistance().replace(/(\d+(?:.\d+)?)/,"$1 "),r=s.getDuration().replace(/(\d+)/,"$1 "),l="";this._curIndex==n&&(l=";background:#f0f0f0");var h="border-bottom:1px solid #ccc;vertical-align:top;";i.push("<tr style='cursor:pointer"+l+"' onclick='Instance(\""+this.guid+'")._selectPlan('+n+")'>"),i.push("<td style='"+h+"width:20px;text-align:right;padding:4px 3px' >"+(n+1)+".</td>"),i.push("<td style='"+h+"padding:2px;line-height:18px' >"+s.getDescription()+"</td>"),i.push("<td style='"+h+"text-align:right;padding:4px 3px;white-space:nowrap' >"+a+" / "+r+"</td></tr>"),i.push("</tr>")}i.push("</table>");var c=BaseRoute._genTitle(this._results.getEnd().title,'Instance("'+this.guid+'")._selectLast()',1),u="<div style='border-bottom:1px solid #ccc;margin-bottom:10px;color:#7777cc;background:#e5ecf9;overflow:hidden;padding:2px;text-align:right'>";this._results.moreResultsUrl&&(u+="<a style='color:#7777cc' href='"+this._results.moreResultsUrl+"' target='_blank'>到百度地图查看&#187;</a>"),u+="&nbsp;</div>",t.innerHTML=e+i.join("")+c+u,this._opts.renderOptions.panel.appendChild(t),this._triggerCbk(BaseSearch.CBK_RESULTS_HTML_SET,t)}},_select:function(t){var e=this._opts.renderOptions.map;if(e){var i=this._results.getPlan(this._curIndex);if(!i)return;var n=this,o=2*i.getNumLines();if(0==t||t==o+1){var s=0===t?this._results.getStart():this._results.getEnd();(c=createTransInfoWnd({content:"<b>"+s.title+"</b>",total:o,curIndex:t,nextTransCbk:function(t){n._select(t)},type:TRANS_INFO_WND_TRANSIT})).addEventListener("open",function(){n._triggerCbk(BaseSearch.CBK_INFO_HTML_SET,s,getInfoWindowDom(e))});var a=0===t?0:1;this._overlays[a].openInfoWindow(c)}else{var r,l,h=i.getLine(Math.floor((t+1)/2)-1),c=createTransInfoWnd({content:l=t%2==1?"<b>"+(r=h.getGetOnStop()).title+"站上车</b>":"<b>"+(r=h.getGetOffStop()).title+"站下车</b>",total:o,curIndex:t,nextTransCbk:function(t){n._select(t)},type:TRANS_INFO_WND_TRANSIT});c.addEventListener("open",function(){n._triggerCbk(BaseSearch.CBK_INFO_HTML_SET,r,getInfoWindowDom(e))}),r.marker.openInfoWindow(c)}}},_selectLast:function(){if(this._results&&this._curIndex>-1){var t=this._results.getPlan(this._curIndex);if(!t)return;var e=2*t.getNumLines();this._select(e+1)}},_selectPlan:function(t){if(this._results||this._result.getPlan(t)){this._results.getPlan(t);var e=this._opts.renderOptions.map;if(e&&(e.closeInfoWindow(),this._clearOverlays(),this._renderPlan(t)),this._opts.renderOptions.panel){var i=this._opts.renderOptions.panel.getElementsByTagName("table")[0];if(!i)return;var n=i.getElementsByTagName("tr");this._curIndex>=0&&n[this._curIndex]&&(n[this._curIndex].style.background=""),t>=0&&n[t]&&(n[t].style.background="#f0f0f0")}this._curIndex=t}},_clearOverlays:function(){for(var t=0;t<this._overlays.length;t++)this._overlays[t]._p&&(this._overlays[t]._p.remove(),this._overlays[t]._p.dispose(),this._overlays[t]._p=null),this._overlays[t].remove(),this._overlays[t].dispose(),this._overlays[t]=null;this._overlays.length=0},_getLineType:function(t){return TransitRoute.LINE_TYPE_MAPPING[t]},setPageCapacity:function(t){"string"==typeof t&&(t=parseInt(t),isNaN(t))?this._opts.pageCapacity=TransitRoute.MAX_PAGE_CAPACITY:this._opts.pageCapacity="number"==typeof t&&t>=1&&t<=TransitRoute.MAX_PAGE_CAPACITY?Math.round(t):TransitRoute.MAX_PAGE_CAPACITY},toString:function(){return"TransitRoute"}}),baidu.inherits(TransitRoutePlan,RoutePlan,"TransitRoutePlan"),baidu.extend(TransitRoutePlan.prototype,{getNumLines:function(){return this._lines.length},getLine:function(t){if(this._lines[t])return this._lines[t]},getDescription:function(t){return!1===t?this._description.replace(/<(\/)?b>/g,""):this._description},getDuration:function(t){return!1===t?this._duration:formatTime(this._duration,"bustime")}}),baidu.extend(Step.prototype,{getPoint:function(){return this._point},getIndex:function(){return this._index},getDescription:function(t){return!1===t?this._description.replace(/<\/?b>/g,""):this._description},getDistance:function(t){return!1===t?this._distance:formatDistance(this._distance)},getRouteIndex:function(){return this._routeIndex},getPlanIndex:function(){return this._planIndex}});var DWRoute=function(t,e){BaseRoute.call(this,t,e),this._overlays=[],this._curIndex=-1};DWRoute.ROAD_TYPE=["","环岛","无属性道路","主路","高速连接路","交叉点内路段","连接道路","停车场内部道路","服务区内部道路","桥","步行街","辅路","匝道","全封闭道路","未定义交通区域","POI连接路","隧道","步行道","公交专用道","提前右转道"],baidu.inherits(DWRoute,BaseRoute,"DWRoute"),baidu.extend(DWRoute.prototype,{_internalSearch:function(t,e,i){function n(t){var e=t.split("$$"),i=e[0],n=null;return/^[0-2]$/.test(i)&&e.length>3&&(n=e[parseInt(i)+1]),n}var o=this;this._getIdByLoc(this._loc,function(s){s=s||1;var a=n(t),r=n(e),l={qt:o.QUERY_TYPE,c:s,sc:s,ec:s,sn:t,en:e,sy:o._opts.policy||0};i=i||{};for(var h in i)l[h]=i[h];DataMgr.request(function(t,e){o._rawDataCbk(t,e)},l,{start:a,end:r})})},search:function(t,e){if(1==BaseRoute.prototype.search.call(this,t,e)){var i=this;this._getIdByLoc(this._loc,function(n){n=n||1;var o={qt:i.QUERY_TYPE,c:n,sc:n,ec:n,sn:i._formatDestQuery(t),en:i._formatDestQuery(e),sy:i._opts.policy||0};DataMgr.request(function(t,e){i._rawDataCbk(t,e)},o,{start:t,end:e})})}},_rawDataCbk:function(t,e){this.clearResults(),this._json=t;var i=t.result;if(this._ud=e,0!=i.error||i.type!=this.RETURN_TYPE)return this._results=this._createResults({city:t.current_city.name,plans:[],policy:i.sy}),this._setStatus(BMAP_STATUS_UNKNOWN_ROUTE),void this._triggerCbk(BaseSearch.CBK_SEARCH_COMPLETE,this._results);this._processRaw(),this._renderMap(),this._renderList()},_processRaw:function(){var t=this._json.result,e=this._json.content,i=this._json.current_city,n=e.kps,o=e.rss,s={},a={};"object"==typeof this._ud.start&&!this._ud.start instanceof BMap.Point?baidu.extend(s,this._ud.start):(s.title=t.start.wd||"起点",s.uid=t.start.uid,s.url=BaseSearch._getPoiUrl(s.uid,t.start_city.code),s.point=parseGeo(t.start.pt,!0,this._opts.coordType).point,s.city=t.start_city.cname),"object"==typeof this._ud.end&&!this._ud.end instanceof BMap.Point?baidu.extend(a,this._ud.end):(a.title=t.end[0].wd||"终点",a.uid=t.end[0].uid,"null"==a.uid&&(a.uid=""),a.url=BaseSearch._getPoiUrl(a.uid,t.end_city[0].code),a.point=parseGeo(t.end[0].pt,!0,this._opts.coordType).point,a.city=t.end_city[0].cname);var r=[],l=[];this._boundsPoints=[];for(var h=0,c=n.length-1;h<c;h++){var u=n[h],p=o[h],d=o[h-1]||{},_=o[h+1],f=parseGeo(u.pt,!0,this._opts.coordType).point,g=(parseInt(p.d),this._getDescription(u,p,_,h,c,d));r.push(new Step({point:f,index:h,description:g,distance:_.d}));var m=parseGeo(p.g,!0,this._opts.coordType);if(m){for(var y=0,v=m.points.length;y<v;y++)l.push(m.points[y]);var T=getPointsByBounds(m.bounds,this._opts.coordType,this._opts.renderOptions.map?this._opts.renderOptions.map.config.coordType:this._opts.coordType);this._boundsPoints.push(T[0],T[1])}}var w=new Route({steps:r,distance:e.dis,index:0,points:l,rt:this.ROUTE_TYPE}),P=e.time;this.QUERY_TYPE==QUERY_TYPE_WALKING&&(P=Math.round(e.dis/1.35));var M=new RoutePlan({routes:[w],distance:e.dis,duration:P}),E=MAP_URL+"?s="+encodeURIComponent(this.QUERY_TYPE+"&c="+i.code+"&sc="+t.start_city.code+"&ec="+t.end_city[0].code+"&sy="+t.sy+"&sn="+this._formatDestQuery(this._ud.start)+"&en="+this._formatDestQuery(this._ud.end)+"&sq="+(this._ud.start.title?this._ud.start.title:this._ud.start)+"&eq="+(this._ud.end.title?this._ud.end.title:this._ud.end))+"&sr=1";"Point"==this._ud.start.toString()&&"Point"==this._ud.start.toString()&&(E=""),this._results=this._createResults({city:i.name,plans:[M],start:s,end:a,url:E,policy:t.sy,taxiFare:this._getTaxiFare()}),this._setStatus(BMAP_STATUS_SUCCESS),this._triggerCbk(BaseSearch.CBK_SEARCH_COMPLETE,this._results)},_getDescription:function(t,e,i,n,o,s){var a="",r=parseInt(e.d),l=e.poi;l&&(r-=l.pd);var h=formatDistance(r),c=this._getRoadName(s.t,s.n),u=this._getRoadName(e.t,e.n),p=this._getRoadName(e.t,i.n),d=this._getDwType(t.dw)||"",_=t.dr?d+"<b>"+t.dr+"</b>，":"",f=(""!=u&&c==u?"继续":"")+this._getRoadAct(e.t,e.n),g=this._getPoiInfo(e),m=this._getTicInfo(t),y=u==p?"":this._getRetAct(i.t,i.n)+"<b>"+p+"</b>";return a=f+"<b>"+u+"</b>"+this._getRetType(t.rt)+h+"，"+g+m+_,0==n?a="从<b>起点</b>向"+this._getTurnType(t.ett||t.tt)+"出发":n>0&&n<o-1?a=a+"<b>"+this._getTurnType(t.ett||t.tt)+"</b>"+y:a+="到达<b>终点</b>",a},_renderMap:function(){var t=this._opts.renderOptions.map;if(t&&this._results){var e=this._results.getPlan(0),i=e.getRoute(0),n=this._results.getStart(),o=this._results.getEnd(),s=this,a=addRoute(t,i.getPoints(),i.getRouteType(),this._opts.coordType);i._polyline=a,this._overlays.push(a);var r=addDestPoi(t,n.point,n.title,DEST_START,this._opts.coordType);n.marker=r,r.addEventListener("click",function(){s._select(0)}),this._overlays.push(r);var l=addDestPoi(t,o.point,o.title,DEST_END,this._opts.coordType);o.marker=l,this._overlays.push(l),l.addEventListener("click",function(){s._select(i.getNumSteps()+1)}),this._opts.renderOptions.autoViewport&&t.setViewport(this._boundsPoints,{margins:[30,30,30,30]}),this._triggerCbk(BaseSearch.CBK_POLYLINES_SET,e._routes),this._triggerCbk(BaseSearch.CBK_MARKERS_SET,[n,o])}},_select:function(t){var e=this._curIndex;if(this._opts.renderOptions.panel){var i=this._opts.renderOptions.panel.getElementsByTagName("table")[0].getElementsByTagName("tr");e-1>=0&&i[e-1]&&(i[e-1].style.background=""),t-1>=0&&i[t-1]&&(i[t-1].style.background="#f0f0f0")}var n=this._opts.renderOptions.map;if(n){var o=this._results.getPlan(0).getRoute(0),s=o.getNumSteps(),a=this;if(n.closeInfoWindow(),0==t||t==s+1){var r=0===t?this._results.getStart():this._results.getEnd();(c=createTransInfoWnd({content:"<b>"+r.title+"</b>",total:s,curIndex:t,nextTransCbk:function(t){a._select(t)},type:this.TRANS_INFO_WND_TYPE})).addEventListener("open",function(){a._triggerCbk(BaseSearch.CBK_INFO_HTML_SET,r,getInfoWindowDom(n))}),c.addEventListener("close",function(){if(a._opts.renderOptions.panel){var t=a._opts.renderOptions.panel.getElementsByTagName("table")[0].getElementsByTagName("tr");a._curIndex-1>=0&&t[a._curIndex-1]&&(t[a._curIndex-1].style.background="")}a._curIndex=-1});var l=0===t?1:2;this._overlays[l].openInfoWindow(c)}else{var h=o.getStep(t-1),c=createTransInfoWnd({content:h.getDescription(),total:s,curIndex:t,nextTransCbk:function(t){a._select(t)},type:this.TRANS_INFO_WND_TYPE});c.addEventListener("open",function(){a._triggerCbk(BaseSearch.CBK_INFO_HTML_SET,h,getInfoWindowDom(n))}),c.addEventListener("close",function(){if(a._opts.renderOptions.panel){var t=a._opts.renderOptions.panel.getElementsByTagName("table")[0].getElementsByTagName("tr");a._curIndex-1>=0&&t[a._curIndex-1]&&(t[a._curIndex-1].style.background="")}a._curIndex=-1});var u=convertCoord(h.getPoint(),this._opts.coordType,n.config.coordType);n.openInfoWindow(c,u)}}this._curIndex=t},_clearOverlays:function(){for(var t=0,e=this._overlays.length;t<e;t++)this._overlays[t].remove(),this._overlays[t].dispose(),this._overlays[t]=null;this._overlays.length=0},_renderList:function(){if(this._opts.renderOptions.panel&&this._opts.renderOptions.panel.appendChild&&this._results&&this._results.getNumPlans()>0){for(var t=this._results.getPlan(0),e=t.getRoute(0),i=create("div",{style:"font-size:12px;font-family:arial, sans-serif;background:#fff"}),n=BaseRoute._genTitle(this._results.getStart().title,'Instance("'+this.guid+'")._select(0)',0),o=["<table style='font:12px arial,simsun,sans-serif;border-collapse:collapse' cellpadding='0' cellspacing='0' border='0'>"],s=0,a=e.getNumSteps();s<a;s++){var r="";this._curIndex==s+1&&(r=";background:#f0f0f0"),o.push("<tr style='cursor:pointer"+r+"' onclick='Instance(\""+this.guid+'")._select('+(s+1)+")'>"),o.push("<td style='border-bottom:1px solid #ccc;width:20px;vertical-align:top;text-align:right;padding:4px 3px' >"+(s+1)+".</td>"),o.push("<td style='border-bottom:1px solid #ccc;padding:2px;line-height:18px' >"+e.getStep(s).getDescription()+"</td>"),o.push("</tr>")}o.push("</table>");var l=BaseRoute._genTitle(this._results.getEnd().title,'Instance("'+this.guid+'")._select('+(e.getNumSteps()+1)+")",1),h="<div style='border-bottom:1px solid #ccc;margin-bottom:10px;color:#7777cc;background:#e5ecf9;overflow:hidden;padding:2px;text-align:right'><span style='float:left;padding-left:6px'>全程："+t.getDistance().replace(/(\d+(?:.\d+)?)/,"$1 ")+" / "+t.getDuration().replace(/(\d+)/,"$1 ")+"</span>";this._results.moreResultsUrl&&(h+="<a style='color:#7777cc' href='"+this._results.moreResultsUrl+"' target='_blank'>到百度地图查看&#187;</a>"),h+="&nbsp;</div>",i.innerHTML=n+o.join("")+l+h,this._opts.renderOptions.panel.appendChild(i),this._triggerCbk(BaseSearch.CBK_RESULTS_HTML_SET,i)}},_getRoadName:function(t,e){return""!=e&&e||9!=t&&12!=t&&1!=t&&16!=t||(e=DWRoute.ROAD_TYPE[t]),e},_getPoiInfo:function(t){var e="",i=t.poi;if(i){var n=this._getPsType(i.ps)||"",o=this._getPwType(i.pw)||"",s=i.pd<(13==t.t||4==t.t?1e3:50)?"":"约"+formatDistance(i.pd)+"后";e=o+n+"<b>"+i.pn+"</b>"+s+(""==n?"":"，")}return e},_getTicInfo:function(t){var e=t.iw;return t.ic?(this._getIwGo(e)||"")+"<b>"+t.ic+"</b>"+(this._getIwTo(e)||""):""},_getRoadAct:function(t,e){var i="沿";return(0==t||!e&&1!=t&&16!=t&&9!=t&&12!=t)&&(i=""),i},_getRetAct:function(t,e){var i="进入";return e||9!=t&&12!=t?(0==t||!e&&1!=t&&16!=t)&&(i=""):i="上",i},_getTaxiFare:function(){if(this._json&&this._json.content&&this._json.content.taxi){var t=this._json.content.taxi,e={distance:t.dis,remark:t.remark};if(t.detail[0]){var i=t.detail[0];e.day={initialFare:parseFloat(i.startPrice),unitFare:parseFloat(i.kmPrice),totalFare:parseFloat(i.totalPrice)}}if(t.detail[1]){var n=t.detail[1];e.night={initialFare:parseFloat(n.startPrice),unitFare:parseFloat(n.kmPrice),totalFare:parseFloat(n.totalPrice)}}return e}return null}}),window.BMAP_DRIVING_POLICY_LEAST_TIME=0,window.BMAP_DRIVING_POLICY_LEAST_DISTANCE=1,window.BMAP_DRIVING_POLICY_AVOID_HIGHWAYS=2,baidu.inherits(DrivingRoute,DWRoute,"DrivingRoute"),DrivingRoute.TURN_TYPE=["","直行","右前方转弯","右转","右后方转弯","调头","左后方转弯","左转","左前方转弯","稍向左转","直行","稍向右转","正北方向","东北方向","正东方向","东南方向","正南方向","西南方向","正西方向","西北方向"],DrivingRoute.RET_TYPE=["","从起点出发","到达目的地","途经点","行驶"],DrivingRoute.IWGO=["在","从","从"],DrivingRoute.IWTO=["","","离开"],DrivingRoute.PWTYPE=["过","在"],DrivingRoute.PSTYPE=["左侧的","右侧的",""],DrivingRoute.DWTYPE=["","朝"],baidu.extend(DrivingRoute.prototype,{setPolicy:function(t){t>=BMAP_DRIVING_POLICY_LEAST_TIME&&t<=BMAP_DRIVING_POLICY_AVOID_HIGHWAYS?this._opts.policy=t:this._opts.policy=BMAP_DRIVING_POLICY_LEAST_TIME},_createResults:function(t){return new DrivingRouteResult(t)},_getTurnType:function(t){return DrivingRoute.TURN_TYPE[t]},_getRetType:function(t){return DrivingRoute.RET_TYPE[t]},_getIwGo:function(t){return DrivingRoute.IWGO[t]},_getIwTo:function(t){return DrivingRoute.IWTO[t]},_getPwType:function(t){return DrivingRoute.PWTYPE[t]},_getPsType:function(t){return DrivingRoute.PSTYPE[t]},_getDwType:function(t){return DrivingRoute.DWTYPE[t]},toString:function(){return"DrivingRoute"}}),baidu.inherits(WalkingRoute,DWRoute,"WalkingRoute"),WalkingRoute.TURN_TYPE=["","直走","向右前方转","右转","向右后方转","向后转","向左后方转","左转","向左前方转","左转穿过马路并继续向前","右转穿过马路并继续向前","左转穿过马路并往回走","右转穿过马路并往回走","正北方向","东北方向","正东方向","东南方向","正南方向","西南方向","正西方向","西北方向","","","",""],WalkingRoute.RET_TYPE=["","从起点出发","到达目的地","途经点","走"],WalkingRoute.IWGO=["在","从","从"],WalkingRoute.IWTO=["","","离开"],WalkingRoute.PWTYPE=["过","在"],WalkingRoute.PSTYPE=["左侧的","右侧的",""],WalkingRoute.DWTYPE=["","朝"],baidu.extend(WalkingRoute.prototype,{_createResults:function(t){return delete t.url,new WalkingRouteResult(t)},_getTurnType:function(t){return WalkingRoute.TURN_TYPE[t]},_getRetType:function(t){return WalkingRoute.RET_TYPE[t]},_getIwGo:function(t){return WalkingRoute.IWGO[t]},_getIwTo:function(t){return WalkingRoute.IWTO[t]},_getPwType:function(t){return WalkingRoute.PWTYPE[t]},_getPsType:function(t){return WalkingRoute.PSTYPE[t]},_getDwType:function(t){return WalkingRoute.DWTYPE[t]},toString:function(){return"WalkingRoute"}}),baidu.extend(Line.prototype,{getNumViaStops:function(){return this._numViaStops},getGetOnStop:function(){return this._stops[0]},getGetOffStop:function(){return this._stops[1]},getPoints:function(){return this._points},getPolyline:function(){return this._polyline},getDistance:function(t){return!1===t?this._distance:formatDistance(this._distance)}}),baidu.extend(Popup.prototype,{render:function(){var t=this.config;this.main=create("div",{style:"position:absolute;z-index:20;width:390px;display:none;font-size:12px;font-family:arial,sans-serif"}),this.popBox=create("div",{style:"border:1px solid #8ba4d8;z-index:2;position:absolute;width:100%;height:100%;background:#FFF;overflow:hidden"}),this.main.appendChild(this.popBox),0!=t.isTitle&&(this.title=create("div",{style:"background:url("+API_URL+"img/popup_title.gif);height:24px;line-height:25px;font-size:12px;font-weight:bold;color:#6688cc;padding-left:7px"}),this.popBox.appendChild(this.title)),this.content=create("div"),this.popBox.appendChild(this.content),this.button=create("button",{style:"position:absolute;top:6px;right:4px;width:12px;height:12px;background:url("+API_URL+"img/popup_close.gif) no-repeat;border:0;cursor:pointer",id:"popup_close"}),this.popBox.appendChild(this.button),this.shadow=create("div",{style:"width:100%; height:100%; background:#505050;border:1px solid #505050; position:absolute;left:2px; top:3px;z-index:1;opacity:0.4;filter:alpha(opacity=40)"}),this.main.appendChild(this.shadow),this.config.addDom.appendChild(this.main),this.addConnectDom(this.main),this.initialize()},initialize:function(){var t=this.config;this.setTitle(t.title),this.setContent(t.content),this.setWidth(t.width),this.setHeight(t.height),this.show();var e=this,i=function(t){for(var i=t.srcElement||t.target;i;){for(var n=e.connectDom,o=0;o<n.length;o++)if(i==n[o])return;if(i==document.body)return void e.close();i=i.parentNode}};this.config.clickClose&&baidu.on(document.body,"mousedown",i),baidu.on(this.button,"click",function(t){e.config.clickClose&&baidu.un(document.body,"mousedown",i),e.main.parentNode.removeChild(e.main),e.visible=!1,e.config.close&&"function"==typeof e.config.close&&e.config.close(),this.resizeTimer&&(window.clearInterval(this.resizeTimer),this.resizeTimer=null),baidu.G("imgLogo")&&(baidu.G("imgLogo").style.display="",baidu.G("imgLogo").style.display="inline")}),t.open&&"function"==typeof t.open&&t.open()},setTitle:function(t){t&&this.title&&(this.title.innerHTML=t,this.config.title=t)},setContent:function(t){t&&("string"==typeof t?this.content.innerHTML=t:(this.content.innerHTML="",this.content.appendChild(t)),this.config.content=t)},setWidth:function(t){t&&(this.main.style.width=t-8+"px",this.config.width=t)},setHeight:function(t){this.resizeTimer&&(window.clearInterval(this.resizeTimer),this.resizeTimer=null),t?(this.main.style.height=this.shadow.style.height=t-9+"px",this.config.height=t,0==this.config.isTitle?this.content.style.height=t-2+"px":this.content.style.height=t-24-9+"px",this.content.style.overflowY="auto"):(this.content.style.height="auto",this.resize())},hide:function(){this.main.style.display="none",this.visible=!1},show:function(){this.main.style.display="block",this.popBox.scrollTop=0,this.visible=!0},getDom:function(){return this.main},resize:function(){var t=this;this.resizeTimer&&(window.clearInterval(this.resizeTimer),this.resizeTimer=null),this.resizeTimer=window.setInterval(function(){var e=t.content.offsetHeight+24;t.mainHeight&&t.mainHeight!=e&&(t.mainHeight=e),t.popBox.style.height=t.shadow.style.height=t.main.style.height=e+"px",t.popBox.scrollTop=0},50)},close:function(){this.button.click()},addConnectDom:function(t){this.connectDom.push(t)}}),baidu.extend(RouteResult.prototype,{getStart:function(){return this._start},getEnd:function(){return this._end},getNumPlans:function(){return this._plans.length},getPlan:function(t){if(this._plans[t])return this._plans[t]}}),baidu.inherits(DrivingRouteResult,RouteResult,"DrivingRouteResult"),baidu.inherits(WalkingRouteResult,RouteResult,"WalkingRouteResult"),baidu.inherits(TransitRouteResult,RouteResult,"TransitRouteResult"),baidu.extend(Geolocation.prototype,{getCurrentPosition:function(t,e){if(this._callback=t||function(){},navigator.geolocation){var i=this;navigator.geolocation.getCurrentPosition(function(t){i._onSuccessCallback(t)},function(t){i._onErrorCallback(t.code+5)},e)}else this._onErrorCallback(BMAP_STATUS_SERVICE_UNAVAILABLE)},_onSuccessCallback:function(t){var e=t.coords,i=this,n={x:e.longitude,y:e.latitude,from:"0",to:"4"};DataMgr.request(function(t){var n=t&&0==t.error?new BMap.Point(t.x,t.y):new BMap.Point(e.longitude,e.latitude);n=convertCoord(n,BMAP_COORD_LNGLAT,i._opts.coordType),i._status=BMAP_STATUS_SUCCESS;var o={point:n,accuracy:e.accuracy};i._callback(o)},n,null,"ag/coord/convert")},_onErrorCallback:function(t){this._status=t,this._callback(null)},getStatus:function(){return this._status}}),Geolocation.prototype.toString=function(){return"Geolocation"};var TrafficControl=function(t){BMap.Control.call(this),this.hashCode=TrafficControl._guid++,TrafficControl._instances[this.hashCode]=this,BMap.MapType.B_LiveTraffic_MAP={tileUrls:["https://wp0.map.baidu.com/traffic/","https://wp1.map.baidu.com/traffic/","https://wp2.map.baidu.com/traffic/","https://wp3.map.baidu.com/traffic/"],tileSize:256,baseUnits:256,zoomLevelMin:1,zoomLevelMax:18,errorUrl:API_URL+"bmap/blank.gif",bounds:new BMap.Bounds(-21364736,-10616832,23855104,15859712),imgExtend:"png"},BMap.MapType.B_ForecastTraffic_MAP={tileUrls:["https://wp0.map.baidu.com/traffic/","https://wp1.map.baidu.com/traffic/","https://wp2.map.baidu.com/traffic/","https://wp3.map.baidu.com/traffic/"],tileSize:256,baseUnits:256,zoomLevelMin:1,zoomLevelMax:18,errorUrl:API_URL+"bmap/blank.gif",bounds:new BMap.Bounds(-21364736,-10616832,23855104,15859712),imgExtend:"png"},this.opened=!1,this.anchorFixed=!0,this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT,this.defaultOffset=new BMap.Size(10,10),this.type="default",this.now="",this.timer=null,this.weeks=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],this.week=0,this.hour=0,this._opts=this._opts||{},baidu.extend(this._opts,{offset:this.defaultOffset,panelOffset:new BMap.Size(this.defaultOffset.width+3,this.defaultOffset.height+24)}),this.markers=[],this.city={beijing:{bound:new BMap.Bounds(13024002.48,4865927.36,12896002.48,4800007.36),point:new BMap.Point(12959415.04,4825643.77)},shanghai:{bound:new BMap.Bounds(13586486.26,3671676.37,13458486.26,3605756.37),point:new BMap.Point(13525431,3642155)},guangzhou:{bound:new BMap.Bounds(12673391.11,2664430.08,12545391.11,2598510.08),point:new BMap.Point(12612023,2630443)},shenzhen:{bound:new BMap.Bounds(12725451.44,2575402.35,12661451.44,2545962.35),point:new BMap.Point(12689847,2569003)},changzhou:{bound:new BMap.Bounds(13346437,3697277,13363737,3729174),point:new BMap.Point(13355087,3713225)},chengdu:{bound:new BMap.Bounds(11575175,3557689,11597068,3577705),point:new BMap.Point(11586121,3567697)},dalian:{bound:new BMap.Bounds(13524453,4672572,13546187,4698377),point:new BMap.Point(13535320,4685474)},chongqing:{bound:new BMap.Bounds(11846022,3408422,11868701,3438052),point:new BMap.Point(11857361,3423237)}},baidu.extend(this._opts,t||{}),this.setOffset(this._opts.offset),this.setPanelOffset(this._opts.panelOffset)};TrafficControl._guid=0,window.TI=TrafficControl._I=function(t){return TrafficControl._instances[t]},TrafficControl._instances=[],TrafficControl.prototype=new BMap.Control,TrafficControl.time=18e4,baidu.extend(TrafficControl.prototype,{initialize:function(t){function e(t){if(i._map){var e=i._map.getBounds(),n=0;for(var o in i.city)e.containsBounds(i.city[o].bound)&&n++;for(var o in i.city)if(n<=1&&null!=e.intersects(i.city[o].bound)){o;break}i._map.getZoom()>9?(t.type.indexOf("zoom")>0&&i.ishide&&1==i.ishide&&(i.show(),i.ishide=0),i.removeMarker()):(t.type.indexOf("zoom")>0&&1==i.opened&&(i.ishide=1,i.addMarker()),i.hide())}}this._map=t;var i=this,n=document.createElement("div");return baidu.extend(n.style,{background:"transparent url("+API_URL+"images/mapctrls.gif) no-repeat scroll 0 -86px",cursor:"pointer",height:"22px",top:"10px",width:"73px",zIndex:"800"}),n.title="显示交通流量",t.getContainer().appendChild(n),this.bind(n),t.addEventListener("load",function(t){e(t)}),t.addEventListener("moveend",function(t){e(t)}),t.addEventListener("mapcontainerresize",function(t){e(t)}),t.addEventListener("dragend",function(t){e(t)}),t.addEventListener("zoomend",function(t){e(t)}),t.addEventListener("zoomstart",function(t){e(t)}),n},bind:function(t){var e=this;t.onmousedown=function(){e.markers=[],this.style.backgroundPosition="0 -108px"},t.onclick=function(){e._toggle()}},setWeek:function(t){for(var e=0;e<7;e++)baidu.G("week_"+this.hashCode+"_"+e).className="",baidu.G("week_"+this.hashCode+"_"+e)==t&&(this.week=e,t.className="on",baidu.G("font_"+this.hashCode).innerHTML="星期"+t.innerHTML+"&nbsp;",this.setForecast())},_genHtml:function(){var t=this.hashCode,e=["一","二","三","四","五","六","日"],i=['<div class="traffic_Panel" style="height:30px;padding:5px;-moz-user-select:none" onselectstart="return false">'];i.push('<div style="background:url('+API_URL+'img/tools_menu.gif) no-repeat 130px -85px;font-weight:bold" id="title_'+t+'">实时路况</div>'),i.push('<div style="margin-top:5px;height:20px"><span id="font_'+t+'" style="float:left;color:#666">当前时间：&nbsp;</span>'),i.push('<span id="time_'+t+'" style="float:left;color:#666"></span>'),i.push('<span class="update" style="float:left;width:13px;height:14px;background:url('+API_URL+'img/tools_menu.gif) no-repeat -12px -18px;margin-left:5px;cursor:pointer" id="bt_'+t+'" onclick="TI(\''+t+'\').setPanel(this)" title="更新" ></span>'),i.push('<a style="outline:none;float:right;color:#00f;text-decoration:none;line-height:15px;*line-height:18px" href="javascript:void(0)" onclick = "TI(\''+t+"').switchInfo(this)\">查看流量预测</a></div>"),i.push('<table id="forecast_'+t+'" width="233" style="font-size:12px;display:none;color:#6688ca; margin-top:5px"><tr>'),i.push('<td style="width:35px">星期</td>');for(var n=0;n<7;n++)i.push('<td style="width:23px"><span style="padding:3px;cursor:pointer" id="week_'+t+"_"+n+'" onclick = "TI(\''+t+"').setWeek(this)\">"+e[n]+"</span></td>");return i.push("</tr><tr>"),i.push('<td style="height:42px;width:35px"><div style="padding-top:16px;*padding-top:18px">时间</div></td>'),i.push('<td colspan="7" style="188px">'),i.push('<div style="background:url('+API_URL+'img/bar.gif) no-repeat 0 10px;width:193px;height:40px;overflow:hidden">'),i.push('<div><div id="timeBox_'+t+'" style="color:#6688cc;margin-left:74px;font-size:11px;overflow:hidden">12:00</div></div>'),i.push('<div style="height:34px">'),i.push('<div id="bar_prev_'+t+'" style="overflow:hidden;width:9px;height:9px;cursor:pointer;float:left;margin-top:5px" onclick="TI(\''+t+"').setBarBut('prev')\"></div>"),i.push('<div id="bar_'+t+'" style="width:9px;height:18px;background:url('+API_URL+'img/tools_menu.gif) no-repeat 0 -32px;float:left;margin-top:0;cursor:pointer;margin-left:74px;_margin-left:42px;margin-top:0px;"></div>'),i.push('<div id="bar_next_'+t+'" style="overflow:hidden;width:11px;*width:10px;height:9px;cursor:pointer;float:right;margin-top:5px" onclick="TI(\''+t+"').setBarBut('next')\"></div>"),i.push("</div></div></td></tr></table>"),i.push('<div style="text-align:center;color:#9a9a9a;display:none" id="info_'+t+'">（基于历史流量统计预测 仅供参考）</div></div>'),i.join("")},_launch:function(){var t=this;this._getTime(),t.trafficTimer&&clearInterval(t.trafficTimer),t.trafficTimer=setInterval(function(){t._getTime()},TrafficControl.time),this.setBar(),this.setBarTime(12)},_getTime:function(){if("default"==this.type){var t=this,e=[{code:131,name:"beijing"},{code:289,name:"shanghai"},{code:257,name:"guangzhou"}],i=BMap.MapType.B_LiveTraffic_MAP;this._getCityCode(function(n){for(var o=0;o<e.length;o++)if(n==e[o].code)return void scriptRequest(i.tileUrls[0]+e[o].name+".js?newmap=1",function(){t.updateTime(e[o].name)},"traffic_js");scriptRequest(i.tileUrls[0]+"beijing.js?newmap=1",function(){t.updateTime("beijing")},"traffic_js")})}},setPanel:function(t){"update"!=t.className?"update2"==t.className?(t.className="update1",baidu.G("forecast_"+this.hashCode).style.display=baidu.G("info_"+this.hashCode).style.display="none",this.pop.setHeight(53)):(t.className="update2",baidu.G("forecast_"+this.hashCode).style.display=baidu.G("info_"+this.hashCode).style.display="",this.pop.setHeight(150)):this._getTime()},switchInfo:function(t){var e=baidu.G("title_"+this.hashCode),i=baidu.G("font_"+this.hashCode),n=baidu.G("bt_"+this.hashCode),o=["查看流量预测","查看实时路况"];if(t.innerHTML==o[0]){this.type="forecast",t.innerHTML=o[1],this.pop.setHeight(150),baidu.G("forecast_"+this.hashCode).style.display=baidu.G("info_"+this.hashCode).style.display="",e.innerHTML="流量预测";var s=new Date(this.now).getDay();if(i.innerHTML=this.weeks[s]+"&nbsp;",this.now){var a=new Date(this.now);baidu.G("time_"+this.hashCode).innerHTML=a.getHours()+":00",this.setWeek(baidu.G("week_"+this.hashCode+"_"+a.getDay())),this.week=a.getDay(),this.hour=a.getHours()}this.setBarTime(this.hour),n.className="update2"}else this.type="default",this._getTime(),t.innerHTML=o[0],baidu.G("time_"+this.hashCode).innerHTML="",this.pop.setHeight(53),baidu.G("forecast_"+this.hashCode).style.display=baidu.G("info_"+this.hashCode).style.display="none",e.innerHTML="实时路况",i.innerHTML="当前时间：&nbsp;",n.className="update",this.addTrafficLay("B_LiveTraffic_MAP")},addTrafficLay:function(t){var e=this._map;this.currentTrafficLay&&e.removeTileLayer(this.currentTrafficLay);var i=new BMap.Bounds(-21364736,-10616832,23855104,15859712),n=(new BMap.Copyright(i,"",t),new BMap.TileLayer({mapType:t,transparentPng:!0}));n.getTilesUrl=function(t,e){var i=BMap.MapType[this.mapType];if("object"!=typeof i)return null;i.baseUnits,Math.pow(2,i.zoomLevelMax-e);var n=t.x,o=t.y,s=Math.floor(n/200),a=Math.floor(o/200),r="",l=(new Date).getTime();return r=i.tileUrls[Math.abs(n+o)%i.tileUrls.length]+e+"/"+s+"/"+a+"/"+n+"_"+o+".png?t="+l,r=r.replace(/-(\d+)/gi,"M$1")},e.addTileLayer(n),this.currentTrafficLay=n},clearTrafficLay:function(){this.currentTrafficLay&&this._map.removeTileLayer(this.currentTrafficLay)},setMarker:function(){var t=this,e=new BMap.Icon(API_URL+"img/traffic.png",new BMap.Size(28,35),{offset:new BMap.Size(6,35)});for(var i in t.city){var n=t.city[i].point;t._map.config.coordType==BMAP_COORD_LNGLAT&&(n=BMap.Projection.convertMC2LL(n)),t.markers||(t.markers=[]);var o=new BMap.Marker(n,{icon:e});t.markers.push(o)}},addMarker:function(){var t=this,e=t.markers;for(var i in e)null==e[i].domElement&&(e[i].addEventListener("click",function(){t._map.centerAndZoom(this.point,11),t.show()}),t._map.addOverlay(e[i]),e[i].domElement.setAttribute("type","system"),e[i].siblingElement.setAttribute("type","system"),e[i].domElement.title="点击查看交通流量"),e[i].show()},removeMarker:function(){var t=this.markers;try{for(var e in t)t[e].hide()}catch(t){}},updateTime:function(t){if(""!=t&&null!=t&&"default"==this.type){var e=window["_Lukuang_"+t],i=new Date(e);baidu.G("time_"+this.hashCode).innerHTML=(i.getHours()<10?"0"+i.getHours():i.getHours())+":"+(i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes()),e&&e>this.now&&(this.now=e,this.updateTile())}},updateTile:function(){this.addTrafficLay("B_LiveTraffic_MAP")},_getCityCode:function(t){var e=this._map.getCenter(),i=this._map.getZoom();this._map.config.coordType==BMAP_COORD_LNGLAT&&(e=BMap.Projection.convertLL2MC(e)),DataMgr.request(function(e){e&&e.result&&e.result.type==RETURN_TYPE_CENTER&&t&&t(e.content.uid)},{qt:QUERY_TYPE_CENTER,b:e.lng+","+e.lat+";"+e.lng+","+e.lat,l:i})},setBar:function(){function t(t){var e=(t.clientX||t.x)-(getPosition(baidu.G("bar_prev_"+i.hashCode)).left+9)-4;e<0&&(e=0),e>165&&(e=165),FeBrowser.ie<=6&&FeBrowser.ie>0?n.style.marginLeft=.53*e+"px":n.style.marginLeft=e+"px",baidu.G("timeBox_"+i.hashCode).style.marginLeft=e+"px",i.setTimeBox()}function e(){baidu.un(document,"onmousemove",t),baidu.un(document,"onmouseup",e),i.setForecast()}var i=this,n=baidu.G("bar_"+this.hashCode);baidu.on(n,"onmousedown",function(){baidu.on(document,"onmousemove",t),baidu.on(document,"onmouseup",e)})},setBarTime:function(t){t<0&&(t=0),t>24&&(t=24),this.hour=t;var e=6.875*t;baidu.G("timeBox_"+this.hashCode).style.marginLeft=e+"px";var i=baidu.G("bar_"+this.hashCode);FeBrowser.ie<=6&&FeBrowser.ie>0?i.style.marginLeft=.53*e+"px":i.style.marginLeft=e+"px",this.setTimeBox()},setTimeBox:function(){var t=baidu.G("timeBox_"+this.hashCode),e=baidu.G("time_"+this.hashCode),i=parseInt(t.style.marginLeft),n=Math.ceil(24*(i-4)/165);this.hour=n,n<10&&(n="0"+n),e.innerHTML=t.innerHTML=n+":00"},setBarBut:function(t){var e=baidu.G("timeBox_"+this.hashCode),i=parseInt(e.style.marginLeft),n=Math.ceil(24*(i-4)/165);this.setBarTime("next"==t?n+1:n-1),this.setForecast()},setForecast:function(){var t=this.hour;24==t&&(t=0);for(var e=BMap.MapType.B_ForecastTraffic_MAP,i=BMap.MapType.B_LiveTraffic_MAP,n=0;n<i.tileUrls.length;n++)e.tileUrls[n]=i.tileUrls[n]+"history/"+this.week+"/"+t+"/";this.addTrafficLay("B_ForecastTraffic_MAP")},setPanelOffset:function(t){t&&"Size"==t.toString()&&(this._opts.panelOffset=new BMap.Size(t.width,t.height),this.pop&&this.pop.getDom()&&(this.pop.getDom().style.right=t.width+"px",this.pop.getDom().style.top=t.height+"px"))},show:function(){if(!this.opened){var t=this;this.setMarker(),this.opened=!0,this._container.style.backgroundPosition="0 -108px",this._container.title="隐藏交通流量";var e={height:53,width:251,addDom:t._map.getContainer(),clickClose:!1,isTitle:!1,close:function(){t.hide()}},i=t.pop=new Popup(e);i.render(),i.hide(),i.content.innerHTML=t._genHtml(),i.getDom().style.right=t._opts.panelOffset.width+"px",i.getDom().style.top=t._opts.panelOffset.height+"px",i.getDom()._anchor=t.defaultAnchor,i.getDom()._offset=t._opts.panelOffset,i.show(),baidu.G("popup_close").onmouseup=function(){if(t.markers){mks=t.markers;for(var e in mks)mks[e].remove()}t.markers=null},t._launch()}},hide:function(){this.opened&&(this.opened=!1,this.now="",this.type="default",this.pop.close(),this._container&&(this._container.style.backgroundPosition="0 -86px",this._container.title="显示交通流量"),this.trafficTimer&&clearInterval(this.trafficTimer),this.clearTrafficLay())},_toggle:function(){this.opened?this.hide():this.show()}}),baidu.inherits(LocalCity,baidu.lang.Class,"LocalCity"),baidu.extend(LocalCity.prototype,{get:function(t){var e=this;DataMgr.request(function(i){if(i&&i.result&&i.result.type==RETURN_TYPE_CURRENT_CITY){var n=i.result,o=i.content;if(n&&0==n.error){var s=e._opts.renderOptions.map,a=o.level,r=o.cname,l=o.code,h=parseGeo(o.geo,!0,e._opts.coordType).point;a=getBestLevel(a,s),s&&s.centerAndZoom(h,a)}t&&t({center:h,level:a,name:r,code:l})}},{qt:QUERY_TYPE_LOCALCITY})},toString:function(){return"LocalCity"}}),baidu.inherits(Geocoder,baidu.lang.Class,"Geocoder"),baidu.extend(Geocoder.prototype,{getPoint:function(t,e,i){var n=this;i=i||"北京市",DataMgr.request(function(t){if(t&&t.result&&t.result.type==RETURN_TYPE_GEOCODER){var i=t.result,o=t.content,s=null,a=null;if(i&&0==i.error){var r=o.coord.x,l=o.coord.y;s=new BMap.Point(r,l),n._opts.coordType==BMAP_COORD_LNGLAT&&(s=BMap.Projection.convertMC2LL(s)),n.point=s,n.city=o.cn,n.citycode=o.sc,n.address=o.wd,n.precision=o.precision,a={city:o.cn,address:o.wd,citycode:o.sc}}e&&e(s,a)}},{qt:QUERY_TYPE_GEOCODER,wd:t,cn:i})},getLocation:function(t,e,i){if(!t||"Point"!=t.toString()&&e)e(null);else{var n=this,o=(t=this._opts.coordType==BMAP_COORD_LNGLAT?BMap.Projection.convertLL2MC(t):t).lng,s=t.lat,a=(i=i||{}).poiRadius||100,r=i.numPois||10;DataMgr.request(function(t){var i=null;if(t&&t.result&&t.result.type==RETURN_TYPE_REVERSE_GEOCODER){var o,s=t.result,a=t.content,r={},l=[];if(0==s.error){var h=a.address_detail,c=h.city;h&&(r.streetNumber=h.street_number,r.street=h.street,r.district=h.district,r.city=c,r.province=h.province),o=a.point;var u=new BMap.Point(o.x,o.y);n._opts.coordType==BMAP_COORD_LNGLAT&&(u=BMap.Projection.convertMC2LL(u));var p=a.surround_poi;if(p&&p.length)for(var d=0,_=p.length;d<_;d++){var f={},g=p[d];f.title=g.name,f.uid=g.uid;var m=new BMap.Point(g.point.x,g.point.y);n._opts.coordType==BMAP_COORD_LNGLAT&&(m=BMap.Projection.convertMC2LL(m)),f.point=m,f.city=c,f._poiType=g.poiType,f.type=BMAP_POI_TYPE_NORMAL,f.address=g.addr,f.postcode=g.zip||null,f.phoneNumber=g.tel||null,l.push(f)}i={point:u,address:a.address,addressComponents:r,surroundingPois:l,business:a.business}}}e&&e(i)},{qt:QUERY_TYPE_REVERSE_GEOCODER,x:o,y:s,dis_poi:a,poi_num:r})}},toString:function(){return"Geocoder"}});var STAT_APPJS_EXECUTE=5100;window._addStat(STAT_APPJS_EXECUTE),window.BMAP_STATUS_SUCCESS=0,window.BMAP_STATUS_CITY_LIST=1,window.BMAP_STATUS_UNKNOWN_LOCATION=2,window.BMAP_STATUS_UNKNOWN_ROUTE=3,window.BMAP_STATUS_INVALID_KEY=4,window.BMAP_STATUS_INVALID_REQUEST=5,window.BMAP_STATUS_PERMISSION_DENIED=6,window.BMAP_STATUS_SERVICE_UNAVAILABLE=7,window.BMAP_STATUS_TIMEOUT=8,window.BMAP_ROUTE_TYPE_WALKING=2,window.BMAP_ROUTE_TYPE_DRIVING=3;var QUERY_TYPE_CURRENT_CITY="cur",QUERY_TYPE_CENTER="cen",QUERY_TYPE_POI_SEARCH="s",QUERY_TYPE_SEARCH_INBOUNDS="bd",QUERY_TYPE_SEARCH_NEARBY="nb",QUERY_TYPE_TRANSIT="bt",QUERY_TYPE_DRIVING="nav",QUERY_TYPE_WALKING="walk",QUERY_TYPE_GEOCODER="gc",QUERY_TYPE_REVERSE_GEOCODER="rgc",QUERY_TYPE_LOCALCITY="dec",QUERY_TYPE_EXT="ext",RETURN_TYPE_CURRENT_CITY=2,RETURN_TYPE_CENTER=4,RETURN_TYPE_CITY_LIST=7,RETURN_TYPE_POI_SEARCH=11,RETURN_TYPE_SEARCH_NEARBY=12,RETURN_TYPE_TRANSIT=14,RETURN_TYPE_DRIVING=20,RETURN_TYPE_SEARCH_INBOUNDS=21,RETURN_TYPE_SPECIAL_REGION=26,RETURN_TYPE_NODATA_REGION=28,RETURN_TYPE_WALKING=31,RETURN_TYPE_GEOCODER=35,RETURN_TYPE_REVERSE_GEOCODER=44,LOC_TYPE_UNKNOWN=-1,LOC_TYPE_MAP=0,LOC_TYPE_POINT=1,LOC_TYPE_STRING=2,GEO_TYPE_AREA=0,GEO_TYPE_LINE=1,GEO_TYPE_POINT=2,MAP_URL="https://map.baidu.com/",API_URL="https://api.map.baidu.com/",_EXT_CHARS_=["=",".","-","*"],_MAX_DELTA_=1<<23;window.Instance=baidu.lang.instance,baidu.extend(Page.prototype,{render:function(){this.initialize()},initialize:function(){this.checkPages(),this.container.innerHTML=this.createHtml()},checkPages:function(){isNaN(parseInt(this.page))&&(this.page=1),isNaN(parseInt(this.pageCount))&&(this.pageCount=1),this.page<1&&(this.page=1),this.pageCount<1&&(this.pageCount=1),this.page>this.pageCount&&(this.page=this.pageCount),this.page=parseInt(this.page),this.pageCount=parseInt(this.pageCount)},getPage:function(){var t=location.search,e=new RegExp("[?&]?"+this.argName+"=([^&]*)[&$]?","gi");t.match(e);this.page=RegExp.$1},createHtml:function(){var t=[],e=this.page-1,i=this.page+1;if(t.push('<p style="margin:0;padding:0;white-space:nowrap">'),e<1||(this.page>=this.pagecap&&t.push('<span style="margin-right:3px"><a style="color:#7777cc" href="javascript:void(0)" onclick="Instance(\''+this.guid+"').toPage(1);\">首页</a></span>"),t.push('<span style="margin-right:3px"><a style="color:#7777cc" href="javascript:void(0)" onclick="Instance(\''+this.guid+"').toPage("+e+');">上一页</a></span>')),this.page<this.pagecap){if(this.page%this.pagecap==0)a=this.page-this.pagecap-1;else a=this.page-this.page%this.pagecap+1;s=a+this.pagecap-1}else{var n=Math.floor(this.pagecap/2),o=this.pagecap%2-1;if(this.pageCount>this.page+n)var s=this.page+n,a=this.page-n-o;else var s=this.pageCount,a=this.page-n-o}if(this.page>this.pageCount-this.pagecap&&this.page>=this.pagecap)var a=this.pageCount-this.pagecap+1,s=this.pageCount;for(var r=a;r<=s;r++)r>0&&(r==this.page?t.push('<span style="margin-right:3px">'+r+"</span>"):r>=1&&r<=this.pageCount&&t.push('<span><a style="color:#7777cc;margin-right:3px" href="javascript:void(0)" onclick="Instance(\''+this.guid+"').toPage("+r+');">['+r+"]</a></span>"));return i>this.pageCount||t.push('<span><a style="color:#7777cc" href="javascript:void(0)" onclick="Instance(\''+this.guid+"').toPage("+i+');">下一页</a></span>'),t.push("</p>"),t.join("")},toPage:function(t){var e=t||1;"function"==typeof this.callback&&(this.callback(e),this.page=e),this.update&&this.render()}}),mg("LocalSearch",LocalSearch),mg("TransitRoute",TransitRoute),mg("DrivingRoute",DrivingRoute),mg("WalkingRoute",WalkingRoute),mg("TrafficControl",TrafficControl),mg("Geocoder",Geocoder),mg("LocalCity",LocalCity),mg("Geolocation",Geolocation),mg("Boundary",Boundary),baidu.inherits(Boundary,baidu.lang.Class,"Boundary"),baidu.extend(Boundary.prototype,{get:function(t,e){var n={};n.boundaries=[];var o=this;DataMgr.request(function(s){if(s&&s.content&&s.content.uid){var a=s.content.uid;DataMgr.request(function(s){if(s&&s.content&&s.content.geo)if(t.indexOf("福建")>-1||t.indexOf("浙江")>-1){var a=o._parseGeoSpecial(s.content.geo);n.boundaries=a}else{var r=parseGeo(s.content.geo,!1,o._opts.coordType);if(r.geo&&r.geo.length&&r.geo.length>0){var l=r.geo.length;for(i=0;i<l;i++){var h=r.geo[i];if(h&&h.length&&h.length>0){for(var c=h.length-1,u=[],p=0;p<c;p+=2){var d=h[p],_=h[p+1],f=new BMap.Point(d,_);"number"==typeof o._opts.coordType&&o._opts.coordType==BMAP_COORD_LNGLAT&&(f=BMap.Projection.convertMC2LL(f)),u.push(f.lng+", "+f.lat)}n.boundaries.push(u.join(";"))}}}}e&&e(n)},{qt:QUERY_TYPE_EXT,num:1e3,l:10,uid:a})}else e&&e(n)},{qt:QUERY_TYPE_POI_SEARCH,wd:t})},_parseGeoSpecial:function(t){var e=this,i=[];if("string"!=typeof t)return i;for(var n=t.split("|")[2].split(";"),o=0;o<n.length-1;o++){for(var s=[],a=n[o].split(","),r=0;r<a.length;r+=2){var l=a[r],h=a[r+1],c=new BMap.Point(l,h);"number"==typeof e._opts.coordType&&e._opts.coordType==BMAP_COORD_LNGLAT&&(c=BMap.Projection.convertMC2LL(c)),s.push(c.lng+", "+c.lat)}i.push(s.join(";"))}return i},toString:function(){return"Boundary"}})}();