function askqy(e){var o=new Object;commonParm(o),o.idCard=e,jsonAjax(InterFace.getEnterpriseByIdCard,o,getQy_fn)}function codeClick(e){var o=$.trim($(e).find("#phone").val());mobileObj.mobile=o,commonParm(mobileObj),1==validate(e+" #phone")&&jsonAjax(InterFace.getMcode,mobileObj,function(o){if(200==o.errCode){$(e).find(".getPhoneVer").attr("disabled","disabled").addClass("on");var r=e+" .getPhoneVer",s=60;timer=setInterval(function(){if(s>1){s-=1;var o=Math.floor(s%60),a="";o>=0&&(o<10&&(o="0"+o),a+=o+"秒"),$(r).val(a)}else clearInterval(timer),$(e).find(".getPhoneVer").attr("disabled",!1).val("获取手机验证码").removeClass("on")},1e3)}else 307==o.errCode&&(M.dialog1=jqueryAlert({content:"发送验证码失败，请联系管理员",closeTime:1e3,modal:!0}))})}function getQy_fn(e){"200"==e.errCode?($(".showB .show #qySelect").attr("qyid",e.enterpriseId),$(".showB .show #qySelect").val(e.enterpriseName)):"306"==e.errCode&&($(".showB .show #qySelect").val("企业名称"),M.dialog1=jqueryAlert({content:"没有查询到所属的企业，请注册普通用户",closeTime:1e3,modal:!0})),$(".showB #qyGetPhone").removeClass("on").removeAttr("disabled").val("获取手机验证码")}function ptRegister_fn(e){"503"==e.errCode?(M.dialog1=jqueryAlert({content:"用户已存在，请到登录页面登录",closeTime:1e3,modal:!0}),$(".showB .show #ptReg").removeClass("disabled").removeAttr("disabled").val("注册")):"504"==e.errCode?(M.dialog1=jqueryAlert({content:"该用户为企业用户，请选择”企业员工注册”",closeTime:1e3,modal:!0}),$(".showB .show #ptReg").removeClass("disabled").removeAttr("disabled").val("注册")):"312"==e.errCode?(M.dialog1=jqueryAlert({content:"抱歉，该用户被封",closeTime:1e3,modal:!0}),$(".showB .show #ptReg").removeClass("disabled").removeAttr("disabled").val("注册")):"501"==e.errCode?(M.dialog1=jqueryAlert({content:"验证码错误",closeTime:1e3,modal:!0}),$(".showB .show #ptReg").removeClass("disabled").removeAttr("disabled").val("注册")):"303"==e.errCode?(M.dialog1=jqueryAlert({content:"验证码超时，请重新获取",closeTime:1e3,modal:!0}),$(".showB .show #ptReg").removeClass("disabled").removeAttr("disabled").val("注册")):"200"==e.errCode&&(addCookie("usertype",e.usertype,1),M.dialog1=jqueryAlert({content:"注册成功",closeTime:1e3,modal:!0}),$(".showB .show #ptReg").removeClass("disabled").removeAttr("disabled").val("注册"),setTimeout(function(){window.location.href="login.html"},1e3)),$(".showB #qyGetPhone").removeClass("on").removeAttr("disabled").val("获取手机验证码")}function ptAhthFace_fn(e){"331"==e.errCode?(M.dialog1=jqueryAlert({content:"图像没有人脸,请摆正摄像头",closeTime:1e3,modal:!0}),$("#pickCamer").removeClass("disabled").removeAttr("disabled").val("拍照")):"332"==e.errCode?(M.dialog1=jqueryAlert({content:"人脸识别失败,请重新拍摄",closeTime:1e3,modal:!0}),$("#pickCamer").removeClass("disabled").removeAttr("disabled").val("拍照")):"200"==e.errCode&&(M.dialog1=jqueryAlert({content:"人脸识别成功",closeTime:1e3,modal:!0}),$(".showB #face_verfion").val($.scriptcam.getFrameAsBase64()),$(".showB #face_verfy").val("已成功识别人脸"),$("#pickCamer").removeClass("pickCamer"),$("#camerBox").hide(),$("#pickCamer").removeClass("disabled").removeAttr("disabled").val("拍照"))}function qyRegister_fn(e){console.log(e),"503"==e.errCode?(M.dialog1=jqueryAlert({content:"用户已存在，请到登录页面登录",closeTime:1e3,modal:!0}),$(".showB .show #depReg").removeClass("disabled").removeAttr("disabled").val("注册")):"310"==e.errCode?(M.dialog1=jqueryAlert({content:"用户已经存在，请登录",closeTime:1e3,modal:!0}),$(".showB .show #depReg").removeClass("disabled").removeAttr("disabled").val("注册")):"311"==e.errCode?(M.dialog1=jqueryAlert({content:"用户身份证号码错误",closeTime:1e3,modal:!0}),$(".showB .show #depReg").removeClass("disabled").removeAttr("disabled").val("注册")):"312"==e.errCode?(M.dialog1=jqueryAlert({content:"抱歉，该用户被封",closeTime:1e3,modal:!0}),$(".showB .show #depReg").removeClass("disabled").removeAttr("disabled").val("注册")):"303"==e.errCode?(M.dialog1=jqueryAlert({content:"验证码超时，请重新获取",closeTime:1e3,modal:!0}),$(".showB .show #depReg").removeClass("disabled").removeAttr("disabled").val("注册")):"501"==e.errCode?(M.dialog1=jqueryAlert({content:"验证码错误",closeTime:1e3,modal:!0}),$(".showB .show #depReg").removeClass("disabled").removeAttr("disabled").val("注册")):"200"==e.errCode&&(addCookie("usertype",e.usertype,1),M.dialog1=jqueryAlert({content:"恭喜您，注册成功",closeTime:1e3,modal:!0}),$(".showB .show #depReg").removeClass("disabled").removeAttr("disabled").val("注册"),setTimeout(function(){window.location.href="login.html"},1e3))}$(document).attr("title","注册_人人创培训监管服务平台"),$("#bz").on("mouseover",function(){$(this).next().show()}),$("#bz").on("mouseleave",function(){$(this).next().hide()});var M={},com_obj=new Object;if(commonParm(com_obj),alertHide(),""!==getSearch("openid")&&"undefined"!==getSearch("openid")&&void 0!==getSearch("openid")&&null!==getSearch("openid"))var openid=getSearch("openid");else var openid="";if(""!==getSearch("iconUrl")&&"undefined"!==getSearch("iconUrl")&&void 0!==getSearch("iconUrl")&&null!==getSearch("iconUrl"))var iconUrl=getSearch("iconUrl");else var iconUrl="";if(""!==getSearch("sex")&&"undefined"!==getSearch("sex")&&void 0!==getSearch("sex")&&null!==getSearch("sex"))var sex=getSearch("sex");else var sex="";var mobileCode,password,repassword,timer,mobileObj=new Object;"IE8"==myBrowser()||"IE9"==myBrowser()?($("#reg_ie").addClass("showB"),$("#reg_ie .form_v").not("#reg_ie #phone_verfy").on("blur",function(){validate(this),"carphone"==$(this).attr("id")&&1==validate(this)&&askqy($(".showB #carphone").val())})):($("#reg_no").addClass("showB"),$("#reg_no .form_v").not("#reg_no #phone_verfy").on("blur",function(){validate(this),"carphone"==$(this).attr("id")&&1==validate(this)&&askqy($(".showB #carphone").val())})),$(".showB #qyGetPhone").unbind("click").bind("click",function(e){e.stopPropagation(),codeClick(".showB .qyR")}),$(".showB #getPhone").unbind("click").bind("click",function(e){e.stopPropagation(),codeClick(".showB .ptR")}),$(".showB .regost").eq(0).hasClass("active")||$(".regost").eq(1).hasClass("active")&&$("#userBox").css("height","auto"),$(".showB .regost").on("click",function(){clearInterval(timer),$(this).addClass("active").siblings(".regost").removeClass("active");var e=$(this).index(".showB .ifolist .regost");"0"==e||$("#userBox").css("height","auto"),$(".registBox.showB .formBox").eq(e).addClass("show").siblings(".registBox.showB .formBox").removeClass("show")}),$(document).keydown(function(e){if(13==e.keyCode){var o=$(".regost.active").index(".regost");"0"==o?$(".showB #ptReg").click():"1"==o&&$(".showB #depReg").click()}}),$(".showB #ptReg").unbind("click").bind("click",function(){clearInterval(timer);var e=!1;if($(".showB .show .form_v").each(function(){if(0==(e=validate(this)))return!1}),1==e){$(".showB #ptReg").addClass("disabled").attr("disabled","disabled").val("正在注册.."),mobile=$.trim($(".showB .show #phone").val()),mobileCode=$.trim($(".showB .show #phone_verfy").val()),password=$.trim($(".showB .show #password").val()),repassword=$.trim($(".showB .show #confirm_password").val());var o=new Object;o.mobile=mobile,o.mobileCode=mobileCode,o.password=password,o.repassword=repassword,o.openid=openid,o.iconUrl=iconUrl,o.sex=sex,commonParm(o),console.log(o),jsonAjax(InterFace.ptRegister,o,ptRegister_fn)}}),$(".showB #face_verfy").unbind("click").bind("click",function(){hideAllTooltips(),$("#camerBox").show(),$("#webcam").scriptcam({width:372,height:290,showMicrophoneErrors:!0,onError:function(e,o){console.log(e),console.log(o),3==e&&(M.dialog1=jqueryAlert({content:"无法检测到摄像头，请检查",closeTime:1e3,modal:!0})),4==e&&$("#camerBox").hide()},cornerRadius:0,cornerColor:"e3e5e2",connected:function(e){console.log(e)},onWebcamReady:function(e,o,r,s,a){$("#pickCamer").addClass("pickCamer")},onMotion:function(e){console.log(e)},onPictureAsBase64:function(e){$("#formfield").val(e),$("#image").attr("src","data:image/png;base64,"+e)}})}),$("#pickCamer").on("click",function(){if($(this).hasClass("pickCamer")){$("#pickCamer").addClass("disabled").attr("disabled","disabled").val("正在识别..");var e=new Object;e.faceImg=$.scriptcam.getFrameAsBase64(),commonParm(e),jsonAjax(InterFace.ahthFace,e,ptAhthFace_fn)}else M.dialog1=jqueryAlert({content:"请您允许访问您的摄像头",closeTime:1e3,modal:!0})}),$(".showB #depReg").unbind("click").bind("click",function(){clearInterval(timer);var e=!1;if($(".showB .show .form_v").each(function(){if(0==(e=validate(this)))return!1}),""==$(".showB #face_verfion").val())return e=!1,!1;if(1==e){$(".showB #depReg").addClass("disabled").attr("disabled","disabled").val("正在注册..");var o=$(".showB .show #qySelect").attr("qyid");addCookie("enterpriseId",o);var r=$.trim($(".showB .show #carphone").val()),s=$(".showB .show #face_verfion").val(),a=$.trim($(".showB .show #phone").val()),i=$.trim($(".showB .show #phone_verfy").val()),t=$.trim($(".showB .show #password").val()),l=$.trim($(".showB .show #confirm_password").val()),d=new Object;d.idCard=r,d.imgBase64=s,d.mobile=a,d.mobileCode=i,d.imgStr="png",d.password=t,d.repassword=l,d.openid=openid,d.iconUrl=iconUrl,d.sex=sex,commonParm(d),console.log(d),jsonAjax(InterFace.qyRegister,d,qyRegister_fn)}});